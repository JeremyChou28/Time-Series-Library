Args in experiment:
[1mBasic Config[0m
  Task Name:          anomaly_detection   Is Training:        1                   
  Model ID:           MSL                 Model:              DLinear             

[1mData Loader[0m
  Data:               MSL                 Root Path:          ../iTransformer_datasets/anomaly_detection/MSL
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mAnomaly Detection Task[0m
  Anomaly Ratio:      1.0                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             55                  Dec In:             7                   
  C Out:              55                  d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : anomaly_detection_MSL_DLinear_MSL_ftM_sl100_ll48_pl100_dm128_nh8_el3_dl1_df128_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
test: (73729, 55)
train: (58317, 55)
train 58218
test: (73729, 55)
train: (58317, 55)
val 11565
test: (73729, 55)
train: (58317, 55)
test 73630
	iters: 100, epoch: 1 | loss: 0.5701693
	speed: 0.0457s/iter; left time: 203.4372s
	iters: 200, epoch: 1 | loss: 0.4671745
	speed: 0.0161s/iter; left time: 70.0051s
	iters: 300, epoch: 1 | loss: 0.4370376
	speed: 0.0212s/iter; left time: 90.0403s
	iters: 400, epoch: 1 | loss: 0.4145671
	speed: 0.0217s/iter; left time: 90.2240s
Epoch: 1 cost time: 11.278873682022095
Epoch: 1, Steps: 455 | Train Loss: 0.5258885 Vali Loss: 0.4410080 Test Loss: 1.1984773
Validation loss decreased (inf --> 0.441008).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5913447
	speed: 0.9904s/iter; left time: 3957.8083s
	iters: 200, epoch: 2 | loss: 0.4097338
	speed: 0.0181s/iter; left time: 70.6278s
	iters: 300, epoch: 2 | loss: 0.5015128
	speed: 0.0177s/iter; left time: 67.3380s
	iters: 400, epoch: 2 | loss: 0.4771792
	speed: 0.0173s/iter; left time: 63.7919s
Epoch: 2 cost time: 8.012228727340698
Epoch: 2, Steps: 455 | Train Loss: 0.4730640 Vali Loss: 0.3981046 Test Loss: 1.0599505
Validation loss decreased (0.441008 --> 0.398105).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4758229
	speed: 1.1518s/iter; left time: 4078.6662s
	iters: 200, epoch: 3 | loss: 0.3757235
	speed: 0.0230s/iter; left time: 79.0334s
	iters: 300, epoch: 3 | loss: 0.3186101
	speed: 0.0209s/iter; left time: 69.9269s
	iters: 400, epoch: 3 | loss: 0.4043065
	speed: 0.0183s/iter; left time: 59.2492s
Epoch: 3 cost time: 9.577269554138184
Epoch: 3, Steps: 455 | Train Loss: 0.4407428 Vali Loss: 0.3792692 Test Loss: 1.0042899
Validation loss decreased (0.398105 --> 0.379269).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3147085
	speed: 1.2383s/iter; left time: 3821.3987s
	iters: 200, epoch: 4 | loss: 0.5194954
	speed: 0.0171s/iter; left time: 51.1857s
	iters: 300, epoch: 4 | loss: 0.5272015
	speed: 0.0167s/iter; left time: 48.1109s
	iters: 400, epoch: 4 | loss: 0.5068302
	speed: 0.0151s/iter; left time: 42.1067s
Epoch: 4 cost time: 8.310542583465576
Epoch: 4, Steps: 455 | Train Loss: 0.4259762 Vali Loss: 0.3707318 Test Loss: 0.9784573
Validation loss decreased (0.379269 --> 0.370732).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3500977
	speed: 1.1528s/iter; left time: 3032.9190s
	iters: 200, epoch: 5 | loss: 0.5714188
	speed: 0.0117s/iter; left time: 29.7100s
	iters: 300, epoch: 5 | loss: 0.4092349
	speed: 0.0160s/iter; left time: 38.8868s
	iters: 400, epoch: 5 | loss: 0.3641619
	speed: 0.0146s/iter; left time: 34.0383s
Epoch: 5 cost time: 6.913036108016968
Epoch: 5, Steps: 455 | Train Loss: 0.4187138 Vali Loss: 0.3661398 Test Loss: 0.9657149
Validation loss decreased (0.370732 --> 0.366140).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3216721
	speed: 1.0841s/iter; left time: 2359.0238s
	iters: 200, epoch: 6 | loss: 0.3649246
	speed: 0.0176s/iter; left time: 36.6255s
	iters: 300, epoch: 6 | loss: 0.3003824
	speed: 0.0166s/iter; left time: 32.7043s
	iters: 400, epoch: 6 | loss: 0.5819637
	speed: 0.0208s/iter; left time: 38.9922s
Epoch: 6 cost time: 8.3246009349823
Epoch: 6, Steps: 455 | Train Loss: 0.4151473 Vali Loss: 0.3642855 Test Loss: 0.9594066
Validation loss decreased (0.366140 --> 0.364285).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5207156
	speed: 0.8860s/iter; left time: 1524.7731s
	iters: 200, epoch: 7 | loss: 0.3629381
	speed: 0.0135s/iter; left time: 21.8796s
	iters: 300, epoch: 7 | loss: 0.4741174
	speed: 0.0139s/iter; left time: 21.0852s
	iters: 400, epoch: 7 | loss: 0.3629455
	speed: 0.0117s/iter; left time: 16.6632s
Epoch: 7 cost time: 5.923101186752319
Epoch: 7, Steps: 455 | Train Loss: 0.4133210 Vali Loss: 0.3620261 Test Loss: 0.9562650
Validation loss decreased (0.364285 --> 0.362026).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4718766
	speed: 0.8120s/iter; left time: 1027.9638s
	iters: 200, epoch: 8 | loss: 0.4306455
	speed: 0.0157s/iter; left time: 18.2491s
	iters: 300, epoch: 8 | loss: 0.3157047
	speed: 0.0131s/iter; left time: 13.9700s
	iters: 400, epoch: 8 | loss: 0.3075876
	speed: 0.0135s/iter; left time: 13.0638s
Epoch: 8 cost time: 6.33214807510376
Epoch: 8, Steps: 455 | Train Loss: 0.4124752 Vali Loss: 0.3623923 Test Loss: 0.9546901
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2845415
	speed: 0.7559s/iter; left time: 613.0471s
	iters: 200, epoch: 9 | loss: 0.3330216
	speed: 0.0122s/iter; left time: 8.6493s
	iters: 300, epoch: 9 | loss: 0.3889636
	speed: 0.0104s/iter; left time: 6.3670s
	iters: 400, epoch: 9 | loss: 0.3727281
	speed: 0.0131s/iter; left time: 6.6885s
Epoch: 9 cost time: 5.293122053146362
Epoch: 9, Steps: 455 | Train Loss: 0.4120242 Vali Loss: 0.3614216 Test Loss: 0.9539039
Validation loss decreased (0.362026 --> 0.361422).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5818169
	speed: 0.9060s/iter; left time: 322.5524s
	iters: 200, epoch: 10 | loss: 0.3833176
	speed: 0.0117s/iter; left time: 3.0040s
	iters: 300, epoch: 10 | loss: 0.4383872
	speed: 0.0125s/iter; left time: 1.9518s
	iters: 400, epoch: 10 | loss: 0.5190954
	speed: 0.0134s/iter; left time: 0.7480s
Epoch: 10 cost time: 6.359741687774658
Epoch: 10, Steps: 455 | Train Loss: 0.4117962 Vali Loss: 0.3607928 Test Loss: 0.9535016
Validation loss decreased (0.361422 --> 0.360793).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : anomaly_detection_MSL_DLinear_MSL_ftM_sl100_ll48_pl100_dm128_nh8_el3_dl1_df128_fc1_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test: (73729, 55)
train: (58317, 55)
test 73630
test: (73729, 55)
train: (58317, 55)
train 58218
Threshold : 7.193761739730816
pred:    (7363000,)
gt:      (7363000,)
pred:  (7363000,)
gt:    (7363000,)
Accuracy : 0.9648, Precision : 0.8969, Recall : 0.7533, F-score : 0.8188 
