Args in experiment:
[1mBasic Config[0m
  Task Name:          anomaly_detection   Is Training:        1                   
  Model ID:           MSL                 Model:              iTransformer        

[1mData Loader[0m
  Data:               MSL                 Root Path:          ../iTransformer_datasets/anomaly_detection/MSL
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mAnomaly Detection Task[0m
  Anomaly Ratio:      1.0                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             55                  Dec In:             7                   
  C Out:              55                  d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : anomaly_detection_MSL_iTransformer_MSL_ftM_sl100_ll48_pl0_dm128_nh8_el3_dl1_df128_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
test: (73729, 55)
train: (58317, 55)
train 58218
test: (73729, 55)
train: (58317, 55)
val 11565
test: (73729, 55)
train: (58317, 55)
test 73630
	iters: 100, epoch: 1 | loss: 0.7191181
	speed: 0.0335s/iter; left time: 149.2830s
	iters: 200, epoch: 1 | loss: 0.5101772
	speed: 0.0243s/iter; left time: 105.5343s
	iters: 300, epoch: 1 | loss: 0.5679249
	speed: 0.0250s/iter; left time: 106.3662s
	iters: 400, epoch: 1 | loss: 0.3836222
	speed: 0.0281s/iter; left time: 116.5605s
Epoch: 1 cost time: 12.61590027809143
Epoch: 1, Steps: 455 | Train Loss: 0.4854788 Vali Loss: 0.2778119 Test Loss: 0.7881935
Validation loss decreased (inf --> 0.277812).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2913378
	speed: 0.1330s/iter; left time: 531.3360s
	iters: 200, epoch: 2 | loss: 0.4067220
	speed: 0.0271s/iter; left time: 105.7300s
	iters: 300, epoch: 2 | loss: 0.2564186
	speed: 0.0287s/iter; left time: 109.0344s
	iters: 400, epoch: 2 | loss: 0.2219013
	speed: 0.0271s/iter; left time: 100.2670s
Epoch: 2 cost time: 12.280054092407227
Epoch: 2, Steps: 455 | Train Loss: 0.2615432 Vali Loss: 0.1488643 Test Loss: 0.4118152
Validation loss decreased (0.277812 --> 0.148864).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2249146
	speed: 0.1323s/iter; left time: 468.5598s
	iters: 200, epoch: 3 | loss: 0.2221294
	speed: 0.0274s/iter; left time: 94.2539s
	iters: 300, epoch: 3 | loss: 0.1674469
	speed: 0.0277s/iter; left time: 92.4958s
	iters: 400, epoch: 3 | loss: 0.1608121
	speed: 0.0287s/iter; left time: 93.0461s
Epoch: 3 cost time: 13.03360366821289
Epoch: 3, Steps: 455 | Train Loss: 0.1851683 Vali Loss: 0.1117517 Test Loss: 0.3050107
Validation loss decreased (0.148864 --> 0.111752).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1926218
	speed: 0.1555s/iter; left time: 479.9393s
	iters: 200, epoch: 4 | loss: 0.1626118
	speed: 0.0304s/iter; left time: 90.9119s
	iters: 300, epoch: 4 | loss: 0.1956179
	speed: 0.0287s/iter; left time: 82.7007s
	iters: 400, epoch: 4 | loss: 0.1261694
	speed: 0.0306s/iter; left time: 85.3362s
Epoch: 4 cost time: 13.389257669448853
Epoch: 4, Steps: 455 | Train Loss: 0.1580716 Vali Loss: 0.0952464 Test Loss: 0.2595731
Validation loss decreased (0.111752 --> 0.095246).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1171774
	speed: 0.1365s/iter; left time: 359.1105s
	iters: 200, epoch: 5 | loss: 0.1623561
	speed: 0.0307s/iter; left time: 77.8128s
	iters: 300, epoch: 5 | loss: 0.2259334
	speed: 0.0304s/iter; left time: 73.9870s
	iters: 400, epoch: 5 | loss: 0.0904666
	speed: 0.0308s/iter; left time: 71.7321s
Epoch: 5 cost time: 13.941930294036865
Epoch: 5, Steps: 455 | Train Loss: 0.1456591 Vali Loss: 0.0875029 Test Loss: 0.2378311
Validation loss decreased (0.095246 --> 0.087503).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1469787
	speed: 0.1166s/iter; left time: 253.6414s
	iters: 200, epoch: 6 | loss: 0.1542643
	speed: 0.0243s/iter; left time: 50.3508s
	iters: 300, epoch: 6 | loss: 0.1290997
	speed: 0.0248s/iter; left time: 48.9160s
	iters: 400, epoch: 6 | loss: 0.1430903
	speed: 0.0275s/iter; left time: 51.6405s
Epoch: 6 cost time: 11.426178455352783
Epoch: 6, Steps: 455 | Train Loss: 0.1396061 Vali Loss: 0.0837641 Test Loss: 0.2272063
Validation loss decreased (0.087503 --> 0.083764).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1391651
	speed: 0.1220s/iter; left time: 209.9570s
	iters: 200, epoch: 7 | loss: 0.1229210
	speed: 0.0272s/iter; left time: 44.1707s
	iters: 300, epoch: 7 | loss: 0.1264426
	speed: 0.0271s/iter; left time: 41.2618s
	iters: 400, epoch: 7 | loss: 0.0985526
	speed: 0.0272s/iter; left time: 38.6276s
Epoch: 7 cost time: 12.336864233016968
Epoch: 7, Steps: 455 | Train Loss: 0.1363493 Vali Loss: 0.0818708 Test Loss: 0.2218869
Validation loss decreased (0.083764 --> 0.081871).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1553218
	speed: 0.1191s/iter; left time: 150.7746s
	iters: 200, epoch: 8 | loss: 0.1132311
	speed: 0.0271s/iter; left time: 31.5572s
	iters: 300, epoch: 8 | loss: 0.0946763
	speed: 0.0269s/iter; left time: 28.7131s
	iters: 400, epoch: 8 | loss: 0.1245199
	speed: 0.0278s/iter; left time: 26.8352s
Epoch: 8 cost time: 12.376914739608765
Epoch: 8, Steps: 455 | Train Loss: 0.1349264 Vali Loss: 0.0809729 Test Loss: 0.2192366
Validation loss decreased (0.081871 --> 0.080973).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1501448
	speed: 0.1251s/iter; left time: 101.4604s
	iters: 200, epoch: 9 | loss: 0.1763580
	speed: 0.0278s/iter; left time: 19.7737s
	iters: 300, epoch: 9 | loss: 0.1212854
	speed: 0.0274s/iter; left time: 16.7111s
	iters: 400, epoch: 9 | loss: 0.1510437
	speed: 0.0249s/iter; left time: 12.7078s
Epoch: 9 cost time: 12.258573770523071
Epoch: 9, Steps: 455 | Train Loss: 0.1341923 Vali Loss: 0.0803859 Test Loss: 0.2178694
Validation loss decreased (0.080973 --> 0.080386).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1059499
	speed: 0.1258s/iter; left time: 44.8004s
	iters: 200, epoch: 10 | loss: 0.1447034
	speed: 0.0252s/iter; left time: 6.4605s
	iters: 300, epoch: 10 | loss: 0.1759274
	speed: 0.0260s/iter; left time: 4.0577s
	iters: 400, epoch: 10 | loss: 0.1324305
	speed: 0.0266s/iter; left time: 1.4909s
Epoch: 10 cost time: 11.962259769439697
Epoch: 10, Steps: 455 | Train Loss: 0.1342748 Vali Loss: 0.0804878 Test Loss: 0.2171997
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : anomaly_detection_MSL_iTransformer_MSL_ftM_sl100_ll48_pl0_dm128_nh8_el3_dl1_df128_fc1_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test: (73729, 55)
train: (58317, 55)
test 73630
test: (73729, 55)
train: (58317, 55)
train 58218
Threshold : 1.9028486013412476
pred:    (7363000,)
gt:      (7363000,)
pred:  (7363000,)
gt:    (7363000,)
Accuracy : 0.9500, Precision : 0.8616, Recall : 0.6262, F-score : 0.7253 
