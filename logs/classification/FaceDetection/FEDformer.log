Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           FaceDetection       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ../iTransformer_datasets/classification/FaceDetection/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_FaceDetection_FEDformer_UEA_ftM_sl62_ll48_pl0_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8352842
	speed: 0.2404s/iter; left time: 8847.5377s
	iters: 200, epoch: 1 | loss: 1.2855613
	speed: 0.1917s/iter; left time: 7034.4257s
	iters: 300, epoch: 1 | loss: 0.4898307
	speed: 0.2050s/iter; left time: 7504.6862s
Epoch: 1 cost time: 76.60145354270935
Epoch: 1, Steps: 369 | Train Loss: 0.867 Vali Loss: 0.912 Vali Acc: 0.614 Test Loss: 0.904 Test Acc: 0.614
Validation loss decreased (inf --> -0.614359).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5613976
	speed: 0.5604s/iter; left time: 20415.9522s
	iters: 200, epoch: 2 | loss: 0.7979453
	speed: 0.1992s/iter; left time: 7238.2132s
	iters: 300, epoch: 2 | loss: 0.9381620
	speed: 0.2075s/iter; left time: 7518.1526s
Epoch: 2 cost time: 73.10175561904907
Epoch: 2, Steps: 369 | Train Loss: 0.686 Vali Loss: 0.870 Vali Acc: 0.599 Test Loss: 0.870 Test Acc: 0.599
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2930838
	speed: 0.6065s/iter; left time: 21870.5658s
	iters: 200, epoch: 3 | loss: 0.4577680
	speed: 0.2225s/iter; left time: 8002.8086s
	iters: 300, epoch: 3 | loss: 0.3974607
	speed: 0.2116s/iter; left time: 7590.2741s
Epoch: 3 cost time: 80.8412253856659
Epoch: 3, Steps: 369 | Train Loss: 0.543 Vali Loss: 0.775 Vali Acc: 0.656 Test Loss: 0.778 Test Acc: 0.656
Validation loss decreased (-0.614359 --> -0.655505).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3819799
	speed: 0.5856s/iter; left time: 20902.1719s
	iters: 200, epoch: 4 | loss: 0.8529825
	speed: 0.1677s/iter; left time: 5969.2348s
	iters: 300, epoch: 4 | loss: 0.3126098
	speed: 0.1688s/iter; left time: 5990.8189s
Epoch: 4 cost time: 62.45437812805176
Epoch: 4, Steps: 369 | Train Loss: 0.463 Vali Loss: 0.735 Vali Acc: 0.635 Test Loss: 0.733 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6063750
	speed: 0.4850s/iter; left time: 17131.3204s
	iters: 200, epoch: 5 | loss: 0.7744685
	speed: 0.1644s/iter; left time: 5789.4938s
	iters: 300, epoch: 5 | loss: 0.2687569
	speed: 0.1638s/iter; left time: 5751.8716s
Epoch: 5 cost time: 61.78070545196533
Epoch: 5, Steps: 369 | Train Loss: 0.412 Vali Loss: 0.735 Vali Acc: 0.671 Test Loss: 0.733 Test Acc: 0.671
Validation loss decreased (-0.655505 --> -0.671396).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2816611
	speed: 0.4942s/iter; left time: 17276.0669s
	iters: 200, epoch: 6 | loss: 0.2444614
	speed: 0.1625s/iter; left time: 5665.3232s
	iters: 300, epoch: 6 | loss: 0.2169569
	speed: 0.1756s/iter; left time: 6102.7274s
Epoch: 6 cost time: 63.54543972015381
Epoch: 6, Steps: 369 | Train Loss: 0.272 Vali Loss: 0.801 Vali Acc: 0.685 Test Loss: 0.799 Test Acc: 0.685
Validation loss decreased (-0.671396 --> -0.685017).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0473316
	speed: 0.5553s/iter; left time: 19206.4961s
	iters: 200, epoch: 7 | loss: 0.2208355
	speed: 0.1915s/iter; left time: 6603.2543s
	iters: 300, epoch: 7 | loss: 0.2619453
	speed: 0.1876s/iter; left time: 6450.1897s
Epoch: 7 cost time: 67.9126443862915
Epoch: 7, Steps: 369 | Train Loss: 0.201 Vali Loss: 0.876 Vali Acc: 0.682 Test Loss: 0.875 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1304720
	speed: 0.5557s/iter; left time: 19015.0968s
	iters: 200, epoch: 8 | loss: 0.3369318
	speed: 0.1849s/iter; left time: 6308.3493s
	iters: 300, epoch: 8 | loss: 0.0696213
	speed: 0.1821s/iter; left time: 6193.6688s
Epoch: 8 cost time: 66.71687364578247
Epoch: 8, Steps: 369 | Train Loss: 0.164 Vali Loss: 0.964 Vali Acc: 0.684 Test Loss: 0.959 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2393708
	speed: 0.5315s/iter; left time: 17992.1946s
	iters: 200, epoch: 9 | loss: 0.1008003
	speed: 0.1905s/iter; left time: 6429.8234s
	iters: 300, epoch: 9 | loss: 0.2611074
	speed: 0.1858s/iter; left time: 6253.2967s
Epoch: 9 cost time: 68.02291989326477
Epoch: 9, Steps: 369 | Train Loss: 0.139 Vali Loss: 0.994 Vali Acc: 0.675 Test Loss: 0.993 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0560393
	speed: 0.5088s/iter; left time: 17036.2276s
	iters: 200, epoch: 10 | loss: 0.2124540
	speed: 0.1702s/iter; left time: 5680.9316s
	iters: 300, epoch: 10 | loss: 0.0444438
	speed: 0.1704s/iter; left time: 5669.4888s
Epoch: 10 cost time: 62.93031620979309
Epoch: 10, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.047 Vali Acc: 0.674 Test Loss: 1.047 Test Acc: 0.674
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1809717
	speed: 0.4906s/iter; left time: 16243.6196s
	iters: 200, epoch: 11 | loss: 0.1544135
	speed: 0.1693s/iter; left time: 5588.6878s
	iters: 300, epoch: 11 | loss: 0.0677355
	speed: 0.1697s/iter; left time: 5586.1314s
Epoch: 11 cost time: 62.0087628364563
Epoch: 11, Steps: 369 | Train Loss: 0.095 Vali Loss: 1.046 Vali Acc: 0.674 Test Loss: 1.050 Test Acc: 0.674
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0982718
	speed: 0.4951s/iter; left time: 16211.7201s
	iters: 200, epoch: 12 | loss: 0.0601002
	speed: 0.1775s/iter; left time: 5794.8902s
	iters: 300, epoch: 12 | loss: 0.0347395
	speed: 0.1752s/iter; left time: 5700.3081s
Epoch: 12 cost time: 65.04492545127869
Epoch: 12, Steps: 369 | Train Loss: 0.088 Vali Loss: 1.050 Vali Acc: 0.675 Test Loss: 1.055 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2950272
	speed: 0.5054s/iter; left time: 16360.7859s
	iters: 200, epoch: 13 | loss: 0.2220624
	speed: 0.1773s/iter; left time: 5723.5884s
	iters: 300, epoch: 13 | loss: 0.0503474
	speed: 0.1721s/iter; left time: 5537.0469s
Epoch: 13 cost time: 64.30344271659851
Epoch: 13, Steps: 369 | Train Loss: 0.091 Vali Loss: 1.057 Vali Acc: 0.675 Test Loss: 1.061 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0397656
	speed: 0.4980s/iter; left time: 15939.2817s
	iters: 200, epoch: 14 | loss: 0.0507785
	speed: 0.1650s/iter; left time: 5262.6814s
	iters: 300, epoch: 14 | loss: 0.1063243
	speed: 0.1666s/iter; left time: 5298.3941s
Epoch: 14 cost time: 61.137612104415894
Epoch: 14, Steps: 369 | Train Loss: 0.090 Vali Loss: 1.059 Vali Acc: 0.674 Test Loss: 1.059 Test Acc: 0.674
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1446032
	speed: 0.5045s/iter; left time: 15959.6552s
	iters: 200, epoch: 15 | loss: 0.1905739
	speed: 0.1672s/iter; left time: 5272.7664s
	iters: 300, epoch: 15 | loss: 0.0334264
	speed: 0.1770s/iter; left time: 5562.7669s
Epoch: 15 cost time: 63.15562987327576
Epoch: 15, Steps: 369 | Train Loss: 0.088 Vali Loss: 1.062 Vali Acc: 0.674 Test Loss: 1.063 Test Acc: 0.674
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 16 | loss: 0.0236869
	speed: 0.4976s/iter; left time: 15556.7058s
	iters: 200, epoch: 16 | loss: 0.0466003
	speed: 0.1590s/iter; left time: 4955.0610s
	iters: 300, epoch: 16 | loss: 0.1415582
	speed: 0.1652s/iter; left time: 5133.5543s
Epoch: 16 cost time: 60.5921745300293
Epoch: 16, Steps: 369 | Train Loss: 0.090 Vali Loss: 1.068 Vali Acc: 0.675 Test Loss: 1.068 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_FaceDetection_FEDformer_UEA_ftM_sl62_ll48_pl0_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6850170261066969
Spend Time: 2680.9654817581177
