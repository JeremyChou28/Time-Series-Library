Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           JapaneseVowels      Model:              Pyraformer          

[1mData Loader[0m
  Data:               UEA                 Root Path:          ../iTransformer_datasets/classification/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
270
370
>>>>>>>start training : classification_JapaneseVowels_Pyraformer_UEA_ftM_sl29_ll48_pl0_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.785296440124512
Epoch: 1, Steps: 68 | Train Loss: 1.686 Vali Loss: 1.266 Vali Acc: 0.659 Test Loss: 1.262 Test Acc: 0.659
Validation loss decreased (inf --> -0.659459).  Saving model ...
Epoch: 2 cost time: 0.9861700534820557
Epoch: 2, Steps: 68 | Train Loss: 1.017 Vali Loss: 0.942 Vali Acc: 0.762 Test Loss: 0.948 Test Acc: 0.762
Validation loss decreased (-0.659459 --> -0.762162).  Saving model ...
Epoch: 3 cost time: 2.132859945297241
Epoch: 3, Steps: 68 | Train Loss: 0.794 Vali Loss: 1.775 Vali Acc: 0.695 Test Loss: 1.781 Test Acc: 0.695
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.021383285522461
Epoch: 4, Steps: 68 | Train Loss: 0.735 Vali Loss: 0.836 Vali Acc: 0.824 Test Loss: 0.847 Test Acc: 0.824
Validation loss decreased (-0.762162 --> -0.824324).  Saving model ...
Epoch: 5 cost time: 1.6126465797424316
Epoch: 5, Steps: 68 | Train Loss: 0.644 Vali Loss: 0.780 Vali Acc: 0.803 Test Loss: 0.779 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
Epoch: 6 cost time: 2.1718122959136963
Epoch: 6, Steps: 68 | Train Loss: 0.147 Vali Loss: 0.365 Vali Acc: 0.914 Test Loss: 0.365 Test Acc: 0.914
Validation loss decreased (-0.824324 --> -0.913514).  Saving model ...
Epoch: 7 cost time: 2.301558256149292
Epoch: 7, Steps: 68 | Train Loss: 0.070 Vali Loss: 0.314 Vali Acc: 0.932 Test Loss: 0.314 Test Acc: 0.932
Validation loss decreased (-0.913514 --> -0.932432).  Saving model ...
Epoch: 8 cost time: 2.399998188018799
Epoch: 8, Steps: 68 | Train Loss: 0.035 Vali Loss: 0.297 Vali Acc: 0.938 Test Loss: 0.297 Test Acc: 0.938
Validation loss decreased (-0.932432 --> -0.937838).  Saving model ...
Epoch: 9 cost time: 2.4323205947875977
Epoch: 9, Steps: 68 | Train Loss: 0.027 Vali Loss: 0.337 Vali Acc: 0.924 Test Loss: 0.337 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.422731876373291
Epoch: 10, Steps: 68 | Train Loss: 0.024 Vali Loss: 0.299 Vali Acc: 0.935 Test Loss: 0.336 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
Epoch: 11 cost time: 1.9341366291046143
Epoch: 11, Steps: 68 | Train Loss: 0.030 Vali Loss: 0.320 Vali Acc: 0.932 Test Loss: 0.306 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.239805221557617
Epoch: 12, Steps: 68 | Train Loss: 0.023 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.206584930419922
Epoch: 13, Steps: 68 | Train Loss: 0.017 Vali Loss: 0.308 Vali Acc: 0.930 Test Loss: 0.308 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.338641881942749
Epoch: 14, Steps: 68 | Train Loss: 0.018 Vali Loss: 0.305 Vali Acc: 0.932 Test Loss: 0.310 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.413301467895508
Epoch: 15, Steps: 68 | Train Loss: 0.017 Vali Loss: 0.310 Vali Acc: 0.930 Test Loss: 0.310 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-08
Epoch: 16 cost time: 2.1325056552886963
Epoch: 16, Steps: 68 | Train Loss: 0.014 Vali Loss: 0.287 Vali Acc: 0.938 Test Loss: 0.287 Test Acc: 0.938
Validation loss decreased (-0.937838 --> -0.937838).  Saving model ...
Epoch: 17 cost time: 2.649386405944824
Epoch: 17, Steps: 68 | Train Loss: 0.014 Vali Loss: 0.326 Vali Acc: 0.930 Test Loss: 0.326 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.295161008834839
Epoch: 18, Steps: 68 | Train Loss: 0.019 Vali Loss: 0.307 Vali Acc: 0.935 Test Loss: 0.310 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3481268882751465
Epoch: 19, Steps: 68 | Train Loss: 0.015 Vali Loss: 0.298 Vali Acc: 0.932 Test Loss: 0.298 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.241854429244995
Epoch: 20, Steps: 68 | Train Loss: 0.012 Vali Loss: 0.288 Vali Acc: 0.938 Test Loss: 0.288 Test Acc: 0.938
Validation loss decreased (-0.937838 --> -0.937838).  Saving model ...
Updating learning rate to 1.9073486328125e-09
Epoch: 21 cost time: 2.5151405334472656
Epoch: 21, Steps: 68 | Train Loss: 0.043 Vali Loss: 0.322 Vali Acc: 0.930 Test Loss: 0.321 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.500469446182251
Epoch: 22, Steps: 68 | Train Loss: 0.013 Vali Loss: 0.306 Vali Acc: 0.935 Test Loss: 0.306 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.7801618576049805
Epoch: 23, Steps: 68 | Train Loss: 0.014 Vali Loss: 0.309 Vali Acc: 0.932 Test Loss: 0.308 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.917227029800415
Epoch: 24, Steps: 68 | Train Loss: 0.012 Vali Loss: 0.299 Vali Acc: 0.932 Test Loss: 0.299 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.2602667808532715
Epoch: 25, Steps: 68 | Train Loss: 0.021 Vali Loss: 0.300 Vali Acc: 0.935 Test Loss: 0.310 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.960464477539063e-11
Epoch: 26 cost time: 2.1648592948913574
Epoch: 26, Steps: 68 | Train Loss: 0.018 Vali Loss: 0.299 Vali Acc: 0.932 Test Loss: 0.299 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.184157133102417
Epoch: 27, Steps: 68 | Train Loss: 0.021 Vali Loss: 0.302 Vali Acc: 0.935 Test Loss: 0.301 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.244459867477417
Epoch: 28, Steps: 68 | Train Loss: 0.019 Vali Loss: 0.328 Vali Acc: 0.932 Test Loss: 0.335 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.2829411029815674
Epoch: 29, Steps: 68 | Train Loss: 0.014 Vali Loss: 0.307 Vali Acc: 0.935 Test Loss: 0.308 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.1950490474700928
Epoch: 30, Steps: 68 | Train Loss: 0.024 Vali Loss: 0.291 Vali Acc: 0.935 Test Loss: 0.291 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_JapaneseVowels_Pyraformer_UEA_ftM_sl29_ll48_pl0_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
Spend Time: 221.09788966178894
