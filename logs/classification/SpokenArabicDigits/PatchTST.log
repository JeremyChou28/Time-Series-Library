Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           SpokenArabicDigits  Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          ../iTransformer_datasets/classification/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
6599
2199
>>>>>>>start training : classification_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll48_pl0_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3478829
	speed: 0.0458s/iter; left time: 1888.2198s
	iters: 200, epoch: 1 | loss: 0.9490806
	speed: 0.0199s/iter; left time: 819.6912s
	iters: 300, epoch: 1 | loss: 0.0013667
	speed: 0.0202s/iter; left time: 830.1190s
	iters: 400, epoch: 1 | loss: 0.0039659
	speed: 0.0209s/iter; left time: 855.5698s
Epoch: 1 cost time: 10.969035387039185
Epoch: 1, Steps: 413 | Train Loss: 0.688 Vali Loss: 0.248 Vali Acc: 0.952 Test Loss: 0.253 Test Acc: 0.952
Validation loss decreased (inf --> -0.952251).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2810530
	speed: 0.0430s/iter; left time: 1755.3987s
	iters: 200, epoch: 2 | loss: 0.0018018
	speed: 0.0199s/iter; left time: 810.4219s
	iters: 300, epoch: 2 | loss: 0.0400298
	speed: 0.0199s/iter; left time: 808.8008s
	iters: 400, epoch: 2 | loss: 0.1473429
	speed: 0.0210s/iter; left time: 848.5409s
Epoch: 2 cost time: 8.352977991104126
Epoch: 2, Steps: 413 | Train Loss: 0.225 Vali Loss: 0.369 Vali Acc: 0.941 Test Loss: 0.369 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0580702
	speed: 0.0418s/iter; left time: 1689.3234s
	iters: 200, epoch: 3 | loss: 0.0071177
	speed: 0.0206s/iter; left time: 830.9672s
	iters: 300, epoch: 3 | loss: 0.2033614
	speed: 0.0202s/iter; left time: 811.4704s
	iters: 400, epoch: 3 | loss: 0.1130900
	speed: 0.0201s/iter; left time: 806.6358s
Epoch: 3 cost time: 8.618224859237671
Epoch: 3, Steps: 413 | Train Loss: 0.169 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
Validation loss decreased (-0.952251 --> -0.961801).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0014161
	speed: 0.0426s/iter; left time: 1704.0981s
	iters: 200, epoch: 4 | loss: 0.0046240
	speed: 0.0202s/iter; left time: 805.0337s
	iters: 300, epoch: 4 | loss: 0.0044262
	speed: 0.0214s/iter; left time: 852.5602s
	iters: 400, epoch: 4 | loss: 0.0035525
	speed: 0.0208s/iter; left time: 824.8980s
Epoch: 4 cost time: 8.514462232589722
Epoch: 4, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.218 Vali Acc: 0.964 Test Loss: 0.220 Test Acc: 0.964
Validation loss decreased (-0.961801 --> -0.963620).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0011571
	speed: 0.0458s/iter; left time: 1811.5445s
	iters: 200, epoch: 5 | loss: 0.0047204
	speed: 0.0207s/iter; left time: 815.6940s
	iters: 300, epoch: 5 | loss: 1.1496142
	speed: 0.0202s/iter; left time: 793.1999s
	iters: 400, epoch: 5 | loss: 0.1047836
	speed: 0.0207s/iter; left time: 813.2685s
Epoch: 5 cost time: 8.661956310272217
Epoch: 5, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.460 Vali Acc: 0.927 Test Loss: 0.464 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3074916
	speed: 0.0399s/iter; left time: 1562.3899s
	iters: 200, epoch: 6 | loss: 0.0000364
	speed: 0.0203s/iter; left time: 790.6592s
	iters: 300, epoch: 6 | loss: 0.0286773
	speed: 0.0201s/iter; left time: 781.6483s
	iters: 400, epoch: 6 | loss: 0.0000126
	speed: 0.0199s/iter; left time: 772.7758s
Epoch: 6 cost time: 8.453300952911377
Epoch: 6, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.155 Vali Acc: 0.974 Test Loss: 0.155 Test Acc: 0.974
Validation loss decreased (-0.963620 --> -0.973624).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000815
	speed: 0.0463s/iter; left time: 1794.1426s
	iters: 200, epoch: 7 | loss: 0.0000026
	speed: 0.0226s/iter; left time: 871.4098s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.0232s/iter; left time: 893.5953s
	iters: 400, epoch: 7 | loss: 0.0055242
	speed: 0.0217s/iter; left time: 834.5580s
Epoch: 7 cost time: 9.260022401809692
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.973624 --> -0.975443).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000068
	speed: 0.0443s/iter; left time: 1697.6217s
	iters: 200, epoch: 8 | loss: 0.0000008
	speed: 0.0199s/iter; left time: 759.7967s
	iters: 300, epoch: 8 | loss: 0.0000019
	speed: 0.0201s/iter; left time: 765.5079s
	iters: 400, epoch: 8 | loss: 0.0000269
	speed: 0.0204s/iter; left time: 776.5387s
Epoch: 8 cost time: 8.41697883605957
Epoch: 8, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.132 Vali Acc: 0.979 Test Loss: 0.132 Test Acc: 0.979
Validation loss decreased (-0.975443 --> -0.979081).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0023847
	speed: 0.0436s/iter; left time: 1652.4854s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0196s/iter; left time: 740.7632s
	iters: 300, epoch: 9 | loss: 0.0009655
	speed: 0.0202s/iter; left time: 759.9640s
	iters: 400, epoch: 9 | loss: 0.0000020
	speed: 0.0210s/iter; left time: 791.1275s
Epoch: 9 cost time: 8.374287128448486
Epoch: 9, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.133 Vali Acc: 0.979 Test Loss: 0.144 Test Acc: 0.979
Validation loss decreased (-0.979081 --> -0.979081).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000004
	speed: 0.0429s/iter; left time: 1608.7559s
	iters: 200, epoch: 10 | loss: 0.0000480
	speed: 0.0199s/iter; left time: 742.9776s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0196s/iter; left time: 730.9763s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0198s/iter; left time: 737.7906s
Epoch: 10 cost time: 8.174447298049927
Epoch: 10, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.134 Vali Acc: 0.978 Test Loss: 0.134 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.0000023
	speed: 0.0380s/iter; left time: 1410.1026s
	iters: 200, epoch: 11 | loss: 0.0000004
	speed: 0.0200s/iter; left time: 741.2424s
	iters: 300, epoch: 11 | loss: 0.0000231
	speed: 0.0223s/iter; left time: 823.8080s
	iters: 400, epoch: 11 | loss: 0.0014974
	speed: 0.0231s/iter; left time: 848.7326s
Epoch: 11 cost time: 8.754475831985474
Epoch: 11, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.135 Vali Acc: 0.978 Test Loss: 0.135 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000548
	speed: 0.0414s/iter; left time: 1517.9873s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.0229s/iter; left time: 838.1621s
	iters: 300, epoch: 12 | loss: 0.0080000
	speed: 0.0229s/iter; left time: 835.9534s
	iters: 400, epoch: 12 | loss: 0.0025830
	speed: 0.0225s/iter; left time: 819.7716s
Epoch: 12 cost time: 9.419548749923706
Epoch: 12, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.978 Test Loss: 0.134 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000025
	speed: 0.0414s/iter; left time: 1502.0185s
	iters: 200, epoch: 13 | loss: 0.0000290
	speed: 0.0214s/iter; left time: 774.3952s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0224s/iter; left time: 809.1746s
	iters: 400, epoch: 13 | loss: 0.0000845
	speed: 0.0202s/iter; left time: 725.9885s
Epoch: 13 cost time: 8.91714882850647
Epoch: 13, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.0376s/iter; left time: 1345.7607s
	iters: 200, epoch: 14 | loss: 0.0000024
	speed: 0.0211s/iter; left time: 754.6390s
	iters: 300, epoch: 14 | loss: 0.0000062
	speed: 0.0196s/iter; left time: 697.0081s
	iters: 400, epoch: 14 | loss: 0.0000118
	speed: 0.0196s/iter; left time: 697.8819s
Epoch: 14 cost time: 8.159114122390747
Epoch: 14, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.0397s/iter; left time: 1405.3420s
	iters: 200, epoch: 15 | loss: 0.0000052
	speed: 0.0199s/iter; left time: 703.1655s
	iters: 300, epoch: 15 | loss: 0.0000122
	speed: 0.0198s/iter; left time: 698.9600s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0198s/iter; left time: 696.9122s
Epoch: 15 cost time: 8.324057579040527
Epoch: 15, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 16 | loss: 0.0000019
	speed: 0.0390s/iter; left time: 1365.1183s
	iters: 200, epoch: 16 | loss: 0.0000022
	speed: 0.0199s/iter; left time: 694.1673s
	iters: 300, epoch: 16 | loss: 0.0007097
	speed: 0.0198s/iter; left time: 690.4995s
	iters: 400, epoch: 16 | loss: 0.0235044
	speed: 0.0221s/iter; left time: 766.7914s
Epoch: 16 cost time: 8.539186000823975
Epoch: 16, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0043510
	speed: 0.0421s/iter; left time: 1455.9076s
	iters: 200, epoch: 17 | loss: 0.0384176
	speed: 0.0227s/iter; left time: 783.4757s
	iters: 300, epoch: 17 | loss: 0.0000574
	speed: 0.0202s/iter; left time: 695.6689s
	iters: 400, epoch: 17 | loss: 0.0000583
	speed: 0.0204s/iter; left time: 700.1823s
Epoch: 17 cost time: 8.954413890838623
Epoch: 17, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0014028
	speed: 0.0393s/iter; left time: 1341.6690s
	iters: 200, epoch: 18 | loss: 0.0004973
	speed: 0.0201s/iter; left time: 686.0716s
	iters: 300, epoch: 18 | loss: 0.0175139
	speed: 0.0212s/iter; left time: 720.2890s
	iters: 400, epoch: 18 | loss: 0.0000002
	speed: 0.0220s/iter; left time: 745.0209s
Epoch: 18 cost time: 8.726411819458008
Epoch: 18, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000010
	speed: 0.0586s/iter; left time: 1980.3330s
	iters: 200, epoch: 19 | loss: 0.0000004
	speed: 0.0231s/iter; left time: 776.2425s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0212s/iter; left time: 710.8886s
	iters: 400, epoch: 19 | loss: 0.0000272
	speed: 0.0200s/iter; left time: 670.9441s
Epoch: 19 cost time: 8.847162008285522
Epoch: 19, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll48_pl0_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.979081400636653
Spend Time: 300.6348829269409
