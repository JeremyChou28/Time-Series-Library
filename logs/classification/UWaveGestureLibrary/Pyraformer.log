Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           UWaveGestureLibrary Model:              Pyraformer          

[1mData Loader[0m
  Data:               UEA                 Root Path:          ../iTransformer_datasets/classification/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
120
320
>>>>>>>start training : classification_UWaveGestureLibrary_Pyraformer_UEA_ftM_sl315_ll48_pl0_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.345802068710327
Epoch: 1, Steps: 30 | Train Loss: 17.944 Vali Loss: 17.343 Vali Acc: 0.431 Test Loss: 17.343 Test Acc: 0.431
Validation loss decreased (inf --> -0.431250).  Saving model ...
Epoch: 2 cost time: 1.2338721752166748
Epoch: 2, Steps: 30 | Train Loss: 12.933 Vali Loss: 12.801 Vali Acc: 0.637 Test Loss: 12.801 Test Acc: 0.637
Validation loss decreased (-0.431250 --> -0.637500).  Saving model ...
Epoch: 3 cost time: 0.747553825378418
Epoch: 3, Steps: 30 | Train Loss: 9.845 Vali Loss: 10.223 Vali Acc: 0.628 Test Loss: 10.223 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.214010238647461
Epoch: 4, Steps: 30 | Train Loss: 8.264 Vali Loss: 15.530 Vali Acc: 0.628 Test Loss: 15.530 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.302095890045166
Epoch: 5, Steps: 30 | Train Loss: 7.491 Vali Loss: 8.553 Vali Acc: 0.694 Test Loss: 8.553 Test Acc: 0.694
Validation loss decreased (-0.637500 --> -0.693750).  Saving model ...
Updating learning rate to 6.25e-05
Epoch: 6 cost time: 1.2488081455230713
Epoch: 6, Steps: 30 | Train Loss: 1.853 Vali Loss: 7.985 Vali Acc: 0.694 Test Loss: 7.985 Test Acc: 0.694
Validation loss decreased (-0.693750 --> -0.693750).  Saving model ...
Epoch: 7 cost time: 1.5164787769317627
Epoch: 7, Steps: 30 | Train Loss: 0.783 Vali Loss: 7.696 Vali Acc: 0.703 Test Loss: 7.696 Test Acc: 0.703
Validation loss decreased (-0.693750 --> -0.703125).  Saving model ...
Epoch: 8 cost time: 0.8656489849090576
Epoch: 8, Steps: 30 | Train Loss: 0.294 Vali Loss: 7.589 Vali Acc: 0.684 Test Loss: 7.589 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3007221221923828
Epoch: 9, Steps: 30 | Train Loss: 0.271 Vali Loss: 7.581 Vali Acc: 0.694 Test Loss: 7.581 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3312652111053467
Epoch: 10, Steps: 30 | Train Loss: 0.182 Vali Loss: 7.299 Vali Acc: 0.706 Test Loss: 7.299 Test Acc: 0.706
Validation loss decreased (-0.703125 --> -0.706250).  Saving model ...
Updating learning rate to 1.953125e-06
Epoch: 11 cost time: 1.2318077087402344
Epoch: 11, Steps: 30 | Train Loss: 0.102 Vali Loss: 7.301 Vali Acc: 0.700 Test Loss: 7.301 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4074351787567139
Epoch: 12, Steps: 30 | Train Loss: 0.102 Vali Loss: 7.261 Vali Acc: 0.706 Test Loss: 7.261 Test Acc: 0.706
Validation loss decreased (-0.706250 --> -0.706250).  Saving model ...
Epoch: 13 cost time: 1.4158449172973633
Epoch: 13, Steps: 30 | Train Loss: 0.095 Vali Loss: 7.315 Vali Acc: 0.700 Test Loss: 7.315 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3880791664123535
Epoch: 14, Steps: 30 | Train Loss: 0.054 Vali Loss: 7.273 Vali Acc: 0.703 Test Loss: 7.273 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.371110200881958
Epoch: 15, Steps: 30 | Train Loss: 0.065 Vali Loss: 7.261 Vali Acc: 0.703 Test Loss: 7.261 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.103515625e-08
Epoch: 16 cost time: 1.455148458480835
Epoch: 16, Steps: 30 | Train Loss: 0.107 Vali Loss: 7.241 Vali Acc: 0.703 Test Loss: 7.241 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3282852172851562
Epoch: 17, Steps: 30 | Train Loss: 0.106 Vali Loss: 7.248 Vali Acc: 0.703 Test Loss: 7.248 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7177939414978027
Epoch: 18, Steps: 30 | Train Loss: 0.098 Vali Loss: 7.252 Vali Acc: 0.703 Test Loss: 7.252 Test Acc: 0.703
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4219226837158203
Epoch: 19, Steps: 30 | Train Loss: 0.108 Vali Loss: 7.261 Vali Acc: 0.703 Test Loss: 7.261 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3422458171844482
Epoch: 20, Steps: 30 | Train Loss: 0.112 Vali Loss: 7.248 Vali Acc: 0.703 Test Loss: 7.248 Test Acc: 0.703
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.9073486328125e-09
Epoch: 21 cost time: 1.4288663864135742
Epoch: 21, Steps: 30 | Train Loss: 0.087 Vali Loss: 7.278 Vali Acc: 0.703 Test Loss: 7.278 Test Acc: 0.703
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4900307655334473
Epoch: 22, Steps: 30 | Train Loss: 0.102 Vali Loss: 7.258 Vali Acc: 0.703 Test Loss: 7.258 Test Acc: 0.703
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_UWaveGestureLibrary_Pyraformer_UEA_ftM_sl315_ll48_pl0_dm128_nh8_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.70625
Spend Time: 174.0213451385498
