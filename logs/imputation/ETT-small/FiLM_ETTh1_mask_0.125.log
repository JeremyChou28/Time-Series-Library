Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTh1_mask_0.125    Model:              FiLM                

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ../iTransformer_datasets/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.125               

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_ETTh1_mask_0.125_FiLM_ETTh1_ftM_sl96_ll0_pl96_dm64_nh8_el2_dl1_df64_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.1572470
	speed: 0.1304s/iter; left time: 675.5872s
	iters: 200, epoch: 1 | loss: 0.1337259
	speed: 0.1042s/iter; left time: 529.3288s
	iters: 300, epoch: 1 | loss: 0.1283428
	speed: 0.1021s/iter; left time: 508.3351s
	iters: 400, epoch: 1 | loss: 0.1249829
	speed: 0.1012s/iter; left time: 494.0269s
	iters: 500, epoch: 1 | loss: 0.1278432
	speed: 0.1075s/iter; left time: 514.0632s
Epoch: 1 cost time: 57.297643423080444
Epoch: 1, Steps: 528 | Train Loss: 0.1623072 Vali Loss: 0.1588676 Test Loss: 0.1441155
Validation loss decreased (inf --> 0.158868).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1139759
	speed: 1.6136s/iter; left time: 7507.9817s
	iters: 200, epoch: 2 | loss: 0.1236111
	speed: 0.1620s/iter; left time: 737.5985s
	iters: 300, epoch: 2 | loss: 0.1056590
	speed: 0.1818s/iter; left time: 809.5751s
	iters: 400, epoch: 2 | loss: 0.1295410
	speed: 0.1761s/iter; left time: 766.5734s
	iters: 500, epoch: 2 | loss: 0.1052983
	speed: 0.1724s/iter; left time: 733.0699s
Epoch: 2 cost time: 93.31452584266663
Epoch: 2, Steps: 528 | Train Loss: 0.1178634 Vali Loss: 0.1501686 Test Loss: 0.1351438
Validation loss decreased (0.158868 --> 0.150169).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1239235
	speed: 2.1057s/iter; left time: 8686.0581s
	iters: 200, epoch: 3 | loss: 0.0991457
	speed: 0.1976s/iter; left time: 795.3192s
	iters: 300, epoch: 3 | loss: 0.1231221
	speed: 0.1668s/iter; left time: 654.6415s
	iters: 400, epoch: 3 | loss: 0.1149497
	speed: 0.1737s/iter; left time: 664.4947s
	iters: 500, epoch: 3 | loss: 0.1018386
	speed: 0.1845s/iter; left time: 687.0781s
Epoch: 3 cost time: 95.20439338684082
Epoch: 3, Steps: 528 | Train Loss: 0.1090146 Vali Loss: 0.1425246 Test Loss: 0.1248270
Validation loss decreased (0.150169 --> 0.142525).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0996179
	speed: 2.0608s/iter; left time: 7412.7182s
	iters: 200, epoch: 4 | loss: 0.0957588
	speed: 0.1692s/iter; left time: 591.7464s
	iters: 300, epoch: 4 | loss: 0.1163850
	speed: 0.1705s/iter; left time: 579.3390s
	iters: 400, epoch: 4 | loss: 0.1118001
	speed: 0.1851s/iter; left time: 610.2399s
	iters: 500, epoch: 4 | loss: 0.1058887
	speed: 0.1695s/iter; left time: 541.8796s
Epoch: 4 cost time: 91.81849718093872
Epoch: 4, Steps: 528 | Train Loss: 0.1044218 Vali Loss: 0.1362654 Test Loss: 0.1199590
Validation loss decreased (0.142525 --> 0.136265).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0941310
	speed: 2.0233s/iter; left time: 6209.5813s
	iters: 200, epoch: 5 | loss: 0.1168730
	speed: 0.1866s/iter; left time: 553.9774s
	iters: 300, epoch: 5 | loss: 0.1150879
	speed: 0.1781s/iter; left time: 511.0057s
	iters: 400, epoch: 5 | loss: 0.1231499
	speed: 0.1790s/iter; left time: 495.7540s
	iters: 500, epoch: 5 | loss: 0.0970512
	speed: 0.1821s/iter; left time: 485.9536s
Epoch: 5 cost time: 98.41685676574707
Epoch: 5, Steps: 528 | Train Loss: 0.1027623 Vali Loss: 0.1319925 Test Loss: 0.1191905
Validation loss decreased (0.136265 --> 0.131993).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1109511
	speed: 2.1756s/iter; left time: 5528.1028s
	iters: 200, epoch: 6 | loss: 0.1023805
	speed: 0.1888s/iter; left time: 460.8849s
	iters: 300, epoch: 6 | loss: 0.0937047
	speed: 0.1951s/iter; left time: 456.6525s
	iters: 400, epoch: 6 | loss: 0.0949109
	speed: 0.1946s/iter; left time: 435.9946s
	iters: 500, epoch: 6 | loss: 0.1041127
	speed: 0.2225s/iter; left time: 476.2940s
Epoch: 6 cost time: 104.61624050140381
Epoch: 6, Steps: 528 | Train Loss: 0.1015584 Vali Loss: 0.1318571 Test Loss: 0.1167177
Validation loss decreased (0.131993 --> 0.131857).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0881460
	speed: 2.6966s/iter; left time: 5428.1882s
	iters: 200, epoch: 7 | loss: 0.1051977
	speed: 0.2164s/iter; left time: 414.0462s
	iters: 300, epoch: 7 | loss: 0.1034174
	speed: 0.2240s/iter; left time: 406.0984s
	iters: 400, epoch: 7 | loss: 0.1098381
	speed: 0.2435s/iter; left time: 417.1817s
	iters: 500, epoch: 7 | loss: 0.1042350
	speed: 0.2368s/iter; left time: 381.8963s
Epoch: 7 cost time: 121.39860844612122
Epoch: 7, Steps: 528 | Train Loss: 0.1017715 Vali Loss: 0.1286124 Test Loss: 0.1162309
Validation loss decreased (0.131857 --> 0.128612).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1078621
	speed: 2.3155s/iter; left time: 3438.4537s
	iters: 200, epoch: 8 | loss: 0.1008901
	speed: 0.2217s/iter; left time: 307.0156s
	iters: 300, epoch: 8 | loss: 0.0944472
	speed: 0.2344s/iter; left time: 301.1740s
	iters: 400, epoch: 8 | loss: 0.1045834
	speed: 0.2206s/iter; left time: 261.3667s
	iters: 500, epoch: 8 | loss: 0.0909307
	speed: 0.2263s/iter; left time: 245.5878s
Epoch: 8 cost time: 117.03162980079651
Epoch: 8, Steps: 528 | Train Loss: 0.1017884 Vali Loss: 0.1317046 Test Loss: 0.1160901
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1071619
	speed: 2.1904s/iter; left time: 2096.2377s
	iters: 200, epoch: 9 | loss: 0.0983882
	speed: 0.2178s/iter; left time: 186.6144s
	iters: 300, epoch: 9 | loss: 0.0883297
	speed: 0.2277s/iter; left time: 172.3632s
	iters: 400, epoch: 9 | loss: 0.1066390
	speed: 0.2304s/iter; left time: 151.3907s
	iters: 500, epoch: 9 | loss: 0.0942234
	speed: 0.2296s/iter; left time: 127.8739s
Epoch: 9 cost time: 118.64771366119385
Epoch: 9, Steps: 528 | Train Loss: 0.1005384 Vali Loss: 0.1301020 Test Loss: 0.1170982
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.0994274
	speed: 2.4831s/iter; left time: 1065.2563s
	iters: 200, epoch: 10 | loss: 0.0954577
	speed: 0.2336s/iter; left time: 76.8425s
	iters: 300, epoch: 10 | loss: 0.1010495
	speed: 0.2261s/iter; left time: 51.7864s
	iters: 400, epoch: 10 | loss: 0.1002179
	speed: 0.2000s/iter; left time: 25.7951s
	iters: 500, epoch: 10 | loss: 0.1064942
	speed: 0.2182s/iter; left time: 6.3286s
Epoch: 10 cost time: 119.27541542053223
Epoch: 10, Steps: 528 | Train Loss: 0.1015314 Vali Loss: 0.1306166 Test Loss: 0.1150682
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTh1_mask_0.125_FiLM_ETTh1_ftM_sl96_ll0_pl96_dm64_nh8_el2_dl1_df64_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.11618849635124207, mae:0.23725798726081848
