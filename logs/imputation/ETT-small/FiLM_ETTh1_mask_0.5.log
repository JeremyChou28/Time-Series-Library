Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTh1_mask_0.5      Model:              FiLM                

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ../iTransformer_datasets/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.5                 

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_ETTh1_mask_0.5_FiLM_ETTh1_ftM_sl96_ll0_pl96_dm64_nh8_el2_dl1_df64_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3347465
	speed: 0.1178s/iter; left time: 610.0974s
	iters: 200, epoch: 1 | loss: 0.3081386
	speed: 0.1051s/iter; left time: 533.8223s
	iters: 300, epoch: 1 | loss: 0.2376062
	speed: 0.1002s/iter; left time: 499.0772s
	iters: 400, epoch: 1 | loss: 0.2468255
	speed: 0.0969s/iter; left time: 472.8591s
	iters: 500, epoch: 1 | loss: 0.2409016
	speed: 0.1161s/iter; left time: 554.8873s
Epoch: 1 cost time: 56.517632246017456
Epoch: 1, Steps: 528 | Train Loss: 0.2919306 Vali Loss: 0.3185686 Test Loss: 0.2858359
Validation loss decreased (inf --> 0.318569).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2317899
	speed: 1.9075s/iter; left time: 8875.6180s
	iters: 200, epoch: 2 | loss: 0.2520074
	speed: 0.2289s/iter; left time: 1042.1538s
	iters: 300, epoch: 2 | loss: 0.2081763
	speed: 0.2019s/iter; left time: 899.2334s
	iters: 400, epoch: 2 | loss: 0.2617709
	speed: 0.2255s/iter; left time: 981.4716s
	iters: 500, epoch: 2 | loss: 0.2220552
	speed: 0.2186s/iter; left time: 929.6539s
Epoch: 2 cost time: 116.07454562187195
Epoch: 2, Steps: 528 | Train Loss: 0.2280861 Vali Loss: 0.2916906 Test Loss: 0.2659822
Validation loss decreased (0.318569 --> 0.291691).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2081675
	speed: 2.5676s/iter; left time: 10591.2452s
	iters: 200, epoch: 3 | loss: 0.2011451
	speed: 0.2083s/iter; left time: 838.4145s
	iters: 300, epoch: 3 | loss: 0.2062348
	speed: 0.2078s/iter; left time: 815.5834s
	iters: 400, epoch: 3 | loss: 0.2286856
	speed: 0.2079s/iter; left time: 795.2505s
	iters: 500, epoch: 3 | loss: 0.2040278
	speed: 0.2087s/iter; left time: 777.5381s
Epoch: 3 cost time: 107.17651963233948
Epoch: 3, Steps: 528 | Train Loss: 0.2086307 Vali Loss: 0.2727049 Test Loss: 0.2475562
Validation loss decreased (0.291691 --> 0.272705).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1972751
	speed: 2.6014s/iter; left time: 9357.2056s
	iters: 200, epoch: 4 | loss: 0.1794950
	speed: 0.1887s/iter; left time: 660.0381s
	iters: 300, epoch: 4 | loss: 0.2080007
	speed: 0.1894s/iter; left time: 643.3773s
	iters: 400, epoch: 4 | loss: 0.2053878
	speed: 0.1925s/iter; left time: 634.6659s
	iters: 500, epoch: 4 | loss: 0.1921503
	speed: 0.2069s/iter; left time: 661.3566s
Epoch: 4 cost time: 102.01153373718262
Epoch: 4, Steps: 528 | Train Loss: 0.1992651 Vali Loss: 0.2635607 Test Loss: 0.2387829
Validation loss decreased (0.272705 --> 0.263561).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1819543
	speed: 2.6021s/iter; left time: 7985.8495s
	iters: 200, epoch: 5 | loss: 0.2210816
	speed: 0.1822s/iter; left time: 541.0162s
	iters: 300, epoch: 5 | loss: 0.2269382
	speed: 0.2012s/iter; left time: 577.2612s
	iters: 400, epoch: 5 | loss: 0.2201351
	speed: 0.2127s/iter; left time: 588.8733s
	iters: 500, epoch: 5 | loss: 0.1953056
	speed: 0.2116s/iter; left time: 564.7708s
Epoch: 5 cost time: 108.78800463676453
Epoch: 5, Steps: 528 | Train Loss: 0.1954781 Vali Loss: 0.2596602 Test Loss: 0.2346867
Validation loss decreased (0.263561 --> 0.259660).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2149170
	speed: 3.0609s/iter; left time: 7777.8067s
	iters: 200, epoch: 6 | loss: 0.1858979
	speed: 0.2472s/iter; left time: 603.4274s
	iters: 300, epoch: 6 | loss: 0.1867325
	speed: 0.2412s/iter; left time: 564.7559s
	iters: 400, epoch: 6 | loss: 0.1860728
	speed: 0.2823s/iter; left time: 632.7158s
	iters: 500, epoch: 6 | loss: 0.2112334
	speed: 0.2681s/iter; left time: 574.0396s
Epoch: 6 cost time: 139.02446746826172
Epoch: 6, Steps: 528 | Train Loss: 0.1928815 Vali Loss: 0.2544481 Test Loss: 0.2332409
Validation loss decreased (0.259660 --> 0.254448).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2050117
	speed: 3.4742s/iter; left time: 6993.5291s
	iters: 200, epoch: 7 | loss: 0.2100904
	speed: 0.2786s/iter; left time: 532.9020s
	iters: 300, epoch: 7 | loss: 0.1958156
	speed: 0.2597s/iter; left time: 470.8797s
	iters: 400, epoch: 7 | loss: 0.2031440
	speed: 0.2715s/iter; left time: 465.0152s
	iters: 500, epoch: 7 | loss: 0.1864002
	speed: 0.2689s/iter; left time: 433.7025s
Epoch: 7 cost time: 143.7070188522339
Epoch: 7, Steps: 528 | Train Loss: 0.1923590 Vali Loss: 0.2562613 Test Loss: 0.2315054
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1762405
	speed: 2.8207s/iter; left time: 4188.7042s
	iters: 200, epoch: 8 | loss: 0.2016964
	speed: 0.2589s/iter; left time: 358.6111s
	iters: 300, epoch: 8 | loss: 0.1786230
	speed: 0.2690s/iter; left time: 345.6935s
	iters: 400, epoch: 8 | loss: 0.1789498
	speed: 0.2647s/iter; left time: 313.6983s
	iters: 500, epoch: 8 | loss: 0.1981940
	speed: 0.2540s/iter; left time: 275.6223s
Epoch: 8 cost time: 136.30496549606323
Epoch: 8, Steps: 528 | Train Loss: 0.1922328 Vali Loss: 0.2560916 Test Loss: 0.2325763
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2093200
	speed: 2.7798s/iter; left time: 2660.3143s
	iters: 200, epoch: 9 | loss: 0.1726549
	speed: 0.2291s/iter; left time: 196.3358s
	iters: 300, epoch: 9 | loss: 0.1815229
	speed: 0.2157s/iter; left time: 163.2791s
	iters: 400, epoch: 9 | loss: 0.1990224
	speed: 0.2411s/iter; left time: 158.3719s
	iters: 500, epoch: 9 | loss: 0.2017468
	speed: 0.2330s/iter; left time: 129.7879s
Epoch: 9 cost time: 120.28629207611084
Epoch: 9, Steps: 528 | Train Loss: 0.1913877 Vali Loss: 0.2540238 Test Loss: 0.2332901
Validation loss decreased (0.254448 --> 0.254024).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1931237
	speed: 2.9595s/iter; left time: 1269.6355s
	iters: 200, epoch: 10 | loss: 0.1827076
	speed: 0.2316s/iter; left time: 76.2116s
	iters: 300, epoch: 10 | loss: 0.2105979
	speed: 0.2283s/iter; left time: 52.2840s
	iters: 400, epoch: 10 | loss: 0.1724980
	speed: 0.2260s/iter; left time: 29.1494s
	iters: 500, epoch: 10 | loss: 0.2246690
	speed: 0.1983s/iter; left time: 5.7499s
Epoch: 10 cost time: 117.4525215625763
Epoch: 10, Steps: 528 | Train Loss: 0.1917737 Vali Loss: 0.2561938 Test Loss: 0.2323279
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : imputation_ETTh1_mask_0.5_FiLM_ETTh1_ftM_sl96_ll0_pl96_dm64_nh8_el2_dl1_df64_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.2316986322402954, mae:0.3334193825721741
