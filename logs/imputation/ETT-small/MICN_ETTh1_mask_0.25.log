Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTh1_mask_0.25     Model:              MICN                

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ../iTransformer_datasets/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.25                

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_ETTh1_mask_0.25_MICN_ETTh1_ftM_sl96_ll0_pl0_dm64_nh8_el2_dl1_df64_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8545
val 2881
test 2881
	iters: 100, epoch: 1 | loss: 0.1237179
	speed: 0.0731s/iter; left time: 383.0799s
	iters: 200, epoch: 1 | loss: 0.1276188
	speed: 0.0222s/iter; left time: 114.3540s
	iters: 300, epoch: 1 | loss: 0.1349159
	speed: 0.0179s/iter; left time: 90.1829s
	iters: 400, epoch: 1 | loss: 0.1307150
	speed: 0.0238s/iter; left time: 117.6959s
	iters: 500, epoch: 1 | loss: 0.1053201
	speed: 0.0244s/iter; left time: 117.8915s
Epoch: 1 cost time: 16.843398332595825
Epoch: 1, Steps: 534 | Train Loss: 0.1333651 Vali Loss: 0.1553735 Test Loss: 0.1322355
Validation loss decreased (inf --> 0.155374).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1213656
	speed: 0.3664s/iter; left time: 1724.4245s
	iters: 200, epoch: 2 | loss: 0.1292753
	speed: 0.0233s/iter; left time: 107.3874s
	iters: 300, epoch: 2 | loss: 0.1186685
	speed: 0.0259s/iter; left time: 116.5404s
	iters: 400, epoch: 2 | loss: 0.1151004
	speed: 0.0218s/iter; left time: 96.0931s
	iters: 500, epoch: 2 | loss: 0.1049286
	speed: 0.0200s/iter; left time: 85.9407s
Epoch: 2 cost time: 12.133825063705444
Epoch: 2, Steps: 534 | Train Loss: 0.1119199 Vali Loss: 0.1452987 Test Loss: 0.1159875
Validation loss decreased (0.155374 --> 0.145299).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1222409
	speed: 0.2940s/iter; left time: 1226.9061s
	iters: 200, epoch: 3 | loss: 0.1024352
	speed: 0.0214s/iter; left time: 87.3576s
	iters: 300, epoch: 3 | loss: 0.1203939
	speed: 0.0226s/iter; left time: 89.7762s
	iters: 400, epoch: 3 | loss: 0.0992281
	speed: 0.0252s/iter; left time: 97.4369s
	iters: 500, epoch: 3 | loss: 0.1084967
	speed: 0.0216s/iter; left time: 81.6318s
Epoch: 3 cost time: 11.926748037338257
Epoch: 3, Steps: 534 | Train Loss: 0.1031379 Vali Loss: 0.1415163 Test Loss: 0.1110555
Validation loss decreased (0.145299 --> 0.141516).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1007968
	speed: 0.3556s/iter; left time: 1293.9878s
	iters: 200, epoch: 4 | loss: 0.0795866
	speed: 0.0211s/iter; left time: 74.7170s
	iters: 300, epoch: 4 | loss: 0.0974494
	speed: 0.0216s/iter; left time: 74.1314s
	iters: 400, epoch: 4 | loss: 0.0910879
	speed: 0.0231s/iter; left time: 77.2731s
	iters: 500, epoch: 4 | loss: 0.1055406
	speed: 0.0217s/iter; left time: 70.2712s
Epoch: 4 cost time: 11.861296892166138
Epoch: 4, Steps: 534 | Train Loss: 0.0995135 Vali Loss: 0.1340886 Test Loss: 0.1091945
Validation loss decreased (0.141516 --> 0.134089).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0905025
	speed: 0.3379s/iter; left time: 1049.1708s
	iters: 200, epoch: 5 | loss: 0.1019079
	speed: 0.0165s/iter; left time: 49.6667s
	iters: 300, epoch: 5 | loss: 0.0888559
	speed: 0.0193s/iter; left time: 56.0474s
	iters: 400, epoch: 5 | loss: 0.1064642
	speed: 0.0161s/iter; left time: 45.0539s
	iters: 500, epoch: 5 | loss: 0.0912346
	speed: 0.0157s/iter; left time: 42.5808s
Epoch: 5 cost time: 9.173096418380737
Epoch: 5, Steps: 534 | Train Loss: 0.0976447 Vali Loss: 0.1357223 Test Loss: 0.1069810
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0984387
	speed: 0.2460s/iter; left time: 632.4486s
	iters: 200, epoch: 6 | loss: 0.0997950
	speed: 0.0181s/iter; left time: 44.7838s
	iters: 300, epoch: 6 | loss: 0.0780400
	speed: 0.0214s/iter; left time: 50.7825s
	iters: 400, epoch: 6 | loss: 0.1046053
	speed: 0.0183s/iter; left time: 41.5946s
	iters: 500, epoch: 6 | loss: 0.0945185
	speed: 0.0239s/iter; left time: 51.9535s
Epoch: 6 cost time: 11.084172248840332
Epoch: 6, Steps: 534 | Train Loss: 0.0969592 Vali Loss: 0.1331738 Test Loss: 0.1055758
Validation loss decreased (0.134089 --> 0.133174).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0954992
	speed: 0.3598s/iter; left time: 732.9459s
	iters: 200, epoch: 7 | loss: 0.0963591
	speed: 0.0193s/iter; left time: 37.4268s
	iters: 300, epoch: 7 | loss: 0.0922465
	speed: 0.0186s/iter; left time: 34.1152s
	iters: 400, epoch: 7 | loss: 0.1058284
	speed: 0.0214s/iter; left time: 37.1852s
	iters: 500, epoch: 7 | loss: 0.1022708
	speed: 0.0249s/iter; left time: 40.7789s
Epoch: 7 cost time: 11.268309116363525
Epoch: 7, Steps: 534 | Train Loss: 0.0964775 Vali Loss: 0.1332753 Test Loss: 0.1064075
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1044562
	speed: 0.3177s/iter; left time: 477.4903s
	iters: 200, epoch: 8 | loss: 0.1073437
	speed: 0.0170s/iter; left time: 23.9011s
	iters: 300, epoch: 8 | loss: 0.1025547
	speed: 0.0168s/iter; left time: 21.8377s
	iters: 400, epoch: 8 | loss: 0.1008302
	speed: 0.0141s/iter; left time: 16.9357s
	iters: 500, epoch: 8 | loss: 0.1169909
	speed: 0.0134s/iter; left time: 14.7873s
Epoch: 8 cost time: 8.959328174591064
Epoch: 8, Steps: 534 | Train Loss: 0.0959717 Vali Loss: 0.1348508 Test Loss: 0.1069034
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0902027
	speed: 0.2861s/iter; left time: 277.2241s
	iters: 200, epoch: 9 | loss: 0.0861815
	speed: 0.0167s/iter; left time: 14.5109s
	iters: 300, epoch: 9 | loss: 0.1012474
	speed: 0.0156s/iter; left time: 12.0101s
	iters: 400, epoch: 9 | loss: 0.1073140
	speed: 0.0139s/iter; left time: 9.2969s
	iters: 500, epoch: 9 | loss: 0.0876511
	speed: 0.0153s/iter; left time: 8.7172s
Epoch: 9 cost time: 8.588188886642456
Epoch: 9, Steps: 534 | Train Loss: 0.0955742 Vali Loss: 0.1341799 Test Loss: 0.1055116
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTh1_mask_0.25_MICN_ETTh1_ftM_sl96_ll0_pl0_dm64_nh8_el2_dl1_df64_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2881
test shape: (2881, 96, 7) (2881, 96, 7)
mse:0.10528341680765152, mae:0.23185689747333527
