Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTh1_mask_0.25     Model:              TimesNet            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ../iTransformer_datasets/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.25                

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_ETTh1_mask_0.25_TimesNet_ETTh1_ftM_sl96_ll0_pl0_dm16_nh8_el2_dl1_df32_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8545
val 2881
test 2881
	iters: 100, epoch: 1 | loss: 0.1160578
	speed: 0.0981s/iter; left time: 513.8915s
	iters: 200, epoch: 1 | loss: 0.0963914
	speed: 0.0570s/iter; left time: 293.0085s
	iters: 300, epoch: 1 | loss: 0.0847758
	speed: 0.0570s/iter; left time: 287.5161s
	iters: 400, epoch: 1 | loss: 0.0692701
	speed: 0.0575s/iter; left time: 284.0211s
	iters: 500, epoch: 1 | loss: 0.0643347
	speed: 0.0626s/iter; left time: 303.0035s
Epoch: 1 cost time: 35.05212950706482
Epoch: 1, Steps: 534 | Train Loss: 0.1025311 Vali Loss: 0.1320942 Test Loss: 0.0967593
Validation loss decreased (inf --> 0.132094).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.0701421
	speed: 0.5649s/iter; left time: 2658.9875s
	iters: 200, epoch: 2 | loss: 0.0603497
	speed: 0.0597s/iter; left time: 275.1070s
	iters: 300, epoch: 2 | loss: 0.0641404
	speed: 0.0584s/iter; left time: 263.4218s
	iters: 400, epoch: 2 | loss: 0.0679435
	speed: 0.0576s/iter; left time: 254.0304s
	iters: 500, epoch: 2 | loss: 0.0574312
	speed: 0.0524s/iter; left time: 225.8775s
Epoch: 2 cost time: 28.60498309135437
Epoch: 2, Steps: 534 | Train Loss: 0.0658874 Vali Loss: 0.1200376 Test Loss: 0.0896663
Validation loss decreased (0.132094 --> 0.120038).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0551560
	speed: 0.5447s/iter; left time: 2273.0074s
	iters: 200, epoch: 3 | loss: 0.0573164
	speed: 0.0469s/iter; left time: 190.9104s
	iters: 300, epoch: 3 | loss: 0.0617984
	speed: 0.0608s/iter; left time: 241.6175s
	iters: 400, epoch: 3 | loss: 0.0542666
	speed: 0.0600s/iter; left time: 232.1896s
	iters: 500, epoch: 3 | loss: 0.0640121
	speed: 0.0560s/iter; left time: 211.3278s
Epoch: 3 cost time: 27.87470817565918
Epoch: 3, Steps: 534 | Train Loss: 0.0583742 Vali Loss: 0.1134333 Test Loss: 0.0830214
Validation loss decreased (0.120038 --> 0.113433).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0494050
	speed: 0.5632s/iter; left time: 2049.6043s
	iters: 200, epoch: 4 | loss: 0.0572888
	speed: 0.0516s/iter; left time: 182.7803s
	iters: 300, epoch: 4 | loss: 0.0597153
	speed: 0.0600s/iter; left time: 206.4612s
	iters: 400, epoch: 4 | loss: 0.0586365
	speed: 0.0621s/iter; left time: 207.4054s
	iters: 500, epoch: 4 | loss: 0.0498063
	speed: 0.0585s/iter; left time: 189.4169s
Epoch: 4 cost time: 29.18332076072693
Epoch: 4, Steps: 534 | Train Loss: 0.0558127 Vali Loss: 0.1104456 Test Loss: 0.0824181
Validation loss decreased (0.113433 --> 0.110446).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0488377
	speed: 0.5714s/iter; left time: 1774.2318s
	iters: 200, epoch: 5 | loss: 0.0514112
	speed: 0.0600s/iter; left time: 180.2453s
	iters: 300, epoch: 5 | loss: 0.0579878
	speed: 0.0598s/iter; left time: 173.8056s
	iters: 400, epoch: 5 | loss: 0.0505659
	speed: 0.0607s/iter; left time: 170.2970s
	iters: 500, epoch: 5 | loss: 0.0491125
	speed: 0.0608s/iter; left time: 164.4109s
Epoch: 5 cost time: 30.721035957336426
Epoch: 5, Steps: 534 | Train Loss: 0.0538104 Vali Loss: 0.1079718 Test Loss: 0.0810717
Validation loss decreased (0.110446 --> 0.107972).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0549234
	speed: 0.5938s/iter; left time: 1526.7455s
	iters: 200, epoch: 6 | loss: 0.0520509
	speed: 0.0636s/iter; left time: 157.2596s
	iters: 300, epoch: 6 | loss: 0.0447639
	speed: 0.0673s/iter; left time: 159.4710s
	iters: 400, epoch: 6 | loss: 0.0464395
	speed: 0.0624s/iter; left time: 141.7435s
	iters: 500, epoch: 6 | loss: 0.0545157
	speed: 0.0569s/iter; left time: 123.4844s
Epoch: 6 cost time: 32.57366704940796
Epoch: 6, Steps: 534 | Train Loss: 0.0529863 Vali Loss: 0.1082272 Test Loss: 0.0811728
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0434291
	speed: 0.5602s/iter; left time: 1141.1156s
	iters: 200, epoch: 7 | loss: 0.0529689
	speed: 0.0631s/iter; left time: 122.2837s
	iters: 300, epoch: 7 | loss: 0.0466071
	speed: 0.0636s/iter; left time: 116.7681s
	iters: 400, epoch: 7 | loss: 0.0548818
	speed: 0.0629s/iter; left time: 109.3004s
	iters: 500, epoch: 7 | loss: 0.0477222
	speed: 0.0593s/iter; left time: 97.0541s
Epoch: 7 cost time: 32.082008600234985
Epoch: 7, Steps: 534 | Train Loss: 0.0526776 Vali Loss: 0.1076545 Test Loss: 0.0797398
Validation loss decreased (0.107972 --> 0.107654).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0560485
	speed: 0.5812s/iter; left time: 873.5750s
	iters: 200, epoch: 8 | loss: 0.0557792
	speed: 0.0611s/iter; left time: 85.7286s
	iters: 300, epoch: 8 | loss: 0.0623251
	speed: 0.0632s/iter; left time: 82.3583s
	iters: 400, epoch: 8 | loss: 0.0505670
	speed: 0.0646s/iter; left time: 77.7296s
	iters: 500, epoch: 8 | loss: 0.0537100
	speed: 0.0606s/iter; left time: 66.8005s
Epoch: 8 cost time: 31.948382139205933
Epoch: 8, Steps: 534 | Train Loss: 0.0526871 Vali Loss: 0.1065804 Test Loss: 0.0810654
Validation loss decreased (0.107654 --> 0.106580).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0558490
	speed: 0.5824s/iter; left time: 564.3746s
	iters: 200, epoch: 9 | loss: 0.0517554
	speed: 0.0624s/iter; left time: 54.2304s
	iters: 300, epoch: 9 | loss: 0.0465318
	speed: 0.0617s/iter; left time: 47.4389s
	iters: 400, epoch: 9 | loss: 0.0546817
	speed: 0.0635s/iter; left time: 42.4758s
	iters: 500, epoch: 9 | loss: 0.0535436
	speed: 0.0594s/iter; left time: 33.7816s
Epoch: 9 cost time: 31.56526803970337
Epoch: 9, Steps: 534 | Train Loss: 0.0525820 Vali Loss: 0.1066540 Test Loss: 0.0802040
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.0565710
	speed: 0.5050s/iter; left time: 219.6743s
	iters: 200, epoch: 10 | loss: 0.0506306
	speed: 0.0516s/iter; left time: 17.2773s
	iters: 300, epoch: 10 | loss: 0.0622051
	speed: 0.0532s/iter; left time: 12.4914s
	iters: 400, epoch: 10 | loss: 0.0479688
	speed: 0.0556s/iter; left time: 7.5054s
	iters: 500, epoch: 10 | loss: 0.0486834
	speed: 0.0620s/iter; left time: 2.1684s
Epoch: 10 cost time: 27.615041255950928
Epoch: 10, Steps: 534 | Train Loss: 0.0524915 Vali Loss: 0.1057784 Test Loss: 0.0801494
Validation loss decreased (0.106580 --> 0.105778).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : imputation_ETTh1_mask_0.25_TimesNet_ETTh1_ftM_sl96_ll0_pl0_dm16_nh8_el2_dl1_df32_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2881
test shape: (2881, 96, 7) (2881, 96, 7)
mse:0.08060217648744583, mae:0.19069452583789825
