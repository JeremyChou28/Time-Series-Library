Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTh2_mask_0.25     Model:              TimesNet            

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ../iTransformer_datasets/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.25                

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_ETTh2_mask_0.25_TimesNet_ETTh2_ftM_sl96_ll0_pl0_dm32_nh8_el2_dl1_df32_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8545
val 2881
test 2881
	iters: 100, epoch: 1 | loss: 0.0471527
	speed: 0.1613s/iter; left time: 845.2162s
	iters: 200, epoch: 1 | loss: 0.0548092
	speed: 0.1475s/iter; left time: 758.4977s
	iters: 300, epoch: 1 | loss: 0.0516631
	speed: 0.1496s/iter; left time: 754.1162s
	iters: 400, epoch: 1 | loss: 0.0279684
	speed: 0.1484s/iter; left time: 733.0026s
	iters: 500, epoch: 1 | loss: 0.0576262
	speed: 0.1494s/iter; left time: 723.1379s
Epoch: 1 cost time: 80.66830468177795
Epoch: 1, Steps: 534 | Train Loss: 0.0562249 Vali Loss: 0.0379163 Test Loss: 0.0519140
Validation loss decreased (inf --> 0.037916).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.0310573
	speed: 2.6227s/iter; left time: 12345.1228s
	iters: 200, epoch: 2 | loss: 0.0312658
	speed: 0.1340s/iter; left time: 617.5475s
	iters: 300, epoch: 2 | loss: 0.0697178
	speed: 0.1337s/iter; left time: 602.7208s
	iters: 400, epoch: 2 | loss: 0.0463146
	speed: 0.1338s/iter; left time: 589.4530s
	iters: 500, epoch: 2 | loss: 0.0262423
	speed: 0.1343s/iter; left time: 578.2790s
Epoch: 2 cost time: 71.65595316886902
Epoch: 2, Steps: 534 | Train Loss: 0.0397990 Vali Loss: 0.0372915 Test Loss: 0.0512601
Validation loss decreased (0.037916 --> 0.037292).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0321144
	speed: 2.6562s/iter; left time: 11084.2595s
	iters: 200, epoch: 3 | loss: 0.0233860
	speed: 0.1391s/iter; left time: 566.6209s
	iters: 300, epoch: 3 | loss: 0.0328047
	speed: 0.1371s/iter; left time: 544.8007s
	iters: 400, epoch: 3 | loss: 0.0418481
	speed: 0.1377s/iter; left time: 533.1273s
	iters: 500, epoch: 3 | loss: 0.0318352
	speed: 0.1411s/iter; left time: 532.5501s
Epoch: 3 cost time: 73.94469380378723
Epoch: 3, Steps: 534 | Train Loss: 0.0347637 Vali Loss: 0.0346014 Test Loss: 0.0485471
Validation loss decreased (0.037292 --> 0.034601).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0220187
	speed: 2.6953s/iter; left time: 9808.3237s
	iters: 200, epoch: 4 | loss: 0.0271002
	speed: 0.1378s/iter; left time: 487.7366s
	iters: 300, epoch: 4 | loss: 0.0410552
	speed: 0.1365s/iter; left time: 469.3355s
	iters: 400, epoch: 4 | loss: 0.0359383
	speed: 0.1376s/iter; left time: 459.5911s
	iters: 500, epoch: 4 | loss: 0.0448270
	speed: 0.1357s/iter; left time: 439.5517s
Epoch: 4 cost time: 73.49538016319275
Epoch: 4, Steps: 534 | Train Loss: 0.0322087 Vali Loss: 0.0343445 Test Loss: 0.0476050
Validation loss decreased (0.034601 --> 0.034344).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0292387
	speed: 2.6192s/iter; left time: 8132.6248s
	iters: 200, epoch: 5 | loss: 0.0300352
	speed: 0.1364s/iter; left time: 409.7663s
	iters: 300, epoch: 5 | loss: 0.0324354
	speed: 0.1354s/iter; left time: 393.2667s
	iters: 400, epoch: 5 | loss: 0.0220235
	speed: 0.1365s/iter; left time: 382.9977s
	iters: 500, epoch: 5 | loss: 0.0299023
	speed: 0.1345s/iter; left time: 363.8991s
Epoch: 5 cost time: 72.94555187225342
Epoch: 5, Steps: 534 | Train Loss: 0.0311764 Vali Loss: 0.0338849 Test Loss: 0.0469388
Validation loss decreased (0.034344 --> 0.033885).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0267432
	speed: 2.7106s/iter; left time: 6968.8750s
	iters: 200, epoch: 6 | loss: 0.0292618
	speed: 0.1377s/iter; left time: 340.1656s
	iters: 300, epoch: 6 | loss: 0.0227499
	speed: 0.1374s/iter; left time: 325.8317s
	iters: 400, epoch: 6 | loss: 0.0422827
	speed: 0.1374s/iter; left time: 312.0025s
	iters: 500, epoch: 6 | loss: 0.0322350
	speed: 0.1377s/iter; left time: 298.9955s
Epoch: 6 cost time: 73.09885835647583
Epoch: 6, Steps: 534 | Train Loss: 0.0307770 Vali Loss: 0.0337243 Test Loss: 0.0466364
Validation loss decreased (0.033885 --> 0.033724).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0361158
	speed: 2.7158s/iter; left time: 5532.0116s
	iters: 200, epoch: 7 | loss: 0.0209268
	speed: 0.1364s/iter; left time: 264.2309s
	iters: 300, epoch: 7 | loss: 0.0214799
	speed: 0.1529s/iter; left time: 280.8833s
	iters: 400, epoch: 7 | loss: 0.0337745
	speed: 0.1618s/iter; left time: 280.9673s
	iters: 500, epoch: 7 | loss: 0.0234238
	speed: 0.1492s/iter; left time: 244.2938s
Epoch: 7 cost time: 77.70729446411133
Epoch: 7, Steps: 534 | Train Loss: 0.0304194 Vali Loss: 0.0334004 Test Loss: 0.0469976
Validation loss decreased (0.033724 --> 0.033400).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0208793
	speed: 2.5574s/iter; left time: 3843.7444s
	iters: 200, epoch: 8 | loss: 0.0215645
	speed: 0.1191s/iter; left time: 167.0481s
	iters: 300, epoch: 8 | loss: 0.0344592
	speed: 0.1116s/iter; left time: 145.4794s
	iters: 400, epoch: 8 | loss: 0.0299267
	speed: 0.1039s/iter; left time: 124.9622s
	iters: 500, epoch: 8 | loss: 0.0416267
	speed: 0.1080s/iter; left time: 119.0714s
Epoch: 8 cost time: 61.38260769844055
Epoch: 8, Steps: 534 | Train Loss: 0.0301786 Vali Loss: 0.0335681 Test Loss: 0.0466937
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0495261
	speed: 2.1447s/iter; left time: 2078.2056s
	iters: 200, epoch: 9 | loss: 0.0426296
	speed: 0.1092s/iter; left time: 94.9010s
	iters: 300, epoch: 9 | loss: 0.0201399
	speed: 0.1078s/iter; left time: 82.8694s
	iters: 400, epoch: 9 | loss: 0.0462398
	speed: 0.1086s/iter; left time: 72.6216s
	iters: 500, epoch: 9 | loss: 0.0297081
	speed: 0.1098s/iter; left time: 62.4856s
Epoch: 9 cost time: 58.91507411003113
Epoch: 9, Steps: 534 | Train Loss: 0.0299570 Vali Loss: 0.0332371 Test Loss: 0.0468820
Validation loss decreased (0.033400 --> 0.033237).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.0464742
	speed: 2.2471s/iter; left time: 977.4784s
	iters: 200, epoch: 10 | loss: 0.0573399
	speed: 0.1139s/iter; left time: 38.1719s
	iters: 300, epoch: 10 | loss: 0.0394089
	speed: 0.1124s/iter; left time: 26.4163s
	iters: 400, epoch: 10 | loss: 0.0279720
	speed: 0.1126s/iter; left time: 15.1954s
	iters: 500, epoch: 10 | loss: 0.0246723
	speed: 0.1126s/iter; left time: 3.9404s
Epoch: 10 cost time: 60.3338897228241
Epoch: 10, Steps: 534 | Train Loss: 0.0301347 Vali Loss: 0.0335815 Test Loss: 0.0461459
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : imputation_ETTh2_mask_0.25_TimesNet_ETTh2_ftM_sl96_ll0_pl0_dm32_nh8_el2_dl1_df32_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2881
test shape: (2881, 96, 7) (2881, 96, 7)
mse:0.046753913164138794, mae:0.1437121033668518
