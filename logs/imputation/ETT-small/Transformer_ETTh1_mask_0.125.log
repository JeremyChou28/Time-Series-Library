Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTh1_mask_0.125    Model:              Transformer         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ../iTransformer_datasets/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.125               

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_ETTh1_mask_0.125_Transformer_ETTh1_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8545
val 2881
test 2881
	iters: 100, epoch: 1 | loss: 0.1069158
	speed: 0.0437s/iter; left time: 229.0987s
	iters: 200, epoch: 1 | loss: 0.0944021
	speed: 0.0125s/iter; left time: 64.1770s
	iters: 300, epoch: 1 | loss: 0.0860070
	speed: 0.0116s/iter; left time: 58.7195s
	iters: 400, epoch: 1 | loss: 0.0798712
	speed: 0.0117s/iter; left time: 57.8571s
	iters: 500, epoch: 1 | loss: 0.0793157
	speed: 0.0120s/iter; left time: 57.9009s
Epoch: 1 cost time: 9.551188945770264
Epoch: 1, Steps: 534 | Train Loss: 0.1032451 Vali Loss: 0.1645014 Test Loss: 0.0846307
Validation loss decreased (inf --> 0.164501).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.0695091
	speed: 0.1425s/iter; left time: 670.8135s
	iters: 200, epoch: 2 | loss: 0.0765895
	speed: 0.0093s/iter; left time: 42.7635s
	iters: 300, epoch: 2 | loss: 0.0671496
	speed: 0.0095s/iter; left time: 42.8643s
	iters: 400, epoch: 2 | loss: 0.0610900
	speed: 0.0093s/iter; left time: 40.8171s
	iters: 500, epoch: 2 | loss: 0.0577743
	speed: 0.0093s/iter; left time: 40.0079s
Epoch: 2 cost time: 5.1041107177734375
Epoch: 2, Steps: 534 | Train Loss: 0.0722609 Vali Loss: 0.1572845 Test Loss: 0.0798674
Validation loss decreased (0.164501 --> 0.157285).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0671798
	speed: 0.1373s/iter; left time: 572.8910s
	iters: 200, epoch: 3 | loss: 0.0593100
	speed: 0.0111s/iter; left time: 45.1064s
	iters: 300, epoch: 3 | loss: 0.0606562
	speed: 0.0110s/iter; left time: 43.5250s
	iters: 400, epoch: 3 | loss: 0.0592634
	speed: 0.0104s/iter; left time: 40.3394s
	iters: 500, epoch: 3 | loss: 0.0608007
	speed: 0.0107s/iter; left time: 40.3007s
Epoch: 3 cost time: 5.882002830505371
Epoch: 3, Steps: 534 | Train Loss: 0.0624428 Vali Loss: 0.1529559 Test Loss: 0.0657962
Validation loss decreased (0.157285 --> 0.152956).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0554084
	speed: 0.1339s/iter; left time: 487.1113s
	iters: 200, epoch: 4 | loss: 0.0582464
	speed: 0.0109s/iter; left time: 38.6707s
	iters: 300, epoch: 4 | loss: 0.0605850
	speed: 0.0102s/iter; left time: 35.2376s
	iters: 400, epoch: 4 | loss: 0.0558000
	speed: 0.0103s/iter; left time: 34.3328s
	iters: 500, epoch: 4 | loss: 0.0661124
	speed: 0.0110s/iter; left time: 35.6253s
Epoch: 4 cost time: 5.783547878265381
Epoch: 4, Steps: 534 | Train Loss: 0.0582649 Vali Loss: 0.1517460 Test Loss: 0.0685468
Validation loss decreased (0.152956 --> 0.151746).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0519410
	speed: 0.1287s/iter; left time: 399.6186s
	iters: 200, epoch: 5 | loss: 0.0421730
	speed: 0.0115s/iter; left time: 34.6165s
	iters: 300, epoch: 5 | loss: 0.0573894
	speed: 0.0112s/iter; left time: 32.5505s
	iters: 400, epoch: 5 | loss: 0.0587863
	speed: 0.0106s/iter; left time: 29.7700s
	iters: 500, epoch: 5 | loss: 0.0511404
	speed: 0.0107s/iter; left time: 28.8685s
Epoch: 5 cost time: 6.199428558349609
Epoch: 5, Steps: 534 | Train Loss: 0.0562920 Vali Loss: 0.1499158 Test Loss: 0.0633355
Validation loss decreased (0.151746 --> 0.149916).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0491224
	speed: 0.1299s/iter; left time: 334.0497s
	iters: 200, epoch: 6 | loss: 0.0586714
	speed: 0.0130s/iter; left time: 32.1862s
	iters: 300, epoch: 6 | loss: 0.0540036
	speed: 0.0114s/iter; left time: 27.0452s
	iters: 400, epoch: 6 | loss: 0.0481149
	speed: 0.0117s/iter; left time: 26.5582s
	iters: 500, epoch: 6 | loss: 0.0449295
	speed: 0.0114s/iter; left time: 24.7913s
Epoch: 6 cost time: 6.552805423736572
Epoch: 6, Steps: 534 | Train Loss: 0.0544066 Vali Loss: 0.1423611 Test Loss: 0.0628288
Validation loss decreased (0.149916 --> 0.142361).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0529328
	speed: 0.1363s/iter; left time: 277.7176s
	iters: 200, epoch: 7 | loss: 0.0454413
	speed: 0.0105s/iter; left time: 20.3416s
	iters: 300, epoch: 7 | loss: 0.0608717
	speed: 0.0096s/iter; left time: 17.7213s
	iters: 400, epoch: 7 | loss: 0.0538661
	speed: 0.0108s/iter; left time: 18.7892s
	iters: 500, epoch: 7 | loss: 0.0550088
	speed: 0.0113s/iter; left time: 18.5290s
Epoch: 7 cost time: 5.87205696105957
Epoch: 7, Steps: 534 | Train Loss: 0.0545123 Vali Loss: 0.1482081 Test Loss: 0.0623935
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0523480
	speed: 0.1132s/iter; left time: 170.1655s
	iters: 200, epoch: 8 | loss: 0.0722152
	speed: 0.0126s/iter; left time: 17.6585s
	iters: 300, epoch: 8 | loss: 0.0576259
	speed: 0.0121s/iter; left time: 15.7376s
	iters: 400, epoch: 8 | loss: 0.0761244
	speed: 0.0122s/iter; left time: 14.6212s
	iters: 500, epoch: 8 | loss: 0.0629274
	speed: 0.0113s/iter; left time: 12.5048s
Epoch: 8 cost time: 6.44565486907959
Epoch: 8, Steps: 534 | Train Loss: 0.0541085 Vali Loss: 0.1469726 Test Loss: 0.0629528
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0476862
	speed: 0.1129s/iter; left time: 109.4468s
	iters: 200, epoch: 9 | loss: 0.0552395
	speed: 0.0107s/iter; left time: 9.2574s
	iters: 300, epoch: 9 | loss: 0.0499787
	speed: 0.0106s/iter; left time: 8.1755s
	iters: 400, epoch: 9 | loss: 0.0575648
	speed: 0.0106s/iter; left time: 7.0755s
	iters: 500, epoch: 9 | loss: 0.0481071
	speed: 0.0110s/iter; left time: 6.2422s
Epoch: 9 cost time: 5.814576864242554
Epoch: 9, Steps: 534 | Train Loss: 0.0536023 Vali Loss: 0.1478101 Test Loss: 0.0616527
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTh1_mask_0.125_Transformer_ETTh1_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2881
test shape: (2881, 96, 7) (2881, 96, 7)
mse:0.06257319450378418, mae:0.1768644154071808
