Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTh1_mask_0.375    Model:              Transformer         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ../iTransformer_datasets/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.375               

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_ETTh1_mask_0.375_Transformer_ETTh1_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8545
val 2881
test 2881
	iters: 100, epoch: 1 | loss: 0.1486203
	speed: 0.0435s/iter; left time: 228.1976s
	iters: 200, epoch: 1 | loss: 0.1333759
	speed: 0.0128s/iter; left time: 65.6191s
	iters: 300, epoch: 1 | loss: 0.1305102
	speed: 0.0129s/iter; left time: 65.1067s
	iters: 400, epoch: 1 | loss: 0.1168275
	speed: 0.0136s/iter; left time: 67.2352s
	iters: 500, epoch: 1 | loss: 0.1120075
	speed: 0.0115s/iter; left time: 55.5819s
Epoch: 1 cost time: 9.797216892242432
Epoch: 1, Steps: 534 | Train Loss: 0.1457418 Vali Loss: 0.2668056 Test Loss: 0.1451177
Validation loss decreased (inf --> 0.266806).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1000119
	speed: 0.1883s/iter; left time: 886.4302s
	iters: 200, epoch: 2 | loss: 0.1153085
	speed: 0.0133s/iter; left time: 61.1336s
	iters: 300, epoch: 2 | loss: 0.1035796
	speed: 0.0128s/iter; left time: 57.4840s
	iters: 400, epoch: 2 | loss: 0.0954002
	speed: 0.0120s/iter; left time: 52.9845s
	iters: 500, epoch: 2 | loss: 0.0915330
	speed: 0.0120s/iter; left time: 51.7009s
Epoch: 2 cost time: 6.669828414916992
Epoch: 2, Steps: 534 | Train Loss: 0.1061937 Vali Loss: 0.2582748 Test Loss: 0.1379131
Validation loss decreased (0.266806 --> 0.258275).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0982018
	speed: 0.1825s/iter; left time: 761.5941s
	iters: 200, epoch: 3 | loss: 0.0860781
	speed: 0.0118s/iter; left time: 48.0481s
	iters: 300, epoch: 3 | loss: 0.0836902
	speed: 0.0118s/iter; left time: 46.8773s
	iters: 400, epoch: 3 | loss: 0.1032761
	speed: 0.0122s/iter; left time: 47.3176s
	iters: 500, epoch: 3 | loss: 0.0981702
	speed: 0.0116s/iter; left time: 43.7256s
Epoch: 3 cost time: 6.444648027420044
Epoch: 3, Steps: 534 | Train Loss: 0.0922668 Vali Loss: 0.2423502 Test Loss: 0.1211021
Validation loss decreased (0.258275 --> 0.242350).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0752771
	speed: 0.1522s/iter; left time: 553.7676s
	iters: 200, epoch: 4 | loss: 0.0880848
	speed: 0.0110s/iter; left time: 38.9350s
	iters: 300, epoch: 4 | loss: 0.0935775
	speed: 0.0108s/iter; left time: 37.2833s
	iters: 400, epoch: 4 | loss: 0.0874294
	speed: 0.0122s/iter; left time: 40.6832s
	iters: 500, epoch: 4 | loss: 0.0870326
	speed: 0.0099s/iter; left time: 31.9973s
Epoch: 4 cost time: 5.879493236541748
Epoch: 4, Steps: 534 | Train Loss: 0.0865943 Vali Loss: 0.2400644 Test Loss: 0.1157577
Validation loss decreased (0.242350 --> 0.240064).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0789172
	speed: 0.1480s/iter; left time: 459.4001s
	iters: 200, epoch: 5 | loss: 0.0752586
	speed: 0.0106s/iter; left time: 31.9664s
	iters: 300, epoch: 5 | loss: 0.0882087
	speed: 0.0115s/iter; left time: 33.4333s
	iters: 400, epoch: 5 | loss: 0.0897073
	speed: 0.0117s/iter; left time: 32.6943s
	iters: 500, epoch: 5 | loss: 0.0772659
	speed: 0.0119s/iter; left time: 32.2333s
Epoch: 5 cost time: 6.060431241989136
Epoch: 5, Steps: 534 | Train Loss: 0.0830939 Vali Loss: 0.2413468 Test Loss: 0.1110356
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0776202
	speed: 0.1163s/iter; left time: 299.0435s
	iters: 200, epoch: 6 | loss: 0.0892053
	speed: 0.0114s/iter; left time: 28.1458s
	iters: 300, epoch: 6 | loss: 0.0802650
	speed: 0.0112s/iter; left time: 26.5870s
	iters: 400, epoch: 6 | loss: 0.0671969
	speed: 0.0113s/iter; left time: 25.7136s
	iters: 500, epoch: 6 | loss: 0.0818515
	speed: 0.0120s/iter; left time: 26.0206s
Epoch: 6 cost time: 6.1580493450164795
Epoch: 6, Steps: 534 | Train Loss: 0.0814700 Vali Loss: 0.2413703 Test Loss: 0.1124297
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0765108
	speed: 0.1197s/iter; left time: 243.7458s
	iters: 200, epoch: 7 | loss: 0.0765608
	speed: 0.0119s/iter; left time: 23.0351s
	iters: 300, epoch: 7 | loss: 0.0827342
	speed: 0.0115s/iter; left time: 21.1533s
	iters: 400, epoch: 7 | loss: 0.0859777
	speed: 0.0129s/iter; left time: 22.4065s
	iters: 500, epoch: 7 | loss: 0.0871566
	speed: 0.0164s/iter; left time: 26.8011s
Epoch: 7 cost time: 6.970861196517944
Epoch: 7, Steps: 534 | Train Loss: 0.0808202 Vali Loss: 0.2433695 Test Loss: 0.1106532
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTh1_mask_0.375_Transformer_ETTh1_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2881
test shape: (2881, 96, 7) (2881, 96, 7)
mse:0.11575300246477127, mae:0.24109521508216858
