Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTh1_mask_0.5      Model:              Transformer         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ../iTransformer_datasets/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.5                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_ETTh1_mask_0.5_Transformer_ETTh1_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8545
val 2881
test 2881
	iters: 100, epoch: 1 | loss: 0.1693239
	speed: 0.0425s/iter; left time: 222.5461s
	iters: 200, epoch: 1 | loss: 0.1478760
	speed: 0.0108s/iter; left time: 55.5878s
	iters: 300, epoch: 1 | loss: 0.1647879
	speed: 0.0118s/iter; left time: 59.5569s
	iters: 400, epoch: 1 | loss: 0.1366111
	speed: 0.0122s/iter; left time: 60.2494s
	iters: 500, epoch: 1 | loss: 0.1323229
	speed: 0.0129s/iter; left time: 62.3170s
Epoch: 1 cost time: 9.475846767425537
Epoch: 1, Steps: 534 | Train Loss: 0.1721846 Vali Loss: 0.3254960 Test Loss: 0.1883392
Validation loss decreased (inf --> 0.325496).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1174159
	speed: 0.1946s/iter; left time: 915.8385s
	iters: 200, epoch: 2 | loss: 0.1298201
	speed: 0.0113s/iter; left time: 52.0558s
	iters: 300, epoch: 2 | loss: 0.1244638
	speed: 0.0115s/iter; left time: 51.8809s
	iters: 400, epoch: 2 | loss: 0.1106760
	speed: 0.0120s/iter; left time: 52.8636s
	iters: 500, epoch: 2 | loss: 0.1129814
	speed: 0.0115s/iter; left time: 49.4608s
Epoch: 2 cost time: 6.2629594802856445
Epoch: 2, Steps: 534 | Train Loss: 0.1246029 Vali Loss: 0.2922859 Test Loss: 0.1682589
Validation loss decreased (0.325496 --> 0.292286).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1046236
	speed: 0.1859s/iter; left time: 775.8638s
	iters: 200, epoch: 3 | loss: 0.0994346
	speed: 0.0112s/iter; left time: 45.6181s
	iters: 300, epoch: 3 | loss: 0.0939499
	speed: 0.0112s/iter; left time: 44.6407s
	iters: 400, epoch: 3 | loss: 0.1151856
	speed: 0.0112s/iter; left time: 43.5482s
	iters: 500, epoch: 3 | loss: 0.1149175
	speed: 0.0106s/iter; left time: 40.0163s
Epoch: 3 cost time: 5.938281297683716
Epoch: 3, Steps: 534 | Train Loss: 0.1054851 Vali Loss: 0.2784041 Test Loss: 0.1460167
Validation loss decreased (0.292286 --> 0.278404).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0881343
	speed: 0.1415s/iter; left time: 514.7527s
	iters: 200, epoch: 4 | loss: 0.1014827
	speed: 0.0117s/iter; left time: 41.3881s
	iters: 300, epoch: 4 | loss: 0.1075095
	speed: 0.0112s/iter; left time: 38.5623s
	iters: 400, epoch: 4 | loss: 0.0954755
	speed: 0.0106s/iter; left time: 35.4917s
	iters: 500, epoch: 4 | loss: 0.1037590
	speed: 0.0110s/iter; left time: 35.6087s
Epoch: 4 cost time: 6.8180015087127686
Epoch: 4, Steps: 534 | Train Loss: 0.0983504 Vali Loss: 0.2741371 Test Loss: 0.1387078
Validation loss decreased (0.278404 --> 0.274137).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0897796
	speed: 0.1394s/iter; left time: 432.6854s
	iters: 200, epoch: 5 | loss: 0.0819933
	speed: 0.0107s/iter; left time: 32.2650s
	iters: 300, epoch: 5 | loss: 0.0940191
	speed: 0.0109s/iter; left time: 31.5362s
	iters: 400, epoch: 5 | loss: 0.0978143
	speed: 0.0109s/iter; left time: 30.6158s
	iters: 500, epoch: 5 | loss: 0.0890825
	speed: 0.0116s/iter; left time: 31.4930s
Epoch: 5 cost time: 5.909421443939209
Epoch: 5, Steps: 534 | Train Loss: 0.0943973 Vali Loss: 0.2720855 Test Loss: 0.1340168
Validation loss decreased (0.274137 --> 0.272085).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0947129
	speed: 0.1412s/iter; left time: 363.1315s
	iters: 200, epoch: 6 | loss: 0.0967632
	speed: 0.0111s/iter; left time: 27.5180s
	iters: 300, epoch: 6 | loss: 0.0921238
	speed: 0.0105s/iter; left time: 24.9774s
	iters: 400, epoch: 6 | loss: 0.0764396
	speed: 0.0109s/iter; left time: 24.6844s
	iters: 500, epoch: 6 | loss: 0.0872732
	speed: 0.0116s/iter; left time: 25.1553s
Epoch: 6 cost time: 5.958646774291992
Epoch: 6, Steps: 534 | Train Loss: 0.0925913 Vali Loss: 0.2705578 Test Loss: 0.1336866
Validation loss decreased (0.272085 --> 0.270558).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0917687
	speed: 0.1470s/iter; left time: 299.4277s
	iters: 200, epoch: 7 | loss: 0.0896516
	speed: 0.0118s/iter; left time: 22.8355s
	iters: 300, epoch: 7 | loss: 0.0960805
	speed: 0.0118s/iter; left time: 21.7667s
	iters: 400, epoch: 7 | loss: 0.0958747
	speed: 0.0138s/iter; left time: 24.0217s
	iters: 500, epoch: 7 | loss: 0.0942279
	speed: 0.0131s/iter; left time: 21.4800s
Epoch: 7 cost time: 6.692942142486572
Epoch: 7, Steps: 534 | Train Loss: 0.0923159 Vali Loss: 0.2723915 Test Loss: 0.1325733
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0833606
	speed: 0.1156s/iter; left time: 173.8115s
	iters: 200, epoch: 8 | loss: 0.1172438
	speed: 0.0111s/iter; left time: 15.6164s
	iters: 300, epoch: 8 | loss: 0.0918838
	speed: 0.0108s/iter; left time: 14.0349s
	iters: 400, epoch: 8 | loss: 0.1044973
	speed: 0.0108s/iter; left time: 12.9347s
	iters: 500, epoch: 8 | loss: 0.0982985
	speed: 0.0112s/iter; left time: 12.3975s
Epoch: 8 cost time: 5.932779550552368
Epoch: 8, Steps: 534 | Train Loss: 0.0918478 Vali Loss: 0.2717337 Test Loss: 0.1343243
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0900002
	speed: 0.1104s/iter; left time: 106.9773s
	iters: 200, epoch: 9 | loss: 0.0916182
	speed: 0.0105s/iter; left time: 9.0935s
	iters: 300, epoch: 9 | loss: 0.0851622
	speed: 0.0103s/iter; left time: 7.9039s
	iters: 400, epoch: 9 | loss: 0.0981259
	speed: 0.0111s/iter; left time: 7.4220s
	iters: 500, epoch: 9 | loss: 0.0917078
	speed: 0.0105s/iter; left time: 5.9718s
Epoch: 9 cost time: 5.7450034618377686
Epoch: 9, Steps: 534 | Train Loss: 0.0909518 Vali Loss: 0.2714321 Test Loss: 0.1337735
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTh1_mask_0.5_Transformer_ETTh1_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2881
test shape: (2881, 96, 7) (2881, 96, 7)
mse:0.1343322992324829, mae:0.2623276710510254
