Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTh2_mask_0.125    Model:              Transformer         

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ../iTransformer_datasets/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.125               

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_ETTh2_mask_0.125_Transformer_ETTh2_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8545
val 2881
test 2881
	iters: 100, epoch: 1 | loss: 0.0889549
	speed: 0.0442s/iter; left time: 231.8540s
	iters: 200, epoch: 1 | loss: 0.1063996
	speed: 0.0139s/iter; left time: 71.5145s
	iters: 300, epoch: 1 | loss: 0.0815750
	speed: 0.0169s/iter; left time: 85.1560s
	iters: 400, epoch: 1 | loss: 0.0692107
	speed: 0.0152s/iter; left time: 74.9846s
	iters: 500, epoch: 1 | loss: 0.0470512
	speed: 0.0159s/iter; left time: 77.0129s
Epoch: 1 cost time: 11.018487453460693
Epoch: 1, Steps: 534 | Train Loss: 0.0916499 Vali Loss: 0.1238613 Test Loss: 0.2130485
Validation loss decreased (inf --> 0.123861).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.0517292
	speed: 0.1301s/iter; left time: 612.2928s
	iters: 200, epoch: 2 | loss: 0.0553457
	speed: 0.0163s/iter; left time: 75.0471s
	iters: 300, epoch: 2 | loss: 0.0521719
	speed: 0.0145s/iter; left time: 65.4141s
	iters: 400, epoch: 2 | loss: 0.0550674
	speed: 0.0150s/iter; left time: 66.0856s
	iters: 500, epoch: 2 | loss: 0.0530609
	speed: 0.0116s/iter; left time: 49.8943s
Epoch: 2 cost time: 7.8588714599609375
Epoch: 2, Steps: 534 | Train Loss: 0.0552669 Vali Loss: 0.0970129 Test Loss: 0.1883012
Validation loss decreased (0.123861 --> 0.097013).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0630101
	speed: 0.1298s/iter; left time: 541.7297s
	iters: 200, epoch: 3 | loss: 0.0455270
	speed: 0.0158s/iter; left time: 64.4825s
	iters: 300, epoch: 3 | loss: 0.0395195
	speed: 0.0147s/iter; left time: 58.2192s
	iters: 400, epoch: 3 | loss: 0.0346328
	speed: 0.0156s/iter; left time: 60.5345s
	iters: 500, epoch: 3 | loss: 0.0715829
	speed: 0.0152s/iter; left time: 57.1793s
Epoch: 3 cost time: 8.060216188430786
Epoch: 3, Steps: 534 | Train Loss: 0.0462336 Vali Loss: 0.0846651 Test Loss: 0.1905286
Validation loss decreased (0.097013 --> 0.084665).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0351060
	speed: 0.1275s/iter; left time: 463.9030s
	iters: 200, epoch: 4 | loss: 0.0505069
	speed: 0.0153s/iter; left time: 54.1368s
	iters: 300, epoch: 4 | loss: 0.0467369
	speed: 0.0170s/iter; left time: 58.4447s
	iters: 400, epoch: 4 | loss: 0.0380141
	speed: 0.0156s/iter; left time: 51.9730s
	iters: 500, epoch: 4 | loss: 0.0601670
	speed: 0.0139s/iter; left time: 45.0938s
Epoch: 4 cost time: 8.153190612792969
Epoch: 4, Steps: 534 | Train Loss: 0.0424037 Vali Loss: 0.0908901 Test Loss: 0.1785979
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0466869
	speed: 0.1254s/iter; left time: 389.3823s
	iters: 200, epoch: 5 | loss: 0.0295309
	speed: 0.0135s/iter; left time: 40.5477s
	iters: 300, epoch: 5 | loss: 0.0459624
	speed: 0.0124s/iter; left time: 35.9479s
	iters: 400, epoch: 5 | loss: 0.0340669
	speed: 0.0114s/iter; left time: 32.0017s
	iters: 500, epoch: 5 | loss: 0.0324713
	speed: 0.0115s/iter; left time: 31.1509s
Epoch: 5 cost time: 6.6343607902526855
Epoch: 5, Steps: 534 | Train Loss: 0.0412812 Vali Loss: 0.0899934 Test Loss: 0.1942451
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0464366
	speed: 0.1179s/iter; left time: 303.2100s
	iters: 200, epoch: 6 | loss: 0.0386035
	speed: 0.0124s/iter; left time: 30.5173s
	iters: 300, epoch: 6 | loss: 0.0256422
	speed: 0.0123s/iter; left time: 29.0652s
	iters: 400, epoch: 6 | loss: 0.0404767
	speed: 0.0122s/iter; left time: 27.7044s
	iters: 500, epoch: 6 | loss: 0.0297733
	speed: 0.0117s/iter; left time: 25.4132s
Epoch: 6 cost time: 6.483913421630859
Epoch: 6, Steps: 534 | Train Loss: 0.0395739 Vali Loss: 0.0791403 Test Loss: 0.1707585
Validation loss decreased (0.084665 --> 0.079140).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0364291
	speed: 0.1264s/iter; left time: 257.5603s
	iters: 200, epoch: 7 | loss: 0.0521247
	speed: 0.0134s/iter; left time: 26.0468s
	iters: 300, epoch: 7 | loss: 0.0313588
	speed: 0.0139s/iter; left time: 25.4894s
	iters: 400, epoch: 7 | loss: 0.0389561
	speed: 0.0119s/iter; left time: 20.6543s
	iters: 500, epoch: 7 | loss: 0.0323819
	speed: 0.0114s/iter; left time: 18.6606s
Epoch: 7 cost time: 6.753519296646118
Epoch: 7, Steps: 534 | Train Loss: 0.0395083 Vali Loss: 0.0809546 Test Loss: 0.1717038
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0374905
	speed: 0.1112s/iter; left time: 167.1691s
	iters: 200, epoch: 8 | loss: 0.0469288
	speed: 0.0105s/iter; left time: 14.6735s
	iters: 300, epoch: 8 | loss: 0.0380039
	speed: 0.0115s/iter; left time: 14.9783s
	iters: 400, epoch: 8 | loss: 0.0411701
	speed: 0.0121s/iter; left time: 14.5934s
	iters: 500, epoch: 8 | loss: 0.0351581
	speed: 0.0110s/iter; left time: 12.1475s
Epoch: 8 cost time: 5.867960691452026
Epoch: 8, Steps: 534 | Train Loss: 0.0385329 Vali Loss: 0.0811642 Test Loss: 0.1743001
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0342848
	speed: 0.1057s/iter; left time: 102.4013s
	iters: 200, epoch: 9 | loss: 0.0385070
	speed: 0.0101s/iter; left time: 8.7489s
	iters: 300, epoch: 9 | loss: 0.0405593
	speed: 0.0100s/iter; left time: 7.6758s
	iters: 400, epoch: 9 | loss: 0.0328814
	speed: 0.0100s/iter; left time: 6.6587s
	iters: 500, epoch: 9 | loss: 0.0556166
	speed: 0.0100s/iter; left time: 5.6755s
Epoch: 9 cost time: 5.410757780075073
Epoch: 9, Steps: 534 | Train Loss: 0.0392290 Vali Loss: 0.0820313 Test Loss: 0.1799208
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTh2_mask_0.125_Transformer_ETTh2_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2881
test shape: (2881, 96, 7) (2881, 96, 7)
mse:0.17416800558567047, mae:0.30910393595695496
