Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTh2_mask_0.375    Model:              Transformer         

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ../iTransformer_datasets/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.375               

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_ETTh2_mask_0.375_Transformer_ETTh2_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8545
val 2881
test 2881
	iters: 100, epoch: 1 | loss: 0.1219436
	speed: 0.0438s/iter; left time: 229.7680s
	iters: 200, epoch: 1 | loss: 0.1557054
	speed: 0.0129s/iter; left time: 66.5117s
	iters: 300, epoch: 1 | loss: 0.1151423
	speed: 0.0126s/iter; left time: 63.4073s
	iters: 400, epoch: 1 | loss: 0.0831239
	speed: 0.0128s/iter; left time: 63.4635s
	iters: 500, epoch: 1 | loss: 0.0708042
	speed: 0.0126s/iter; left time: 60.7889s
Epoch: 1 cost time: 9.906602621078491
Epoch: 1, Steps: 534 | Train Loss: 0.1226605 Vali Loss: 0.1631450 Test Loss: 0.3277045
Validation loss decreased (inf --> 0.163145).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.0706399
	speed: 0.1271s/iter; left time: 598.4178s
	iters: 200, epoch: 2 | loss: 0.0876952
	speed: 0.0138s/iter; left time: 63.4589s
	iters: 300, epoch: 2 | loss: 0.0798266
	speed: 0.0128s/iter; left time: 57.5021s
	iters: 400, epoch: 2 | loss: 0.0727280
	speed: 0.0134s/iter; left time: 59.1830s
	iters: 500, epoch: 2 | loss: 0.0812357
	speed: 0.0125s/iter; left time: 53.9871s
Epoch: 2 cost time: 6.844675779342651
Epoch: 2, Steps: 534 | Train Loss: 0.0811054 Vali Loss: 0.1442462 Test Loss: 0.3177257
Validation loss decreased (0.163145 --> 0.144246).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0858411
	speed: 0.1311s/iter; left time: 547.0180s
	iters: 200, epoch: 3 | loss: 0.0671517
	speed: 0.0145s/iter; left time: 58.8988s
	iters: 300, epoch: 3 | loss: 0.0579701
	speed: 0.0146s/iter; left time: 58.0322s
	iters: 400, epoch: 3 | loss: 0.0542806
	speed: 0.0138s/iter; left time: 53.3375s
	iters: 500, epoch: 3 | loss: 0.1002202
	speed: 0.0147s/iter; left time: 55.5638s
Epoch: 3 cost time: 7.449746608734131
Epoch: 3, Steps: 534 | Train Loss: 0.0699844 Vali Loss: 0.1233461 Test Loss: 0.2835538
Validation loss decreased (0.144246 --> 0.123346).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0563947
	speed: 0.1296s/iter; left time: 471.4694s
	iters: 200, epoch: 4 | loss: 0.0799538
	speed: 0.0121s/iter; left time: 42.9711s
	iters: 300, epoch: 4 | loss: 0.0627442
	speed: 0.0131s/iter; left time: 45.0668s
	iters: 400, epoch: 4 | loss: 0.0747636
	speed: 0.0128s/iter; left time: 42.6170s
	iters: 500, epoch: 4 | loss: 0.0729312
	speed: 0.0115s/iter; left time: 37.3839s
Epoch: 4 cost time: 6.48584771156311
Epoch: 4, Steps: 534 | Train Loss: 0.0650077 Vali Loss: 0.1274037 Test Loss: 0.3195608
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0753632
	speed: 0.1277s/iter; left time: 396.5168s
	iters: 200, epoch: 5 | loss: 0.0530192
	speed: 0.0122s/iter; left time: 36.8063s
	iters: 300, epoch: 5 | loss: 0.0797171
	speed: 0.0119s/iter; left time: 34.7140s
	iters: 400, epoch: 5 | loss: 0.0501831
	speed: 0.0126s/iter; left time: 35.2483s
	iters: 500, epoch: 5 | loss: 0.0550946
	speed: 0.0135s/iter; left time: 36.5697s
Epoch: 5 cost time: 6.711333274841309
Epoch: 5, Steps: 534 | Train Loss: 0.0623878 Vali Loss: 0.1138068 Test Loss: 0.2930821
Validation loss decreased (0.123346 --> 0.113807).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0667774
	speed: 0.1254s/iter; left time: 322.4705s
	iters: 200, epoch: 6 | loss: 0.0614051
	speed: 0.0117s/iter; left time: 28.8788s
	iters: 300, epoch: 6 | loss: 0.0544869
	speed: 0.0129s/iter; left time: 30.4756s
	iters: 400, epoch: 6 | loss: 0.0538248
	speed: 0.0119s/iter; left time: 27.0825s
	iters: 500, epoch: 6 | loss: 0.0478768
	speed: 0.0122s/iter; left time: 26.4690s
Epoch: 6 cost time: 6.502705097198486
Epoch: 6, Steps: 534 | Train Loss: 0.0612860 Vali Loss: 0.1171817 Test Loss: 0.2914028
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0546160
	speed: 0.1239s/iter; left time: 252.3415s
	iters: 200, epoch: 7 | loss: 0.0594966
	speed: 0.0111s/iter; left time: 21.4583s
	iters: 300, epoch: 7 | loss: 0.0577743
	speed: 0.0124s/iter; left time: 22.7787s
	iters: 400, epoch: 7 | loss: 0.0698056
	speed: 0.0123s/iter; left time: 21.4206s
	iters: 500, epoch: 7 | loss: 0.0511143
	speed: 0.0125s/iter; left time: 20.4467s
Epoch: 7 cost time: 6.504039525985718
Epoch: 7, Steps: 534 | Train Loss: 0.0608713 Vali Loss: 0.1184759 Test Loss: 0.2968132
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0544004
	speed: 0.1186s/iter; left time: 178.3061s
	iters: 200, epoch: 8 | loss: 0.0705526
	speed: 0.0111s/iter; left time: 15.5870s
	iters: 300, epoch: 8 | loss: 0.0825528
	speed: 0.0128s/iter; left time: 16.6951s
	iters: 400, epoch: 8 | loss: 0.0600548
	speed: 0.0123s/iter; left time: 14.8060s
	iters: 500, epoch: 8 | loss: 0.0527015
	speed: 0.0117s/iter; left time: 12.8727s
Epoch: 8 cost time: 6.27218770980835
Epoch: 8, Steps: 534 | Train Loss: 0.0596399 Vali Loss: 0.1154452 Test Loss: 0.2928472
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTh2_mask_0.375_Transformer_ETTh2_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2881
test shape: (2881, 96, 7) (2881, 96, 7)
mse:0.29412972927093506, mae:0.3980264663696289
