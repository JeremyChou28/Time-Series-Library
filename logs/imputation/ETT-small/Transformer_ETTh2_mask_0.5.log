Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTh2_mask_0.5      Model:              Transformer         

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ../iTransformer_datasets/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.5                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_ETTh2_mask_0.5_Transformer_ETTh2_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8545
val 2881
test 2881
	iters: 100, epoch: 1 | loss: 0.1322626
	speed: 0.0457s/iter; left time: 239.3737s
	iters: 200, epoch: 1 | loss: 0.1707982
	speed: 0.0165s/iter; left time: 84.8571s
	iters: 300, epoch: 1 | loss: 0.1394279
	speed: 0.0150s/iter; left time: 75.6348s
	iters: 400, epoch: 1 | loss: 0.0899860
	speed: 0.0152s/iter; left time: 75.0673s
	iters: 500, epoch: 1 | loss: 0.0864955
	speed: 0.0145s/iter; left time: 70.1682s
Epoch: 1 cost time: 11.046820640563965
Epoch: 1, Steps: 534 | Train Loss: 0.1384189 Vali Loss: 0.1660869 Test Loss: 0.3239745
Validation loss decreased (inf --> 0.166087).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.0778926
	speed: 0.1306s/iter; left time: 614.6885s
	iters: 200, epoch: 2 | loss: 0.0981868
	speed: 0.0149s/iter; left time: 68.6461s
	iters: 300, epoch: 2 | loss: 0.1009180
	speed: 0.0170s/iter; left time: 76.5088s
	iters: 400, epoch: 2 | loss: 0.0806675
	speed: 0.0158s/iter; left time: 69.5831s
	iters: 500, epoch: 2 | loss: 0.0898864
	speed: 0.0124s/iter; left time: 53.3168s
Epoch: 2 cost time: 8.071895837783813
Epoch: 2, Steps: 534 | Train Loss: 0.0946916 Vali Loss: 0.1702386 Test Loss: 0.3347685
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1072113
	speed: 0.1244s/iter; left time: 519.0124s
	iters: 200, epoch: 3 | loss: 0.0721111
	speed: 0.0141s/iter; left time: 57.5690s
	iters: 300, epoch: 3 | loss: 0.0740953
	speed: 0.0139s/iter; left time: 55.2221s
	iters: 400, epoch: 3 | loss: 0.0654071
	speed: 0.0141s/iter; left time: 54.7428s
	iters: 500, epoch: 3 | loss: 0.1063130
	speed: 0.0137s/iter; left time: 51.5144s
Epoch: 3 cost time: 7.4039599895477295
Epoch: 3, Steps: 534 | Train Loss: 0.0815805 Vali Loss: 0.1433895 Test Loss: 0.3458422
Validation loss decreased (0.166087 --> 0.143390).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0685081
	speed: 0.1303s/iter; left time: 474.2389s
	iters: 200, epoch: 4 | loss: 0.0963114
	speed: 0.0149s/iter; left time: 52.8483s
	iters: 300, epoch: 4 | loss: 0.0697939
	speed: 0.0143s/iter; left time: 49.0553s
	iters: 400, epoch: 4 | loss: 0.0829575
	speed: 0.0145s/iter; left time: 48.5199s
	iters: 500, epoch: 4 | loss: 0.0861266
	speed: 0.0141s/iter; left time: 45.5817s
Epoch: 4 cost time: 7.872746706008911
Epoch: 4, Steps: 534 | Train Loss: 0.0761452 Vali Loss: 0.1309138 Test Loss: 0.3300848
Validation loss decreased (0.143390 --> 0.130914).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0805620
	speed: 0.1295s/iter; left time: 401.9485s
	iters: 200, epoch: 5 | loss: 0.0600868
	speed: 0.0148s/iter; left time: 44.5150s
	iters: 300, epoch: 5 | loss: 0.0993065
	speed: 0.0150s/iter; left time: 43.4819s
	iters: 400, epoch: 5 | loss: 0.0640626
	speed: 0.0114s/iter; left time: 31.9566s
	iters: 500, epoch: 5 | loss: 0.0638789
	speed: 0.0131s/iter; left time: 35.3519s
Epoch: 5 cost time: 7.112536430358887
Epoch: 5, Steps: 534 | Train Loss: 0.0728787 Vali Loss: 0.1292740 Test Loss: 0.3440686
Validation loss decreased (0.130914 --> 0.129274).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0869914
	speed: 0.1235s/iter; left time: 317.4050s
	iters: 200, epoch: 6 | loss: 0.0857260
	speed: 0.0123s/iter; left time: 30.4451s
	iters: 300, epoch: 6 | loss: 0.0564297
	speed: 0.0122s/iter; left time: 28.8238s
	iters: 400, epoch: 6 | loss: 0.0735086
	speed: 0.0101s/iter; left time: 22.9274s
	iters: 500, epoch: 6 | loss: 0.0569735
	speed: 0.0114s/iter; left time: 24.7735s
Epoch: 6 cost time: 6.296895742416382
Epoch: 6, Steps: 534 | Train Loss: 0.0720175 Vali Loss: 0.1324065 Test Loss: 0.3402844
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0653433
	speed: 0.1210s/iter; left time: 246.4339s
	iters: 200, epoch: 7 | loss: 0.0676470
	speed: 0.0124s/iter; left time: 23.9894s
	iters: 300, epoch: 7 | loss: 0.0686934
	speed: 0.0104s/iter; left time: 19.1915s
	iters: 400, epoch: 7 | loss: 0.0834657
	speed: 0.0108s/iter; left time: 18.6823s
	iters: 500, epoch: 7 | loss: 0.0586463
	speed: 0.0110s/iter; left time: 18.0571s
Epoch: 7 cost time: 6.085196256637573
Epoch: 7, Steps: 534 | Train Loss: 0.0708962 Vali Loss: 0.1320184 Test Loss: 0.3387266
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0677619
	speed: 0.1169s/iter; left time: 175.6453s
	iters: 200, epoch: 8 | loss: 0.0811057
	speed: 0.0128s/iter; left time: 17.9874s
	iters: 300, epoch: 8 | loss: 0.0859427
	speed: 0.0119s/iter; left time: 15.5107s
	iters: 400, epoch: 8 | loss: 0.0678409
	speed: 0.0127s/iter; left time: 15.2460s
	iters: 500, epoch: 8 | loss: 0.0670070
	speed: 0.0110s/iter; left time: 12.1020s
Epoch: 8 cost time: 6.491302013397217
Epoch: 8, Steps: 534 | Train Loss: 0.0698065 Vali Loss: 0.1296001 Test Loss: 0.3345145
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTh2_mask_0.5_Transformer_ETTh2_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2881
test shape: (2881, 96, 7) (2881, 96, 7)
mse:0.3452812135219574, mae:0.43022072315216064
