Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ECL_mask_0.125      Model:              FEDformer           

[1mData Loader[0m
  Data:               custom              Root Path:          ../iTransformer_datasets/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.125               

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 35, 37, 38, 39, 40, 42, 43, 44, 46]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
 fourier enhanced cross attention used!
modes_q=24, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 26, 27, 28, 29, 30, 31, 32, 35, 36, 37, 43, 44, 45]
>>>>>>>start training : imputation_ECL_mask_0.125_FEDformer_custom_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18317
val 2633
test 5261
	iters: 100, epoch: 1 | loss: 0.4012222
	speed: 0.3920s/iter; left time: 4445.8033s
	iters: 200, epoch: 1 | loss: 0.3220936
	speed: 0.3222s/iter; left time: 3622.3521s
	iters: 300, epoch: 1 | loss: 0.3379050
	speed: 0.4233s/iter; left time: 4715.4526s
	iters: 400, epoch: 1 | loss: 0.2791900
	speed: 0.4621s/iter; left time: 5102.2381s
	iters: 500, epoch: 1 | loss: 0.2429600
	speed: 0.5058s/iter; left time: 5533.4586s
	iters: 600, epoch: 1 | loss: 0.2502103
	speed: 0.5738s/iter; left time: 6220.1803s
	iters: 700, epoch: 1 | loss: 0.2442472
	speed: 0.4592s/iter; left time: 4932.3297s
	iters: 800, epoch: 1 | loss: 0.1956819
	speed: 0.2685s/iter; left time: 2857.0728s
	iters: 900, epoch: 1 | loss: 0.2098058
	speed: 0.3625s/iter; left time: 3821.0512s
	iters: 1000, epoch: 1 | loss: 0.2103577
	speed: 0.3187s/iter; left time: 3327.6997s
	iters: 1100, epoch: 1 | loss: 0.2379304
	speed: 0.4944s/iter; left time: 5112.3397s
Epoch: 1 cost time: 483.9747054576874
Epoch: 1, Steps: 1144 | Train Loss: 0.2791435 Vali Loss: 0.1973138 Test Loss: 0.2144162
Validation loss decreased (inf --> 0.197314).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1868425
	speed: 7.9730s/iter; left time: 81300.5686s
	iters: 200, epoch: 2 | loss: 0.1924135
	speed: 0.4330s/iter; left time: 4372.1933s
	iters: 300, epoch: 2 | loss: 0.2039198
	speed: 0.3222s/iter; left time: 3221.2925s
	iters: 400, epoch: 2 | loss: 0.2114548
	speed: 0.2494s/iter; left time: 2468.3433s
	iters: 500, epoch: 2 | loss: 0.2010134
	speed: 0.2822s/iter; left time: 2764.3402s
	iters: 600, epoch: 2 | loss: 0.1917615
	speed: 0.4400s/iter; left time: 4266.5335s
	iters: 700, epoch: 2 | loss: 0.1918895
	speed: 0.4483s/iter; left time: 4302.1437s
	iters: 800, epoch: 2 | loss: 0.1931815
	speed: 0.3860s/iter; left time: 3665.3684s
	iters: 900, epoch: 2 | loss: 0.2089450
	speed: 0.4337s/iter; left time: 4075.7347s
	iters: 1000, epoch: 2 | loss: 0.2056350
	speed: 0.2632s/iter; left time: 2446.7876s
	iters: 1100, epoch: 2 | loss: 0.1586624
	speed: 0.2949s/iter; left time: 2712.3600s
Epoch: 2 cost time: 417.2860186100006
Epoch: 2, Steps: 1144 | Train Loss: 0.1934304 Vali Loss: 0.1771992 Test Loss: 0.1947621
Validation loss decreased (0.197314 --> 0.177199).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1947634
	speed: 5.8687s/iter; left time: 53129.3531s
	iters: 200, epoch: 3 | loss: 0.1772345
	speed: 0.2710s/iter; left time: 2426.2637s
	iters: 300, epoch: 3 | loss: 0.1967753
	speed: 0.2671s/iter; left time: 2364.4515s
	iters: 400, epoch: 3 | loss: 0.1916543
	speed: 0.2891s/iter; left time: 2530.3048s
	iters: 500, epoch: 3 | loss: 0.1574100
	speed: 0.2315s/iter; left time: 2002.8242s
	iters: 600, epoch: 3 | loss: 0.2027765
	speed: 0.2394s/iter; left time: 2047.5646s
	iters: 700, epoch: 3 | loss: 0.1902568
	speed: 0.2562s/iter; left time: 2165.4867s
	iters: 800, epoch: 3 | loss: 0.1601595
	speed: 0.2800s/iter; left time: 2339.0993s
	iters: 900, epoch: 3 | loss: 0.1730535
	speed: 0.2796s/iter; left time: 2307.2555s
	iters: 1000, epoch: 3 | loss: 0.2005983
	speed: 0.2341s/iter; left time: 1908.5690s
	iters: 1100, epoch: 3 | loss: 0.1775738
	speed: 0.2524s/iter; left time: 2032.2020s
Epoch: 3 cost time: 296.50769233703613
Epoch: 3, Steps: 1144 | Train Loss: 0.1819710 Vali Loss: 0.1743993 Test Loss: 0.1892656
Validation loss decreased (0.177199 --> 0.174399).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1739112
	speed: 3.9990s/iter; left time: 31627.9791s
	iters: 200, epoch: 4 | loss: 0.1781093
	speed: 0.2373s/iter; left time: 1852.8462s
	iters: 300, epoch: 4 | loss: 0.1632269
	speed: 0.2533s/iter; left time: 1952.7708s
	iters: 400, epoch: 4 | loss: 0.1639677
	speed: 0.2601s/iter; left time: 1979.4190s
	iters: 500, epoch: 4 | loss: 0.1619883
	speed: 0.2826s/iter; left time: 2121.9156s
	iters: 600, epoch: 4 | loss: 0.1744663
	speed: 0.2611s/iter; left time: 1934.7597s
	iters: 700, epoch: 4 | loss: 0.1733969
	speed: 0.2534s/iter; left time: 1851.8961s
	iters: 800, epoch: 4 | loss: 0.1932170
	speed: 0.2585s/iter; left time: 1863.3541s
	iters: 900, epoch: 4 | loss: 0.1459651
	speed: 0.2481s/iter; left time: 1763.9829s
	iters: 1000, epoch: 4 | loss: 0.1660423
	speed: 0.3913s/iter; left time: 2742.8887s
	iters: 1100, epoch: 4 | loss: 0.1549465
	speed: 0.2879s/iter; left time: 1988.9788s
Epoch: 4 cost time: 307.75554728507996
Epoch: 4, Steps: 1144 | Train Loss: 0.1781484 Vali Loss: 0.1707966 Test Loss: 0.1871203
Validation loss decreased (0.174399 --> 0.170797).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1701292
	speed: 4.0168s/iter; left time: 27173.5107s
	iters: 200, epoch: 5 | loss: 0.1838461
	speed: 0.2349s/iter; left time: 1565.5614s
	iters: 300, epoch: 5 | loss: 0.1806507
	speed: 0.2319s/iter; left time: 1522.6369s
	iters: 400, epoch: 5 | loss: 0.1767413
	speed: 0.2389s/iter; left time: 1544.5429s
	iters: 500, epoch: 5 | loss: 0.1881346
	speed: 0.2552s/iter; left time: 1624.5766s
	iters: 600, epoch: 5 | loss: 0.1687267
	speed: 0.2572s/iter; left time: 1611.6531s
	iters: 700, epoch: 5 | loss: 0.1529142
	speed: 0.2460s/iter; left time: 1516.8758s
	iters: 800, epoch: 5 | loss: 0.1835276
	speed: 0.2520s/iter; left time: 1528.5549s
	iters: 900, epoch: 5 | loss: 0.1721732
	speed: 0.2499s/iter; left time: 1490.5288s
	iters: 1000, epoch: 5 | loss: 0.1953569
	speed: 0.2523s/iter; left time: 1479.9664s
	iters: 1100, epoch: 5 | loss: 0.1700689
	speed: 0.3709s/iter; left time: 2138.1412s
Epoch: 5 cost time: 293.5160734653473
Epoch: 5, Steps: 1144 | Train Loss: 0.1766285 Vali Loss: 0.1701203 Test Loss: 0.1855227
Validation loss decreased (0.170797 --> 0.170120).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1634535
	speed: 3.8530s/iter; left time: 21657.5869s
	iters: 200, epoch: 6 | loss: 0.1673929
	speed: 0.2178s/iter; left time: 1202.6611s
	iters: 300, epoch: 6 | loss: 0.1682588
	speed: 0.2305s/iter; left time: 1249.7843s
	iters: 400, epoch: 6 | loss: 0.1878421
	speed: 0.2430s/iter; left time: 1293.0083s
	iters: 500, epoch: 6 | loss: 0.1980965
	speed: 0.2638s/iter; left time: 1377.3527s
	iters: 600, epoch: 6 | loss: 0.1475184
	speed: 0.2532s/iter; left time: 1296.7974s
	iters: 700, epoch: 6 | loss: 0.1662355
	speed: 0.2348s/iter; left time: 1178.9708s
	iters: 800, epoch: 6 | loss: 0.1899471
	speed: 0.2326s/iter; left time: 1144.6857s
	iters: 900, epoch: 6 | loss: 0.1609122
	speed: 0.2409s/iter; left time: 1161.3112s
	iters: 1000, epoch: 6 | loss: 0.1641720
	speed: 0.2289s/iter; left time: 1080.4843s
	iters: 1100, epoch: 6 | loss: 0.1664882
	speed: 0.2228s/iter; left time: 1029.5203s
Epoch: 6 cost time: 267.8033010959625
Epoch: 6, Steps: 1144 | Train Loss: 0.1756462 Vali Loss: 0.1693871 Test Loss: 0.1842268
Validation loss decreased (0.170120 --> 0.169387).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1620751
	speed: 3.7751s/iter; left time: 16901.1779s
	iters: 200, epoch: 7 | loss: 0.1934504
	speed: 0.2286s/iter; left time: 1000.6077s
	iters: 300, epoch: 7 | loss: 0.1793162
	speed: 0.2254s/iter; left time: 963.9884s
	iters: 400, epoch: 7 | loss: 0.2188387
	speed: 0.2220s/iter; left time: 927.1211s
	iters: 500, epoch: 7 | loss: 0.1868989
	speed: 0.2338s/iter; left time: 953.1412s
	iters: 600, epoch: 7 | loss: 0.1582296
	speed: 0.2590s/iter; left time: 1029.9897s
	iters: 700, epoch: 7 | loss: 0.1519134
	speed: 0.2523s/iter; left time: 978.0642s
	iters: 800, epoch: 7 | loss: 0.1477313
	speed: 0.2272s/iter; left time: 858.1638s
	iters: 900, epoch: 7 | loss: 0.1674348
	speed: 0.2269s/iter; left time: 834.2720s
	iters: 1000, epoch: 7 | loss: 0.1726493
	speed: 0.2240s/iter; left time: 801.0725s
	iters: 1100, epoch: 7 | loss: 0.1592574
	speed: 0.2226s/iter; left time: 773.9052s
Epoch: 7 cost time: 264.1788935661316
Epoch: 7, Steps: 1144 | Train Loss: 0.1753196 Vali Loss: 0.1688402 Test Loss: 0.1840715
Validation loss decreased (0.169387 --> 0.168840).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2048954
	speed: 3.7525s/iter; left time: 12507.1510s
	iters: 200, epoch: 8 | loss: 0.1799358
	speed: 0.2182s/iter; left time: 705.5250s
	iters: 300, epoch: 8 | loss: 0.1776933
	speed: 0.2269s/iter; left time: 710.9753s
	iters: 400, epoch: 8 | loss: 0.1566834
	speed: 0.2449s/iter; left time: 742.6449s
	iters: 500, epoch: 8 | loss: 0.2018137
	speed: 0.2269s/iter; left time: 665.4472s
	iters: 600, epoch: 8 | loss: 0.1702234
	speed: 0.2339s/iter; left time: 662.5807s
	iters: 700, epoch: 8 | loss: 0.1857389
	speed: 0.2465s/iter; left time: 673.6669s
	iters: 800, epoch: 8 | loss: 0.1974713
	speed: 0.2636s/iter; left time: 693.9832s
	iters: 900, epoch: 8 | loss: 0.1601950
	speed: 0.2191s/iter; left time: 554.8941s
	iters: 1000, epoch: 8 | loss: 0.1589701
	speed: 0.2211s/iter; left time: 537.9849s
	iters: 1100, epoch: 8 | loss: 0.1567380
	speed: 0.2284s/iter; left time: 532.8323s
Epoch: 8 cost time: 265.3376715183258
Epoch: 8, Steps: 1144 | Train Loss: 0.1750874 Vali Loss: 0.1680940 Test Loss: 0.1839648
Validation loss decreased (0.168840 --> 0.168094).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1997116
	speed: 3.7767s/iter; left time: 8267.1810s
	iters: 200, epoch: 9 | loss: 0.1764059
	speed: 0.2436s/iter; left time: 508.9021s
	iters: 300, epoch: 9 | loss: 0.1781380
	speed: 0.4414s/iter; left time: 878.0321s
	iters: 400, epoch: 9 | loss: 0.1499511
	speed: 0.2683s/iter; left time: 506.9131s
	iters: 500, epoch: 9 | loss: 0.1923649
	speed: 0.2383s/iter; left time: 426.2909s
	iters: 600, epoch: 9 | loss: 0.1678971
	speed: 0.2540s/iter; left time: 428.9434s
	iters: 700, epoch: 9 | loss: 0.1463601
	speed: 0.2583s/iter; left time: 410.4820s
	iters: 800, epoch: 9 | loss: 0.1750751
	speed: 0.2354s/iter; left time: 350.5825s
	iters: 900, epoch: 9 | loss: 0.1701985
	speed: 0.2360s/iter; left time: 327.7700s
	iters: 1000, epoch: 9 | loss: 0.1583218
	speed: 0.2250s/iter; left time: 290.0355s
	iters: 1100, epoch: 9 | loss: 0.2033980
	speed: 0.2332s/iter; left time: 277.3293s
Epoch: 9 cost time: 297.10018658638
Epoch: 9, Steps: 1144 | Train Loss: 0.1749759 Vali Loss: 0.1683702 Test Loss: 0.1835959
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1616994
	speed: 3.9039s/iter; left time: 4079.5406s
	iters: 200, epoch: 10 | loss: 0.1503847
	speed: 0.2198s/iter; left time: 207.7367s
	iters: 300, epoch: 10 | loss: 0.1892302
	speed: 0.2194s/iter; left time: 185.3948s
	iters: 400, epoch: 10 | loss: 0.1773393
	speed: 0.2237s/iter; left time: 166.6513s
	iters: 500, epoch: 10 | loss: 0.1576951
	speed: 0.2350s/iter; left time: 151.5579s
	iters: 600, epoch: 10 | loss: 0.1694696
	speed: 0.2741s/iter; left time: 149.4045s
	iters: 700, epoch: 10 | loss: 0.1953418
	speed: 0.2464s/iter; left time: 109.6384s
	iters: 800, epoch: 10 | loss: 0.1544982
	speed: 0.2212s/iter; left time: 76.3048s
	iters: 900, epoch: 10 | loss: 0.1988549
	speed: 0.2285s/iter; left time: 55.9868s
	iters: 1000, epoch: 10 | loss: 0.1592360
	speed: 0.2503s/iter; left time: 36.2879s
	iters: 1100, epoch: 10 | loss: 0.1689182
	speed: 0.2601s/iter; left time: 11.7064s
Epoch: 10 cost time: 272.18349742889404
Epoch: 10, Steps: 1144 | Train Loss: 0.1749213 Vali Loss: 0.1685663 Test Loss: 0.1835234
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : imputation_ECL_mask_0.125_FEDformer_custom_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5261
test shape: (5261, 96, 321) (5261, 96, 321)
mse:0.18359476327896118, mae:0.32199493050575256
