Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ECL_mask_0.375      Model:              FEDformer           

[1mData Loader[0m
  Data:               custom              Root Path:          ../iTransformer_datasets/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.375               

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 35, 37, 38, 39, 40, 42, 43, 44, 46]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
 fourier enhanced cross attention used!
modes_q=24, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 26, 27, 28, 29, 30, 31, 32, 35, 36, 37, 43, 44, 45]
>>>>>>>start training : imputation_ECL_mask_0.375_FEDformer_custom_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18317
val 2633
test 5261
	iters: 100, epoch: 1 | loss: 0.4046120
	speed: 0.4009s/iter; left time: 4546.3517s
	iters: 200, epoch: 1 | loss: 0.3328492
	speed: 0.3264s/iter; left time: 3668.6412s
	iters: 300, epoch: 1 | loss: 0.3741010
	speed: 0.4246s/iter; left time: 4730.1703s
	iters: 400, epoch: 1 | loss: 0.3257280
	speed: 0.4435s/iter; left time: 4896.9710s
	iters: 500, epoch: 1 | loss: 0.2900199
	speed: 0.4846s/iter; left time: 5302.3678s
	iters: 600, epoch: 1 | loss: 0.3059773
	speed: 0.6013s/iter; left time: 6518.5457s
	iters: 700, epoch: 1 | loss: 0.2940771
	speed: 0.4627s/iter; left time: 4969.4850s
	iters: 800, epoch: 1 | loss: 0.2347772
	speed: 0.2678s/iter; left time: 2849.4809s
	iters: 900, epoch: 1 | loss: 0.2526433
	speed: 0.3727s/iter; left time: 3928.4951s
	iters: 1000, epoch: 1 | loss: 0.2528386
	speed: 0.3110s/iter; left time: 3247.0140s
	iters: 1100, epoch: 1 | loss: 0.2886924
	speed: 0.4810s/iter; left time: 4974.2762s
Epoch: 1 cost time: 483.98794746398926
Epoch: 1, Steps: 1144 | Train Loss: 0.3170033 Vali Loss: 0.2426651 Test Loss: 0.2663926
Validation loss decreased (inf --> 0.242665).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2273175
	speed: 8.0597s/iter; left time: 82184.9976s
	iters: 200, epoch: 2 | loss: 0.2318860
	speed: 0.4256s/iter; left time: 4296.9778s
	iters: 300, epoch: 2 | loss: 0.2381340
	speed: 0.3088s/iter; left time: 3087.4657s
	iters: 400, epoch: 2 | loss: 0.2592547
	speed: 0.2531s/iter; left time: 2504.4391s
	iters: 500, epoch: 2 | loss: 0.2423512
	speed: 0.2899s/iter; left time: 2840.5487s
	iters: 600, epoch: 2 | loss: 0.2358405
	speed: 0.4582s/iter; left time: 4443.1117s
	iters: 700, epoch: 2 | loss: 0.2370729
	speed: 0.4272s/iter; left time: 4100.2058s
	iters: 800, epoch: 2 | loss: 0.2343549
	speed: 0.3902s/iter; left time: 3705.9886s
	iters: 900, epoch: 2 | loss: 0.2580214
	speed: 0.4372s/iter; left time: 4108.0770s
	iters: 1000, epoch: 2 | loss: 0.2493366
	speed: 0.2572s/iter; left time: 2391.3256s
	iters: 1100, epoch: 2 | loss: 0.1936127
	speed: 0.3115s/iter; left time: 2865.2643s
Epoch: 2 cost time: 422.01892471313477
Epoch: 2, Steps: 1144 | Train Loss: 0.2353466 Vali Loss: 0.2163314 Test Loss: 0.2375609
Validation loss decreased (0.242665 --> 0.216331).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2363975
	speed: 5.9115s/iter; left time: 53516.9739s
	iters: 200, epoch: 3 | loss: 0.2157557
	speed: 0.2845s/iter; left time: 2547.5326s
	iters: 300, epoch: 3 | loss: 0.2410623
	speed: 0.2608s/iter; left time: 2308.7387s
	iters: 400, epoch: 3 | loss: 0.2377301
	speed: 0.2701s/iter; left time: 2363.9571s
	iters: 500, epoch: 3 | loss: 0.1926934
	speed: 0.2307s/iter; left time: 1996.3129s
	iters: 600, epoch: 3 | loss: 0.2531832
	speed: 0.2530s/iter; left time: 2164.2151s
	iters: 700, epoch: 3 | loss: 0.2292421
	speed: 0.2542s/iter; left time: 2148.4474s
	iters: 800, epoch: 3 | loss: 0.1953178
	speed: 0.2930s/iter; left time: 2447.7628s
	iters: 900, epoch: 3 | loss: 0.2105192
	speed: 0.2521s/iter; left time: 2080.2449s
	iters: 1000, epoch: 3 | loss: 0.2448681
	speed: 0.2361s/iter; left time: 1924.5686s
	iters: 1100, epoch: 3 | loss: 0.2170272
	speed: 0.2697s/iter; left time: 2171.9005s
Epoch: 3 cost time: 297.07861614227295
Epoch: 3, Steps: 1144 | Train Loss: 0.2236094 Vali Loss: 0.2120593 Test Loss: 0.2310039
Validation loss decreased (0.216331 --> 0.212059).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2178687
	speed: 4.1359s/iter; left time: 32711.1504s
	iters: 200, epoch: 4 | loss: 0.2232262
	speed: 0.2508s/iter; left time: 1958.6529s
	iters: 300, epoch: 4 | loss: 0.2042583
	speed: 0.2601s/iter; left time: 2005.0844s
	iters: 400, epoch: 4 | loss: 0.2010199
	speed: 0.2780s/iter; left time: 2115.6387s
	iters: 500, epoch: 4 | loss: 0.2001180
	speed: 0.2609s/iter; left time: 1959.3982s
	iters: 600, epoch: 4 | loss: 0.2150915
	speed: 0.2537s/iter; left time: 1879.3625s
	iters: 700, epoch: 4 | loss: 0.2063164
	speed: 0.2579s/iter; left time: 1885.0227s
	iters: 800, epoch: 4 | loss: 0.2352146
	speed: 0.2483s/iter; left time: 1789.9858s
	iters: 900, epoch: 4 | loss: 0.1827032
	speed: 0.4019s/iter; left time: 2857.4051s
	iters: 1000, epoch: 4 | loss: 0.2076996
	speed: 0.2796s/iter; left time: 1959.8393s
	iters: 1100, epoch: 4 | loss: 0.1901034
	speed: 0.2496s/iter; left time: 1724.7194s
Epoch: 4 cost time: 308.9308443069458
Epoch: 4, Steps: 1144 | Train Loss: 0.2199505 Vali Loss: 0.2084229 Test Loss: 0.2295932
Validation loss decreased (0.212059 --> 0.208423).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2090897
	speed: 4.0760s/iter; left time: 27574.2831s
	iters: 200, epoch: 5 | loss: 0.2306689
	speed: 0.2302s/iter; left time: 1534.2699s
	iters: 300, epoch: 5 | loss: 0.2240670
	speed: 0.2477s/iter; left time: 1626.2610s
	iters: 400, epoch: 5 | loss: 0.2222319
	speed: 0.2597s/iter; left time: 1678.6744s
	iters: 500, epoch: 5 | loss: 0.2385978
	speed: 0.2479s/iter; left time: 1578.1329s
	iters: 600, epoch: 5 | loss: 0.2130001
	speed: 0.2451s/iter; left time: 1535.3024s
	iters: 700, epoch: 5 | loss: 0.1918212
	speed: 0.2501s/iter; left time: 1541.7730s
	iters: 800, epoch: 5 | loss: 0.2250815
	speed: 0.2454s/iter; left time: 1488.3517s
	iters: 900, epoch: 5 | loss: 0.2140469
	speed: 0.2608s/iter; left time: 1555.4276s
	iters: 1000, epoch: 5 | loss: 0.2372602
	speed: 0.3671s/iter; left time: 2153.2314s
	iters: 1100, epoch: 5 | loss: 0.2103328
	speed: 0.2648s/iter; left time: 1526.5861s
Epoch: 5 cost time: 295.8342652320862
Epoch: 5, Steps: 1144 | Train Loss: 0.2183019 Vali Loss: 0.2077194 Test Loss: 0.2267438
Validation loss decreased (0.208423 --> 0.207719).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2058166
	speed: 3.8359s/iter; left time: 21561.3281s
	iters: 200, epoch: 6 | loss: 0.2055529
	speed: 0.2328s/iter; left time: 1285.5010s
	iters: 300, epoch: 6 | loss: 0.2093198
	speed: 0.2576s/iter; left time: 1396.4730s
	iters: 400, epoch: 6 | loss: 0.2343382
	speed: 0.2503s/iter; left time: 1331.8020s
	iters: 500, epoch: 6 | loss: 0.2438785
	speed: 0.2384s/iter; left time: 1244.4623s
	iters: 600, epoch: 6 | loss: 0.1818348
	speed: 0.2306s/iter; left time: 1180.9528s
	iters: 700, epoch: 6 | loss: 0.2105180
	speed: 0.2370s/iter; left time: 1189.9691s
	iters: 800, epoch: 6 | loss: 0.2327967
	speed: 0.2376s/iter; left time: 1169.0005s
	iters: 900, epoch: 6 | loss: 0.2002001
	speed: 0.2221s/iter; left time: 1070.5674s
	iters: 1000, epoch: 6 | loss: 0.2062147
	speed: 0.2216s/iter; left time: 1046.3876s
	iters: 1100, epoch: 6 | loss: 0.2099595
	speed: 0.2386s/iter; left time: 1102.4663s
Epoch: 6 cost time: 270.0765919685364
Epoch: 6, Steps: 1144 | Train Loss: 0.2174733 Vali Loss: 0.2071465 Test Loss: 0.2266323
Validation loss decreased (0.207719 --> 0.207147).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1989322
	speed: 3.8572s/iter; left time: 17268.5800s
	iters: 200, epoch: 7 | loss: 0.2430231
	speed: 0.2178s/iter; left time: 953.5261s
	iters: 300, epoch: 7 | loss: 0.2192640
	speed: 0.2273s/iter; left time: 972.1668s
	iters: 400, epoch: 7 | loss: 0.2680865
	speed: 0.2539s/iter; left time: 1060.4804s
	iters: 500, epoch: 7 | loss: 0.2340855
	speed: 0.2633s/iter; left time: 1073.6430s
	iters: 600, epoch: 7 | loss: 0.1951631
	speed: 0.2271s/iter; left time: 903.0033s
	iters: 700, epoch: 7 | loss: 0.1838633
	speed: 0.2257s/iter; left time: 874.9670s
	iters: 800, epoch: 7 | loss: 0.1818132
	speed: 0.2223s/iter; left time: 839.6998s
	iters: 900, epoch: 7 | loss: 0.2014917
	speed: 0.2214s/iter; left time: 814.2654s
	iters: 1000, epoch: 7 | loss: 0.2155917
	speed: 0.2277s/iter; left time: 814.5118s
	iters: 1100, epoch: 7 | loss: 0.2009451
	speed: 0.2270s/iter; left time: 789.4298s
Epoch: 7 cost time: 264.0143322944641
Epoch: 7, Steps: 1144 | Train Loss: 0.2170865 Vali Loss: 0.2069830 Test Loss: 0.2258417
Validation loss decreased (0.207147 --> 0.206983).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2528439
	speed: 3.8118s/iter; left time: 12704.8889s
	iters: 200, epoch: 8 | loss: 0.2229115
	speed: 0.2397s/iter; left time: 775.0694s
	iters: 300, epoch: 8 | loss: 0.2149486
	speed: 0.2232s/iter; left time: 699.1315s
	iters: 400, epoch: 8 | loss: 0.1969383
	speed: 0.2347s/iter; left time: 711.8346s
	iters: 500, epoch: 8 | loss: 0.2404548
	speed: 0.2464s/iter; left time: 722.5892s
	iters: 600, epoch: 8 | loss: 0.2063412
	speed: 0.2624s/iter; left time: 743.4182s
	iters: 700, epoch: 8 | loss: 0.2280190
	speed: 0.2217s/iter; left time: 605.8388s
	iters: 800, epoch: 8 | loss: 0.2405887
	speed: 0.2219s/iter; left time: 584.1759s
	iters: 900, epoch: 8 | loss: 0.1989075
	speed: 0.2260s/iter; left time: 572.4251s
	iters: 1000, epoch: 8 | loss: 0.1975904
	speed: 0.2378s/iter; left time: 578.4877s
	iters: 1100, epoch: 8 | loss: 0.1905363
	speed: 0.2146s/iter; left time: 500.5967s
Epoch: 8 cost time: 265.19999718666077
Epoch: 8, Steps: 1144 | Train Loss: 0.2168016 Vali Loss: 0.2062431 Test Loss: 0.2257797
Validation loss decreased (0.206983 --> 0.206243).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2476877
	speed: 4.0203s/iter; left time: 8800.5258s
	iters: 200, epoch: 9 | loss: 0.2238271
	speed: 0.2626s/iter; left time: 548.5542s
	iters: 300, epoch: 9 | loss: 0.2171387
	speed: 0.2384s/iter; left time: 474.2411s
	iters: 400, epoch: 9 | loss: 0.1850569
	speed: 0.2520s/iter; left time: 476.0504s
	iters: 500, epoch: 9 | loss: 0.2418249
	speed: 0.2556s/iter; left time: 457.2783s
	iters: 600, epoch: 9 | loss: 0.2079509
	speed: 0.2334s/iter; left time: 394.2045s
	iters: 700, epoch: 9 | loss: 0.1821647
	speed: 0.2332s/iter; left time: 370.5776s
	iters: 800, epoch: 9 | loss: 0.2146190
	speed: 0.2211s/iter; left time: 329.1809s
	iters: 900, epoch: 9 | loss: 0.2135662
	speed: 0.2315s/iter; left time: 321.5153s
	iters: 1000, epoch: 9 | loss: 0.1950064
	speed: 0.2785s/iter; left time: 359.0060s
	iters: 1100, epoch: 9 | loss: 0.2496932
	speed: 0.2535s/iter; left time: 301.3948s
Epoch: 9 cost time: 301.6713070869446
Epoch: 9, Steps: 1144 | Train Loss: 0.2167658 Vali Loss: 0.2064022 Test Loss: 0.2253810
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2003034
	speed: 3.8341s/iter; left time: 4006.6211s
	iters: 200, epoch: 10 | loss: 0.1884774
	speed: 0.2219s/iter; left time: 209.6953s
	iters: 300, epoch: 10 | loss: 0.2326859
	speed: 0.2355s/iter; left time: 198.9846s
	iters: 400, epoch: 10 | loss: 0.2180395
	speed: 0.2651s/iter; left time: 197.4713s
	iters: 500, epoch: 10 | loss: 0.1912838
	speed: 0.2414s/iter; left time: 155.6784s
	iters: 600, epoch: 10 | loss: 0.2050424
	speed: 0.2204s/iter; left time: 120.1209s
	iters: 700, epoch: 10 | loss: 0.2446416
	speed: 0.2325s/iter; left time: 103.4619s
	iters: 800, epoch: 10 | loss: 0.1936801
	speed: 0.2482s/iter; left time: 85.6169s
	iters: 900, epoch: 10 | loss: 0.2439642
	speed: 0.2605s/iter; left time: 63.8179s
	iters: 1000, epoch: 10 | loss: 0.1910046
	speed: 0.2452s/iter; left time: 35.5580s
	iters: 1100, epoch: 10 | loss: 0.2064338
	speed: 0.2325s/iter; left time: 10.4607s
Epoch: 10 cost time: 272.52147364616394
Epoch: 10, Steps: 1144 | Train Loss: 0.2167209 Vali Loss: 0.2069618 Test Loss: 0.2254419
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : imputation_ECL_mask_0.375_FEDformer_custom_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5261
test shape: (5261, 96, 321) (5261, 96, 321)
mse:0.22551393508911133, mae:0.3547070026397705
