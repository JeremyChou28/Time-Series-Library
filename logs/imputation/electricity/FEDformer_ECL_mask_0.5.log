Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ECL_mask_0.5        Model:              FEDformer           

[1mData Loader[0m
  Data:               custom              Root Path:          ../iTransformer_datasets/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.5                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 35, 37, 38, 39, 40, 42, 43, 44, 46]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
 fourier enhanced cross attention used!
modes_q=24, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 26, 27, 28, 29, 30, 31, 32, 35, 36, 37, 43, 44, 45]
>>>>>>>start training : imputation_ECL_mask_0.5_FEDformer_custom_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18317
val 2633
test 5261
	iters: 100, epoch: 1 | loss: 0.4088733
	speed: 0.3988s/iter; left time: 4522.3988s
	iters: 200, epoch: 1 | loss: 0.3379425
	speed: 0.3265s/iter; left time: 3670.7290s
	iters: 300, epoch: 1 | loss: 0.3812990
	speed: 0.4242s/iter; left time: 4725.6737s
	iters: 400, epoch: 1 | loss: 0.3394657
	speed: 0.4849s/iter; left time: 5353.5584s
	iters: 500, epoch: 1 | loss: 0.3091926
	speed: 0.5061s/iter; left time: 5537.4562s
	iters: 600, epoch: 1 | loss: 0.3316814
	speed: 0.6162s/iter; left time: 6679.8007s
	iters: 700, epoch: 1 | loss: 0.3168987
	speed: 0.4174s/iter; left time: 4483.7951s
	iters: 800, epoch: 1 | loss: 0.2553360
	speed: 0.2713s/iter; left time: 2886.3778s
	iters: 900, epoch: 1 | loss: 0.2736262
	speed: 0.3745s/iter; left time: 3947.5191s
	iters: 1000, epoch: 1 | loss: 0.2740880
	speed: 0.3249s/iter; left time: 3392.6075s
	iters: 1100, epoch: 1 | loss: 0.3148866
	speed: 0.4935s/iter; left time: 5102.9336s
Epoch: 1 cost time: 489.3964352607727
Epoch: 1, Steps: 1144 | Train Loss: 0.3329405 Vali Loss: 0.2633865 Test Loss: 0.2920552
Validation loss decreased (inf --> 0.263386).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2428416
	speed: 8.0683s/iter; left time: 82272.6561s
	iters: 200, epoch: 2 | loss: 0.2494689
	speed: 0.4012s/iter; left time: 4050.4203s
	iters: 300, epoch: 2 | loss: 0.2552286
	speed: 0.2856s/iter; left time: 2855.1970s
	iters: 400, epoch: 2 | loss: 0.2786130
	speed: 0.2624s/iter; left time: 2596.8843s
	iters: 500, epoch: 2 | loss: 0.2589154
	speed: 0.3073s/iter; left time: 3010.3459s
	iters: 600, epoch: 2 | loss: 0.2550529
	speed: 0.4556s/iter; left time: 4417.5440s
	iters: 700, epoch: 2 | loss: 0.2550263
	speed: 0.4308s/iter; left time: 4134.1664s
	iters: 800, epoch: 2 | loss: 0.2495534
	speed: 0.3775s/iter; left time: 3585.1436s
	iters: 900, epoch: 2 | loss: 0.2790474
	speed: 0.4047s/iter; left time: 3803.4228s
	iters: 1000, epoch: 2 | loss: 0.2695288
	speed: 0.2637s/iter; left time: 2451.5434s
	iters: 1100, epoch: 2 | loss: 0.2076368
	speed: 0.3186s/iter; left time: 2929.8813s
Epoch: 2 cost time: 419.2728621959686
Epoch: 2, Steps: 1144 | Train Loss: 0.2537508 Vali Loss: 0.2366365 Test Loss: 0.2612864
Validation loss decreased (0.263386 --> 0.236636).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2538440
	speed: 5.9770s/iter; left time: 54109.9411s
	iters: 200, epoch: 3 | loss: 0.2310521
	speed: 0.2774s/iter; left time: 2483.7592s
	iters: 300, epoch: 3 | loss: 0.2615495
	speed: 0.2869s/iter; left time: 2539.6418s
	iters: 400, epoch: 3 | loss: 0.2561011
	speed: 0.2381s/iter; left time: 2084.3490s
	iters: 500, epoch: 3 | loss: 0.2098786
	speed: 0.2326s/iter; left time: 2012.5087s
	iters: 600, epoch: 3 | loss: 0.2739308
	speed: 0.2524s/iter; left time: 2158.9267s
	iters: 700, epoch: 3 | loss: 0.2459510
	speed: 0.2686s/iter; left time: 2270.7781s
	iters: 800, epoch: 3 | loss: 0.2123030
	speed: 0.2852s/iter; left time: 2382.3338s
	iters: 900, epoch: 3 | loss: 0.2271553
	speed: 0.2299s/iter; left time: 1897.3872s
	iters: 1000, epoch: 3 | loss: 0.2672733
	speed: 0.2510s/iter; left time: 2046.5232s
	iters: 1100, epoch: 3 | loss: 0.2329254
	speed: 0.2662s/iter; left time: 2143.3486s
Epoch: 3 cost time: 298.90648555755615
Epoch: 3, Steps: 1144 | Train Loss: 0.2413893 Vali Loss: 0.2312372 Test Loss: 0.2540802
Validation loss decreased (0.236636 --> 0.231237).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2380239
	speed: 4.1694s/iter; left time: 32975.8577s
	iters: 200, epoch: 4 | loss: 0.2417599
	speed: 0.2615s/iter; left time: 2042.2531s
	iters: 300, epoch: 4 | loss: 0.2226098
	speed: 0.2755s/iter; left time: 2123.9339s
	iters: 400, epoch: 4 | loss: 0.2175000
	speed: 0.2678s/iter; left time: 2037.8583s
	iters: 500, epoch: 4 | loss: 0.2158667
	speed: 0.2550s/iter; left time: 1914.5170s
	iters: 600, epoch: 4 | loss: 0.2345990
	speed: 0.2536s/iter; left time: 1879.0579s
	iters: 700, epoch: 4 | loss: 0.2228900
	speed: 0.2526s/iter; left time: 1846.2219s
	iters: 800, epoch: 4 | loss: 0.2555576
	speed: 0.2892s/iter; left time: 2085.0670s
	iters: 900, epoch: 4 | loss: 0.1974581
	speed: 0.3883s/iter; left time: 2760.5241s
	iters: 1000, epoch: 4 | loss: 0.2229253
	speed: 0.2403s/iter; left time: 1684.2013s
	iters: 1100, epoch: 4 | loss: 0.2063031
	speed: 0.2607s/iter; left time: 1801.2162s
Epoch: 4 cost time: 311.74327421188354
Epoch: 4, Steps: 1144 | Train Loss: 0.2375161 Vali Loss: 0.2264488 Test Loss: 0.2518180
Validation loss decreased (0.231237 --> 0.226449).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2267669
	speed: 4.1312s/iter; left time: 27947.6813s
	iters: 200, epoch: 5 | loss: 0.2489316
	speed: 0.2402s/iter; left time: 1601.0002s
	iters: 300, epoch: 5 | loss: 0.2440930
	speed: 0.2541s/iter; left time: 1668.2622s
	iters: 400, epoch: 5 | loss: 0.2411280
	speed: 0.2552s/iter; left time: 1649.7966s
	iters: 500, epoch: 5 | loss: 0.2565441
	speed: 0.2457s/iter; left time: 1564.1120s
	iters: 600, epoch: 5 | loss: 0.2333399
	speed: 0.2513s/iter; left time: 1574.5730s
	iters: 700, epoch: 5 | loss: 0.2067052
	speed: 0.2451s/iter; left time: 1511.3311s
	iters: 800, epoch: 5 | loss: 0.2436467
	speed: 0.2498s/iter; left time: 1515.0179s
	iters: 900, epoch: 5 | loss: 0.2315849
	speed: 0.3669s/iter; left time: 2188.4071s
	iters: 1000, epoch: 5 | loss: 0.2543677
	speed: 0.2586s/iter; left time: 1516.5449s
	iters: 1100, epoch: 5 | loss: 0.2264151
	speed: 0.2620s/iter; left time: 1510.6683s
Epoch: 5 cost time: 297.36735558509827
Epoch: 5, Steps: 1144 | Train Loss: 0.2357309 Vali Loss: 0.2248367 Test Loss: 0.2480806
Validation loss decreased (0.226449 --> 0.224837).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2239604
	speed: 3.9293s/iter; left time: 22086.3456s
	iters: 200, epoch: 6 | loss: 0.2229140
	speed: 0.2625s/iter; left time: 1449.0867s
	iters: 300, epoch: 6 | loss: 0.2264589
	speed: 0.2480s/iter; left time: 1344.4800s
	iters: 400, epoch: 6 | loss: 0.2527019
	speed: 0.2406s/iter; left time: 1280.4520s
	iters: 500, epoch: 6 | loss: 0.2603222
	speed: 0.2311s/iter; left time: 1206.7946s
	iters: 600, epoch: 6 | loss: 0.1960736
	speed: 0.2393s/iter; left time: 1225.2071s
	iters: 700, epoch: 6 | loss: 0.2280847
	speed: 0.2345s/iter; left time: 1177.3523s
	iters: 800, epoch: 6 | loss: 0.2500350
	speed: 0.2220s/iter; left time: 1092.2528s
	iters: 900, epoch: 6 | loss: 0.2165319
	speed: 0.2227s/iter; left time: 1073.8330s
	iters: 1000, epoch: 6 | loss: 0.2236032
	speed: 0.2394s/iter; left time: 1130.1491s
	iters: 1100, epoch: 6 | loss: 0.2278959
	speed: 0.2542s/iter; left time: 1174.7641s
Epoch: 6 cost time: 273.1367025375366
Epoch: 6, Steps: 1144 | Train Loss: 0.2348409 Vali Loss: 0.2246297 Test Loss: 0.2480252
Validation loss decreased (0.224837 --> 0.224630).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2143364
	speed: 3.8630s/iter; left time: 17294.6949s
	iters: 200, epoch: 7 | loss: 0.2623597
	speed: 0.2406s/iter; left time: 1053.1868s
	iters: 300, epoch: 7 | loss: 0.2352528
	speed: 0.2682s/iter; left time: 1147.0474s
	iters: 400, epoch: 7 | loss: 0.2874775
	speed: 0.2365s/iter; left time: 988.0087s
	iters: 500, epoch: 7 | loss: 0.2528673
	speed: 0.2273s/iter; left time: 926.7682s
	iters: 600, epoch: 7 | loss: 0.2133539
	speed: 0.2267s/iter; left time: 901.7745s
	iters: 700, epoch: 7 | loss: 0.1983439
	speed: 0.2236s/iter; left time: 866.9155s
	iters: 800, epoch: 7 | loss: 0.1975347
	speed: 0.2246s/iter; left time: 848.4661s
	iters: 900, epoch: 7 | loss: 0.2167138
	speed: 0.2337s/iter; left time: 859.4709s
	iters: 1000, epoch: 7 | loss: 0.2336897
	speed: 0.2247s/iter; left time: 803.7000s
	iters: 1100, epoch: 7 | loss: 0.2177043
	speed: 0.2316s/iter; left time: 805.3116s
Epoch: 7 cost time: 266.2620918750763
Epoch: 7, Steps: 1144 | Train Loss: 0.2343730 Vali Loss: 0.2240876 Test Loss: 0.2469768
Validation loss decreased (0.224630 --> 0.224088).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2741543
	speed: 3.8835s/iter; left time: 12943.8009s
	iters: 200, epoch: 8 | loss: 0.2425200
	speed: 0.2291s/iter; left time: 740.8350s
	iters: 300, epoch: 8 | loss: 0.2299914
	speed: 0.2438s/iter; left time: 763.7773s
	iters: 400, epoch: 8 | loss: 0.2146835
	speed: 0.2557s/iter; left time: 775.5754s
	iters: 500, epoch: 8 | loss: 0.2557276
	speed: 0.2317s/iter; left time: 679.4675s
	iters: 600, epoch: 8 | loss: 0.2208107
	speed: 0.2210s/iter; left time: 626.0671s
	iters: 700, epoch: 8 | loss: 0.2437544
	speed: 0.2233s/iter; left time: 610.3967s
	iters: 800, epoch: 8 | loss: 0.2595577
	speed: 0.2419s/iter; left time: 636.8836s
	iters: 900, epoch: 8 | loss: 0.2136987
	speed: 0.2197s/iter; left time: 556.5837s
	iters: 1000, epoch: 8 | loss: 0.2143772
	speed: 0.2197s/iter; left time: 534.4754s
	iters: 1100, epoch: 8 | loss: 0.2045810
	speed: 0.2182s/iter; left time: 509.1426s
Epoch: 8 cost time: 263.4280135631561
Epoch: 8, Steps: 1144 | Train Loss: 0.2341126 Vali Loss: 0.2236463 Test Loss: 0.2469789
Validation loss decreased (0.224088 --> 0.223646).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2656593
	speed: 4.1128s/iter; left time: 9002.9371s
	iters: 200, epoch: 9 | loss: 0.2428904
	speed: 0.2510s/iter; left time: 524.2776s
	iters: 300, epoch: 9 | loss: 0.2313853
	speed: 0.2597s/iter; left time: 516.5054s
	iters: 400, epoch: 9 | loss: 0.2016599
	speed: 0.2352s/iter; left time: 444.2287s
	iters: 500, epoch: 9 | loss: 0.2596948
	speed: 0.2381s/iter; left time: 425.8919s
	iters: 600, epoch: 9 | loss: 0.2256176
	speed: 0.2234s/iter; left time: 377.2499s
	iters: 700, epoch: 9 | loss: 0.1960740
	speed: 0.2322s/iter; left time: 368.9132s
	iters: 800, epoch: 9 | loss: 0.2348445
	speed: 0.2733s/iter; left time: 406.9332s
	iters: 900, epoch: 9 | loss: 0.2317989
	speed: 0.2476s/iter; left time: 343.9673s
	iters: 1000, epoch: 9 | loss: 0.2093003
	speed: 0.2826s/iter; left time: 364.2343s
	iters: 1100, epoch: 9 | loss: 0.2659662
	speed: 0.2460s/iter; left time: 292.5473s
Epoch: 9 cost time: 283.72198939323425
Epoch: 9, Steps: 1144 | Train Loss: 0.2340780 Vali Loss: 0.2235163 Test Loss: 0.2467280
Validation loss decreased (0.223646 --> 0.223516).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2163519
	speed: 3.8602s/iter; left time: 4033.9136s
	iters: 200, epoch: 10 | loss: 0.2055001
	speed: 0.2424s/iter; left time: 229.0894s
	iters: 300, epoch: 10 | loss: 0.2521878
	speed: 0.2362s/iter; left time: 199.5957s
	iters: 400, epoch: 10 | loss: 0.2326369
	speed: 0.2235s/iter; left time: 166.4985s
	iters: 500, epoch: 10 | loss: 0.2034552
	speed: 0.2324s/iter; left time: 149.9260s
	iters: 600, epoch: 10 | loss: 0.2226490
	speed: 0.2453s/iter; left time: 133.6990s
	iters: 700, epoch: 10 | loss: 0.2635776
	speed: 0.2607s/iter; left time: 116.0039s
	iters: 800, epoch: 10 | loss: 0.2083441
	speed: 0.2557s/iter; left time: 88.2094s
	iters: 900, epoch: 10 | loss: 0.2614621
	speed: 0.2234s/iter; left time: 54.7347s
	iters: 1000, epoch: 10 | loss: 0.2052117
	speed: 0.2509s/iter; left time: 36.3733s
	iters: 1100, epoch: 10 | loss: 0.2225077
	speed: 0.2428s/iter; left time: 10.9272s
Epoch: 10 cost time: 279.07965326309204
Epoch: 10, Steps: 1144 | Train Loss: 0.2340240 Vali Loss: 0.2239725 Test Loss: 0.2467969
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : imputation_ECL_mask_0.5_FEDformer_custom_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5261
test shape: (5261, 96, 321) (5261, 96, 321)
mse:0.2466576099395752, mae:0.370290070772171
