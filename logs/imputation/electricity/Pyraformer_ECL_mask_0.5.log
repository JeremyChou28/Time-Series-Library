Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ECL_mask_0.5        Model:              Pyraformer          

[1mData Loader[0m
  Data:               custom              Root Path:          ../iTransformer_datasets/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.5                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_ECL_mask_0.5_Pyraformer_custom_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18317
val 2633
test 5261
	iters: 100, epoch: 1 | loss: 0.2328860
	speed: 0.3294s/iter; left time: 3735.1941s
	iters: 200, epoch: 1 | loss: 0.1693234
	speed: 0.2618s/iter; left time: 2942.9520s
	iters: 300, epoch: 1 | loss: 0.1646415
	speed: 0.2620s/iter; left time: 2918.4869s
	iters: 400, epoch: 1 | loss: 0.1456368
	speed: 0.2628s/iter; left time: 2901.5924s
	iters: 500, epoch: 1 | loss: 0.1336382
	speed: 0.2677s/iter; left time: 2929.1883s
	iters: 600, epoch: 1 | loss: 0.1326393
	speed: 0.2666s/iter; left time: 2890.3467s
	iters: 700, epoch: 1 | loss: 0.1277120
	speed: 0.2647s/iter; left time: 2843.6290s
	iters: 800, epoch: 1 | loss: 0.1350569
	speed: 0.2640s/iter; left time: 2809.6444s
	iters: 900, epoch: 1 | loss: 0.1259059
	speed: 0.3264s/iter; left time: 3440.5284s
	iters: 1000, epoch: 1 | loss: 0.1192482
	speed: 0.2672s/iter; left time: 2790.0278s
	iters: 1100, epoch: 1 | loss: 0.1068102
	speed: 0.2564s/iter; left time: 2651.2273s
Epoch: 1 cost time: 314.4069404602051
Epoch: 1, Steps: 1144 | Train Loss: 0.1573173 Vali Loss: 0.1590632 Test Loss: 0.2204481
Validation loss decreased (inf --> 0.159063).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1060406
	speed: 18.2585s/iter; left time: 186181.8897s
	iters: 200, epoch: 2 | loss: 0.1066411
	speed: 0.3962s/iter; left time: 4000.3669s
	iters: 300, epoch: 2 | loss: 0.1092210
	speed: 0.3629s/iter; left time: 3627.9624s
	iters: 400, epoch: 2 | loss: 0.0911724
	speed: 0.3637s/iter; left time: 3599.4859s
	iters: 500, epoch: 2 | loss: 0.0994160
	speed: 0.3660s/iter; left time: 3585.4291s
	iters: 600, epoch: 2 | loss: 0.1002539
	speed: 0.3634s/iter; left time: 3523.5153s
	iters: 700, epoch: 2 | loss: 0.1050243
	speed: 0.3718s/iter; left time: 3568.6243s
	iters: 800, epoch: 2 | loss: 0.0945180
	speed: 0.3749s/iter; left time: 3560.0964s
	iters: 900, epoch: 2 | loss: 0.0989737
	speed: 0.3718s/iter; left time: 3493.7598s
	iters: 1000, epoch: 2 | loss: 0.0929585
	speed: 0.3768s/iter; left time: 3503.3125s
	iters: 1100, epoch: 2 | loss: 0.1006519
	speed: 0.3876s/iter; left time: 3564.4517s
Epoch: 2 cost time: 433.59547185897827
Epoch: 2, Steps: 1144 | Train Loss: 0.1031665 Vali Loss: 0.1507377 Test Loss: 0.2103823
Validation loss decreased (0.159063 --> 0.150738).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1021873
	speed: 21.7886s/iter; left time: 197252.0602s
	iters: 200, epoch: 3 | loss: 0.0915272
	speed: 0.3580s/iter; left time: 3204.7812s
	iters: 300, epoch: 3 | loss: 0.0913799
	speed: 0.3616s/iter; left time: 3200.8272s
	iters: 400, epoch: 3 | loss: 0.0897487
	speed: 0.3650s/iter; left time: 3194.9450s
	iters: 500, epoch: 3 | loss: 0.0923539
	speed: 0.3674s/iter; left time: 3179.4000s
	iters: 600, epoch: 3 | loss: 0.0892740
	speed: 0.3644s/iter; left time: 3117.0779s
	iters: 700, epoch: 3 | loss: 0.0975403
	speed: 0.3678s/iter; left time: 3108.9763s
	iters: 800, epoch: 3 | loss: 0.0969241
	speed: 0.3661s/iter; left time: 3057.9052s
	iters: 900, epoch: 3 | loss: 0.0824994
	speed: 0.3631s/iter; left time: 2996.6242s
	iters: 1000, epoch: 3 | loss: 0.0843716
	speed: 0.3674s/iter; left time: 2995.0894s
	iters: 1100, epoch: 3 | loss: 0.0890643
	speed: 0.3655s/iter; left time: 2943.4958s
Epoch: 3 cost time: 416.1920509338379
Epoch: 3, Steps: 1144 | Train Loss: 0.0914495 Vali Loss: 0.1454287 Test Loss: 0.2067836
Validation loss decreased (0.150738 --> 0.145429).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0860603
	speed: 22.0298s/iter; left time: 174233.6831s
	iters: 200, epoch: 4 | loss: 0.0838258
	speed: 0.4384s/iter; left time: 3423.8347s
	iters: 300, epoch: 4 | loss: 0.0848805
	speed: 0.3653s/iter; left time: 2815.8093s
	iters: 400, epoch: 4 | loss: 0.0906826
	speed: 0.3646s/iter; left time: 2774.5676s
	iters: 500, epoch: 4 | loss: 0.0943787
	speed: 0.3699s/iter; left time: 2777.8777s
	iters: 600, epoch: 4 | loss: 0.0850796
	speed: 0.3697s/iter; left time: 2739.0872s
	iters: 700, epoch: 4 | loss: 0.0859990
	speed: 0.3671s/iter; left time: 2683.0025s
	iters: 800, epoch: 4 | loss: 0.0885247
	speed: 0.3687s/iter; left time: 2657.6486s
	iters: 900, epoch: 4 | loss: 0.0910753
	speed: 0.3680s/iter; left time: 2615.8775s
	iters: 1000, epoch: 4 | loss: 0.0816625
	speed: 0.3721s/iter; left time: 2608.3663s
	iters: 1100, epoch: 4 | loss: 0.0847529
	speed: 0.3721s/iter; left time: 2571.0249s
Epoch: 4 cost time: 434.3451020717621
Epoch: 4, Steps: 1144 | Train Loss: 0.0871162 Vali Loss: 0.1432289 Test Loss: 0.2054919
Validation loss decreased (0.145429 --> 0.143229).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0888055
	speed: 22.5039s/iter; left time: 152238.8451s
	iters: 200, epoch: 5 | loss: 0.0896422
	speed: 0.3726s/iter; left time: 2483.0824s
	iters: 300, epoch: 5 | loss: 0.0863953
	speed: 0.3732s/iter; left time: 2449.7660s
	iters: 400, epoch: 5 | loss: 0.0902959
	speed: 0.3678s/iter; left time: 2377.9783s
	iters: 500, epoch: 5 | loss: 0.0875699
	speed: 0.3661s/iter; left time: 2329.9828s
	iters: 600, epoch: 5 | loss: 0.0802218
	speed: 0.3812s/iter; left time: 2388.2489s
	iters: 700, epoch: 5 | loss: 0.0815336
	speed: 0.3687s/iter; left time: 2272.8446s
	iters: 800, epoch: 5 | loss: 0.0895508
	speed: 0.3740s/iter; left time: 2268.0121s
	iters: 900, epoch: 5 | loss: 0.0877613
	speed: 0.3776s/iter; left time: 2252.6162s
	iters: 1000, epoch: 5 | loss: 0.0876327
	speed: 0.3799s/iter; left time: 2228.1484s
	iters: 1100, epoch: 5 | loss: 0.0837030
	speed: 0.3808s/iter; left time: 2195.3030s
Epoch: 5 cost time: 427.43908500671387
Epoch: 5, Steps: 1144 | Train Loss: 0.0849529 Vali Loss: 0.1439815 Test Loss: 0.2050401
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0827945
	speed: 19.1480s/iter; left time: 107631.0058s
	iters: 200, epoch: 6 | loss: 0.0815547
	speed: 0.3032s/iter; left time: 1673.8933s
	iters: 300, epoch: 6 | loss: 0.0808365
	speed: 0.3253s/iter; left time: 1763.3170s
	iters: 400, epoch: 6 | loss: 0.0806540
	speed: 0.3281s/iter; left time: 1745.7290s
	iters: 500, epoch: 6 | loss: 0.0809892
	speed: 0.3291s/iter; left time: 1718.1938s
	iters: 600, epoch: 6 | loss: 0.0865531
	speed: 0.3360s/iter; left time: 1720.8838s
	iters: 700, epoch: 6 | loss: 0.0801378
	speed: 0.3249s/iter; left time: 1631.2832s
	iters: 800, epoch: 6 | loss: 0.0801216
	speed: 0.2934s/iter; left time: 1443.6182s
	iters: 900, epoch: 6 | loss: 0.0847745
	speed: 0.2976s/iter; left time: 1434.5841s
	iters: 1000, epoch: 6 | loss: 0.0951297
	speed: 0.3203s/iter; left time: 1512.0340s
	iters: 1100, epoch: 6 | loss: 0.0815460
	speed: 0.3143s/iter; left time: 1452.2153s
Epoch: 6 cost time: 360.74150586128235
Epoch: 6, Steps: 1144 | Train Loss: 0.0838467 Vali Loss: 0.1429055 Test Loss: 0.2047491
Validation loss decreased (0.143229 --> 0.142905).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0874862
	speed: 17.9668s/iter; left time: 80437.4264s
	iters: 200, epoch: 7 | loss: 0.0803611
	speed: 0.2784s/iter; left time: 1218.7165s
	iters: 300, epoch: 7 | loss: 0.0802491
	speed: 0.2823s/iter; left time: 1207.4755s
	iters: 400, epoch: 7 | loss: 0.0870212
	speed: 0.3115s/iter; left time: 1301.0147s
	iters: 500, epoch: 7 | loss: 0.0908099
	speed: 0.3091s/iter; left time: 1260.0571s
	iters: 600, epoch: 7 | loss: 0.0785862
	speed: 0.3099s/iter; left time: 1232.5432s
	iters: 700, epoch: 7 | loss: 0.0843757
	speed: 0.3165s/iter; left time: 1227.2433s
	iters: 800, epoch: 7 | loss: 0.0854388
	speed: 0.3150s/iter; left time: 1189.9322s
	iters: 900, epoch: 7 | loss: 0.0784560
	speed: 0.2874s/iter; left time: 1056.7100s
	iters: 1000, epoch: 7 | loss: 0.0834171
	speed: 0.2877s/iter; left time: 1028.9973s
	iters: 1100, epoch: 7 | loss: 0.0901260
	speed: 0.2851s/iter; left time: 991.2233s
Epoch: 7 cost time: 341.3679769039154
Epoch: 7, Steps: 1144 | Train Loss: 0.0832941 Vali Loss: 0.1415220 Test Loss: 0.2035716
Validation loss decreased (0.142905 --> 0.141522).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0885019
	speed: 15.6271s/iter; left time: 52085.0609s
	iters: 200, epoch: 8 | loss: 0.0836111
	speed: 0.2197s/iter; left time: 710.3556s
	iters: 300, epoch: 8 | loss: 0.0909168
	speed: 0.2051s/iter; left time: 642.4488s
	iters: 400, epoch: 8 | loss: 0.0787176
	speed: 0.1804s/iter; left time: 547.1097s
	iters: 500, epoch: 8 | loss: 0.0861140
	speed: 0.1548s/iter; left time: 454.1703s
	iters: 600, epoch: 8 | loss: 0.0773793
	speed: 0.1441s/iter; left time: 408.1133s
	iters: 700, epoch: 8 | loss: 0.0803681
	speed: 0.1479s/iter; left time: 404.3249s
	iters: 800, epoch: 8 | loss: 0.0808480
	speed: 0.1458s/iter; left time: 383.8360s
	iters: 900, epoch: 8 | loss: 0.0825588
	speed: 0.1440s/iter; left time: 364.8091s
	iters: 1000, epoch: 8 | loss: 0.0818505
	speed: 0.1445s/iter; left time: 351.4948s
	iters: 1100, epoch: 8 | loss: 0.0834081
	speed: 0.1434s/iter; left time: 334.6174s
Epoch: 8 cost time: 193.1918749809265
Epoch: 8, Steps: 1144 | Train Loss: 0.0829476 Vali Loss: 0.1414268 Test Loss: 0.2032967
Validation loss decreased (0.141522 --> 0.141427).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0747470
	speed: 8.4321s/iter; left time: 18457.8562s
	iters: 200, epoch: 9 | loss: 0.0833071
	speed: 0.1321s/iter; left time: 275.8617s
	iters: 300, epoch: 9 | loss: 0.0810202
	speed: 0.1349s/iter; left time: 268.2210s
	iters: 400, epoch: 9 | loss: 0.0778054
	speed: 0.1378s/iter; left time: 260.2157s
	iters: 500, epoch: 9 | loss: 0.0785258
	speed: 0.1388s/iter; left time: 248.3965s
	iters: 600, epoch: 9 | loss: 0.0859241
	speed: 0.1363s/iter; left time: 230.1724s
	iters: 700, epoch: 9 | loss: 0.0771058
	speed: 0.1335s/iter; left time: 212.2039s
	iters: 800, epoch: 9 | loss: 0.0885705
	speed: 0.1355s/iter; left time: 201.8094s
	iters: 900, epoch: 9 | loss: 0.0823599
	speed: 0.1370s/iter; left time: 190.3132s
	iters: 1000, epoch: 9 | loss: 0.0794218
	speed: 0.1361s/iter; left time: 175.3973s
	iters: 1100, epoch: 9 | loss: 0.0890242
	speed: 0.1388s/iter; left time: 165.0604s
Epoch: 9 cost time: 156.3592448234558
Epoch: 9, Steps: 1144 | Train Loss: 0.0828130 Vali Loss: 0.1428228 Test Loss: 0.2038168
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.0838332
	speed: 7.9874s/iter; left time: 8346.8033s
	iters: 200, epoch: 10 | loss: 0.0880252
	speed: 0.1298s/iter; left time: 122.6163s
	iters: 300, epoch: 10 | loss: 0.0888723
	speed: 0.1323s/iter; left time: 111.7894s
	iters: 400, epoch: 10 | loss: 0.0810794
	speed: 0.1317s/iter; left time: 98.1393s
	iters: 500, epoch: 10 | loss: 0.0817706
	speed: 0.1300s/iter; left time: 83.8482s
	iters: 600, epoch: 10 | loss: 0.0888338
	speed: 0.1334s/iter; left time: 72.6957s
	iters: 700, epoch: 10 | loss: 0.0800406
	speed: 0.1329s/iter; left time: 59.1302s
	iters: 800, epoch: 10 | loss: 0.0851490
	speed: 0.1325s/iter; left time: 45.7203s
	iters: 900, epoch: 10 | loss: 0.0897518
	speed: 0.1325s/iter; left time: 32.4685s
	iters: 1000, epoch: 10 | loss: 0.0870731
	speed: 0.1330s/iter; left time: 19.2838s
	iters: 1100, epoch: 10 | loss: 0.0850021
	speed: 0.1354s/iter; left time: 6.0912s
Epoch: 10 cost time: 151.47936034202576
Epoch: 10, Steps: 1144 | Train Loss: 0.0827227 Vali Loss: 0.1415204 Test Loss: 0.2035900
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : imputation_ECL_mask_0.5_Pyraformer_custom_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5261
test shape: (5261, 96, 321) (5261, 96, 321)
mse:0.20331664383411407, mae:0.30960044264793396
