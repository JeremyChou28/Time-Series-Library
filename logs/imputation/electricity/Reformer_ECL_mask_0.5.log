Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ECL_mask_0.5        Model:              Reformer            

[1mData Loader[0m
  Data:               custom              Root Path:          ../iTransformer_datasets/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.5                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_ECL_mask_0.5_Reformer_custom_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18317
val 2633
test 5261
	iters: 100, epoch: 1 | loss: 0.2027256
	speed: 0.0653s/iter; left time: 740.9859s
	iters: 200, epoch: 1 | loss: 0.1767518
	speed: 0.0398s/iter; left time: 447.1682s
	iters: 300, epoch: 1 | loss: 0.1519925
	speed: 0.0394s/iter; left time: 438.5440s
	iters: 400, epoch: 1 | loss: 0.1497579
	speed: 0.0410s/iter; left time: 452.3058s
	iters: 500, epoch: 1 | loss: 0.1293869
	speed: 0.0421s/iter; left time: 460.9865s
	iters: 600, epoch: 1 | loss: 0.1187280
	speed: 0.0425s/iter; left time: 461.1049s
	iters: 700, epoch: 1 | loss: 0.1166193
	speed: 0.0417s/iter; left time: 448.3553s
	iters: 800, epoch: 1 | loss: 0.1224076
	speed: 0.0433s/iter; left time: 460.6469s
	iters: 900, epoch: 1 | loss: 0.1320040
	speed: 0.0413s/iter; left time: 435.0857s
	iters: 1000, epoch: 1 | loss: 0.1256398
	speed: 0.0398s/iter; left time: 415.6067s
	iters: 1100, epoch: 1 | loss: 0.1307191
	speed: 0.0419s/iter; left time: 432.8290s
Epoch: 1 cost time: 49.75009059906006
Epoch: 1, Steps: 1144 | Train Loss: 0.1501619 Vali Loss: 0.1483945 Test Loss: 0.1997108
Validation loss decreased (inf --> 0.148394).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1137379
	speed: 4.3518s/iter; left time: 44375.3270s
	iters: 200, epoch: 2 | loss: 0.1043161
	speed: 0.0606s/iter; left time: 611.6927s
	iters: 300, epoch: 2 | loss: 0.1074015
	speed: 0.0844s/iter; left time: 843.7202s
	iters: 400, epoch: 2 | loss: 0.1022940
	speed: 0.1010s/iter; left time: 999.3726s
	iters: 500, epoch: 2 | loss: 0.0926163
	speed: 0.0852s/iter; left time: 834.7434s
	iters: 600, epoch: 2 | loss: 0.0967411
	speed: 0.0577s/iter; left time: 559.0640s
	iters: 700, epoch: 2 | loss: 0.0973045
	speed: 0.0519s/iter; left time: 498.3214s
	iters: 800, epoch: 2 | loss: 0.1019731
	speed: 0.0539s/iter; left time: 511.9110s
	iters: 900, epoch: 2 | loss: 0.0923141
	speed: 0.0537s/iter; left time: 504.6355s
	iters: 1000, epoch: 2 | loss: 0.0990493
	speed: 0.0546s/iter; left time: 507.4448s
	iters: 1100, epoch: 2 | loss: 0.0877407
	speed: 0.0554s/iter; left time: 509.6305s
Epoch: 2 cost time: 73.90139746665955
Epoch: 2, Steps: 1144 | Train Loss: 0.1009531 Vali Loss: 0.1367084 Test Loss: 0.1859894
Validation loss decreased (0.148394 --> 0.136708).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0981342
	speed: 5.3498s/iter; left time: 48432.0366s
	iters: 200, epoch: 3 | loss: 0.1036411
	speed: 0.0531s/iter; left time: 475.7949s
	iters: 300, epoch: 3 | loss: 0.0901090
	speed: 0.0540s/iter; left time: 477.7801s
	iters: 400, epoch: 3 | loss: 0.0936925
	speed: 0.0559s/iter; left time: 489.3414s
	iters: 500, epoch: 3 | loss: 0.0950794
	speed: 0.0575s/iter; left time: 497.1294s
	iters: 600, epoch: 3 | loss: 0.0926744
	speed: 0.0598s/iter; left time: 511.3561s
	iters: 700, epoch: 3 | loss: 0.0988298
	speed: 0.0587s/iter; left time: 496.3633s
	iters: 800, epoch: 3 | loss: 0.0949885
	speed: 0.0745s/iter; left time: 622.2815s
	iters: 900, epoch: 3 | loss: 0.0903773
	speed: 0.0939s/iter; left time: 775.0884s
	iters: 1000, epoch: 3 | loss: 0.0962373
	speed: 0.0909s/iter; left time: 741.0774s
	iters: 1100, epoch: 3 | loss: 0.0889758
	speed: 0.0746s/iter; left time: 600.3790s
Epoch: 3 cost time: 77.5283796787262
Epoch: 3, Steps: 1144 | Train Loss: 0.0927737 Vali Loss: 0.1331728 Test Loss: 0.1808343
Validation loss decreased (0.136708 --> 0.133173).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0904142
	speed: 4.8924s/iter; left time: 38693.8157s
	iters: 200, epoch: 4 | loss: 0.0901554
	speed: 0.0588s/iter; left time: 459.3128s
	iters: 300, epoch: 4 | loss: 0.0907624
	speed: 0.0631s/iter; left time: 486.5348s
	iters: 400, epoch: 4 | loss: 0.0846188
	speed: 0.0678s/iter; left time: 515.8607s
	iters: 500, epoch: 4 | loss: 0.0973406
	speed: 0.0743s/iter; left time: 558.1621s
	iters: 600, epoch: 4 | loss: 0.0896751
	speed: 0.0736s/iter; left time: 545.1499s
	iters: 700, epoch: 4 | loss: 0.0933073
	speed: 0.0612s/iter; left time: 447.1607s
	iters: 800, epoch: 4 | loss: 0.0854742
	speed: 0.0527s/iter; left time: 379.9685s
	iters: 900, epoch: 4 | loss: 0.0901322
	speed: 0.0532s/iter; left time: 378.5495s
	iters: 1000, epoch: 4 | loss: 0.0937924
	speed: 0.0526s/iter; left time: 368.4871s
	iters: 1100, epoch: 4 | loss: 0.0890851
	speed: 0.0538s/iter; left time: 371.9918s
Epoch: 4 cost time: 69.35317015647888
Epoch: 4, Steps: 1144 | Train Loss: 0.0899826 Vali Loss: 0.1320135 Test Loss: 0.1804992
Validation loss decreased (0.133173 --> 0.132013).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0905900
	speed: 10.3018s/iter; left time: 69691.7315s
	iters: 200, epoch: 5 | loss: 0.0885846
	speed: 0.1075s/iter; left time: 716.6566s
	iters: 300, epoch: 5 | loss: 0.0918678
	speed: 0.1083s/iter; left time: 711.1828s
	iters: 400, epoch: 5 | loss: 0.0852319
	speed: 0.1097s/iter; left time: 709.3038s
	iters: 500, epoch: 5 | loss: 0.0887963
	speed: 0.1104s/iter; left time: 702.7172s
	iters: 600, epoch: 5 | loss: 0.0846913
	speed: 0.1133s/iter; left time: 709.6820s
	iters: 700, epoch: 5 | loss: 0.0958956
	speed: 0.1080s/iter; left time: 665.8718s
	iters: 800, epoch: 5 | loss: 0.0883428
	speed: 0.1184s/iter; left time: 717.9534s
	iters: 900, epoch: 5 | loss: 0.0890530
	speed: 0.1156s/iter; left time: 689.7912s
	iters: 1000, epoch: 5 | loss: 0.0863500
	speed: 0.1065s/iter; left time: 624.5458s
	iters: 1100, epoch: 5 | loss: 0.0860449
	speed: 0.1008s/iter; left time: 580.8743s
Epoch: 5 cost time: 124.61715745925903
Epoch: 5, Steps: 1144 | Train Loss: 0.0887285 Vali Loss: 0.1304004 Test Loss: 0.1788422
Validation loss decreased (0.132013 --> 0.130400).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0855101
	speed: 15.1050s/iter; left time: 84905.2280s
	iters: 200, epoch: 6 | loss: 0.0839128
	speed: 0.1445s/iter; left time: 798.0230s
	iters: 300, epoch: 6 | loss: 0.0861773
	speed: 0.1510s/iter; left time: 818.6516s
	iters: 400, epoch: 6 | loss: 0.0911276
	speed: 0.1493s/iter; left time: 794.4167s
	iters: 500, epoch: 6 | loss: 0.0829804
	speed: 0.1630s/iter; left time: 851.1421s
	iters: 600, epoch: 6 | loss: 0.0901335
	speed: 0.1473s/iter; left time: 754.5344s
	iters: 700, epoch: 6 | loss: 0.0923993
	speed: 0.1583s/iter; left time: 794.6470s
	iters: 800, epoch: 6 | loss: 0.0915839
	speed: 0.1495s/iter; left time: 735.5515s
	iters: 900, epoch: 6 | loss: 0.0795927
	speed: 0.1407s/iter; left time: 678.4016s
	iters: 1000, epoch: 6 | loss: 0.0839820
	speed: 0.1490s/iter; left time: 703.5401s
	iters: 1100, epoch: 6 | loss: 0.0900799
	speed: 0.1539s/iter; left time: 711.1834s
Epoch: 6 cost time: 171.4142460823059
Epoch: 6, Steps: 1144 | Train Loss: 0.0880657 Vali Loss: 0.1298329 Test Loss: 0.1791705
Validation loss decreased (0.130400 --> 0.129833).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0891449
	speed: 15.0825s/iter; left time: 67524.4790s
	iters: 200, epoch: 7 | loss: 0.0969069
	speed: 0.1454s/iter; left time: 636.3536s
	iters: 300, epoch: 7 | loss: 0.0851229
	speed: 0.1497s/iter; left time: 640.4774s
	iters: 400, epoch: 7 | loss: 0.0838754
	speed: 0.1402s/iter; left time: 585.5087s
	iters: 500, epoch: 7 | loss: 0.0863696
	speed: 0.1474s/iter; left time: 601.0003s
	iters: 600, epoch: 7 | loss: 0.0826140
	speed: 0.1482s/iter; left time: 589.2262s
	iters: 700, epoch: 7 | loss: 0.0920825
	speed: 0.1496s/iter; left time: 580.0382s
	iters: 800, epoch: 7 | loss: 0.0949153
	speed: 0.1447s/iter; left time: 546.6642s
	iters: 900, epoch: 7 | loss: 0.0889588
	speed: 0.1476s/iter; left time: 542.6240s
	iters: 1000, epoch: 7 | loss: 0.0885279
	speed: 0.1454s/iter; left time: 520.2635s
	iters: 1100, epoch: 7 | loss: 0.0926747
	speed: 0.1494s/iter; left time: 519.3903s
Epoch: 7 cost time: 167.380553483963
Epoch: 7, Steps: 1144 | Train Loss: 0.0877219 Vali Loss: 0.1296663 Test Loss: 0.1786277
Validation loss decreased (0.129833 --> 0.129666).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0881949
	speed: 15.1359s/iter; left time: 50447.9195s
	iters: 200, epoch: 8 | loss: 0.0932799
	speed: 0.1463s/iter; left time: 472.8716s
	iters: 300, epoch: 8 | loss: 0.0889317
	speed: 0.1502s/iter; left time: 470.6793s
	iters: 400, epoch: 8 | loss: 0.0845329
	speed: 0.1439s/iter; left time: 436.4260s
	iters: 500, epoch: 8 | loss: 0.0902589
	speed: 0.1458s/iter; left time: 427.6506s
	iters: 600, epoch: 8 | loss: 0.0825103
	speed: 0.1477s/iter; left time: 418.4035s
	iters: 700, epoch: 8 | loss: 0.0844207
	speed: 0.1422s/iter; left time: 388.6877s
	iters: 800, epoch: 8 | loss: 0.0896772
	speed: 0.1532s/iter; left time: 403.2700s
	iters: 900, epoch: 8 | loss: 0.0821694
	speed: 0.1569s/iter; left time: 397.3553s
	iters: 1000, epoch: 8 | loss: 0.0864021
	speed: 0.1517s/iter; left time: 369.0589s
	iters: 1100, epoch: 8 | loss: 0.0899396
	speed: 0.1473s/iter; left time: 343.6252s
Epoch: 8 cost time: 168.82776308059692
Epoch: 8, Steps: 1144 | Train Loss: 0.0875366 Vali Loss: 0.1295006 Test Loss: 0.1783641
Validation loss decreased (0.129666 --> 0.129501).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0900072
	speed: 15.4086s/iter; left time: 33729.3170s
	iters: 200, epoch: 9 | loss: 0.0878968
	speed: 0.1511s/iter; left time: 315.6612s
	iters: 300, epoch: 9 | loss: 0.0754817
	speed: 0.1504s/iter; left time: 299.0706s
	iters: 400, epoch: 9 | loss: 0.0901220
	speed: 0.1570s/iter; left time: 296.5259s
	iters: 500, epoch: 9 | loss: 0.0864022
	speed: 0.1529s/iter; left time: 273.6095s
	iters: 600, epoch: 9 | loss: 0.0786300
	speed: 0.1547s/iter; left time: 261.3389s
	iters: 700, epoch: 9 | loss: 0.0911432
	speed: 0.1527s/iter; left time: 242.7027s
	iters: 800, epoch: 9 | loss: 0.0912737
	speed: 0.1596s/iter; left time: 237.6094s
	iters: 900, epoch: 9 | loss: 0.0815893
	speed: 0.1530s/iter; left time: 212.5054s
	iters: 1000, epoch: 9 | loss: 0.0907729
	speed: 0.1619s/iter; left time: 208.6710s
	iters: 1100, epoch: 9 | loss: 0.0982461
	speed: 0.1621s/iter; left time: 192.7246s
Epoch: 9 cost time: 177.40222811698914
Epoch: 9, Steps: 1144 | Train Loss: 0.0874725 Vali Loss: 0.1291856 Test Loss: 0.1784913
Validation loss decreased (0.129501 --> 0.129186).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.0873645
	speed: 15.7832s/iter; left time: 16493.4113s
	iters: 200, epoch: 10 | loss: 0.0888729
	speed: 0.1639s/iter; left time: 154.8386s
	iters: 300, epoch: 10 | loss: 0.0848937
	speed: 0.1628s/iter; left time: 137.5918s
	iters: 400, epoch: 10 | loss: 0.0844345
	speed: 0.1696s/iter; left time: 126.3636s
	iters: 500, epoch: 10 | loss: 0.0806295
	speed: 0.1545s/iter; left time: 99.6583s
	iters: 600, epoch: 10 | loss: 0.0827689
	speed: 0.1550s/iter; left time: 84.4738s
	iters: 700, epoch: 10 | loss: 0.0872275
	speed: 0.1516s/iter; left time: 67.4693s
	iters: 800, epoch: 10 | loss: 0.0825566
	speed: 0.1497s/iter; left time: 51.6633s
	iters: 900, epoch: 10 | loss: 0.0810601
	speed: 0.1535s/iter; left time: 37.5985s
	iters: 1000, epoch: 10 | loss: 0.0852867
	speed: 0.1603s/iter; left time: 23.2450s
	iters: 1100, epoch: 10 | loss: 0.0851390
	speed: 0.1519s/iter; left time: 6.8356s
Epoch: 10 cost time: 181.10829639434814
Epoch: 10, Steps: 1144 | Train Loss: 0.0873673 Vali Loss: 0.1289892 Test Loss: 0.1784059
Validation loss decreased (0.129186 --> 0.128989).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : imputation_ECL_mask_0.5_Reformer_custom_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5261
test shape: (5261, 96, 321) (5261, 96, 321)
mse:0.17835427820682526, mae:0.2971511483192444
