Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ECL_mask_0.5        Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ../iTransformer_datasets/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.5                 

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_ECL_mask_0.5_TimesNet_custom_ftM_sl96_ll0_pl0_dm64_nh8_el2_dl1_df64_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18317
val 2633
test 5261
	iters: 100, epoch: 1 | loss: 0.1514106
	speed: 0.1261s/iter; left time: 1429.6311s
	iters: 200, epoch: 1 | loss: 0.1317629
	speed: 0.0821s/iter; left time: 922.9308s
	iters: 300, epoch: 1 | loss: 0.1134173
	speed: 0.0829s/iter; left time: 923.7136s
	iters: 400, epoch: 1 | loss: 0.0991335
	speed: 0.0827s/iter; left time: 913.0144s
	iters: 500, epoch: 1 | loss: 0.1004849
	speed: 0.0829s/iter; left time: 907.1345s
	iters: 600, epoch: 1 | loss: 0.1032046
	speed: 0.0834s/iter; left time: 903.9219s
	iters: 700, epoch: 1 | loss: 0.0954013
	speed: 0.0849s/iter; left time: 911.7910s
	iters: 800, epoch: 1 | loss: 0.1008197
	speed: 0.0865s/iter; left time: 920.7402s
	iters: 900, epoch: 1 | loss: 0.0822200
	speed: 0.0881s/iter; left time: 928.6307s
	iters: 1000, epoch: 1 | loss: 0.0981281
	speed: 0.0903s/iter; left time: 942.6627s
	iters: 1100, epoch: 1 | loss: 0.0910972
	speed: 0.0915s/iter; left time: 945.8314s
Epoch: 1 cost time: 101.32614374160767
Epoch: 1, Steps: 1144 | Train Loss: 0.1207073 Vali Loss: 0.1028488 Test Loss: 0.1089006
Validation loss decreased (inf --> 0.102849).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.0858370
	speed: 3.1023s/iter; left time: 31633.8291s
	iters: 200, epoch: 2 | loss: 0.0973578
	speed: 0.0859s/iter; left time: 867.4695s
	iters: 300, epoch: 2 | loss: 0.0846864
	speed: 0.0881s/iter; left time: 880.7130s
	iters: 400, epoch: 2 | loss: 0.0895819
	speed: 0.0897s/iter; left time: 887.9297s
	iters: 500, epoch: 2 | loss: 0.0911224
	speed: 0.0905s/iter; left time: 886.8172s
	iters: 600, epoch: 2 | loss: 0.0839624
	speed: 0.0915s/iter; left time: 887.1942s
	iters: 700, epoch: 2 | loss: 0.0903995
	speed: 0.0904s/iter; left time: 867.9596s
	iters: 800, epoch: 2 | loss: 0.0873452
	speed: 0.0921s/iter; left time: 874.5163s
	iters: 900, epoch: 2 | loss: 0.0912288
	speed: 0.0916s/iter; left time: 860.7572s
	iters: 1000, epoch: 2 | loss: 0.0804374
	speed: 0.0918s/iter; left time: 853.1366s
	iters: 1100, epoch: 2 | loss: 0.0902091
	speed: 0.0880s/iter; left time: 809.3810s
Epoch: 2 cost time: 101.53125262260437
Epoch: 2, Steps: 1144 | Train Loss: 0.0893913 Vali Loss: 0.0970448 Test Loss: 0.1057397
Validation loss decreased (0.102849 --> 0.097045).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0877752
	speed: 2.6058s/iter; left time: 23590.0023s
	iters: 200, epoch: 3 | loss: 0.0872866
	speed: 0.0930s/iter; left time: 832.3591s
	iters: 300, epoch: 3 | loss: 0.0843024
	speed: 0.0939s/iter; left time: 831.2224s
	iters: 400, epoch: 3 | loss: 0.0777631
	speed: 0.0932s/iter; left time: 815.6880s
	iters: 500, epoch: 3 | loss: 0.0820588
	speed: 0.0923s/iter; left time: 798.4825s
	iters: 600, epoch: 3 | loss: 0.0822283
	speed: 0.0885s/iter; left time: 757.2274s
	iters: 700, epoch: 3 | loss: 0.0840013
	speed: 0.0844s/iter; left time: 713.8481s
	iters: 800, epoch: 3 | loss: 0.0873298
	speed: 0.0842s/iter; left time: 703.0029s
	iters: 900, epoch: 3 | loss: 0.0889755
	speed: 0.0836s/iter; left time: 689.5873s
	iters: 1000, epoch: 3 | loss: 0.0853272
	speed: 0.0849s/iter; left time: 692.5776s
	iters: 1100, epoch: 3 | loss: 0.0797083
	speed: 0.0832s/iter; left time: 669.7850s
Epoch: 3 cost time: 100.7492127418518
Epoch: 3, Steps: 1144 | Train Loss: 0.0829081 Vali Loss: 0.0940340 Test Loss: 0.1035493
Validation loss decreased (0.097045 --> 0.094034).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0850318
	speed: 2.5664s/iter; left time: 20298.0093s
	iters: 200, epoch: 4 | loss: 0.0831717
	speed: 0.0845s/iter; left time: 659.7722s
	iters: 300, epoch: 4 | loss: 0.0824827
	speed: 0.0849s/iter; left time: 654.1122s
	iters: 400, epoch: 4 | loss: 0.0824435
	speed: 0.0840s/iter; left time: 639.0042s
	iters: 500, epoch: 4 | loss: 0.0854204
	speed: 0.0858s/iter; left time: 644.2553s
	iters: 600, epoch: 4 | loss: 0.0835711
	speed: 0.0858s/iter; left time: 635.5499s
	iters: 700, epoch: 4 | loss: 0.0806340
	speed: 0.0858s/iter; left time: 626.7817s
	iters: 800, epoch: 4 | loss: 0.0788489
	speed: 0.0747s/iter; left time: 538.8690s
	iters: 900, epoch: 4 | loss: 0.0778867
	speed: 0.0756s/iter; left time: 537.7436s
	iters: 1000, epoch: 4 | loss: 0.0770282
	speed: 0.0756s/iter; left time: 530.2033s
	iters: 1100, epoch: 4 | loss: 0.0797888
	speed: 0.0730s/iter; left time: 504.5714s
Epoch: 4 cost time: 91.83135437965393
Epoch: 4, Steps: 1144 | Train Loss: 0.0803154 Vali Loss: 0.0928707 Test Loss: 0.1024571
Validation loss decreased (0.094034 --> 0.092871).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0798089
	speed: 2.2653s/iter; left time: 15324.9420s
	iters: 200, epoch: 5 | loss: 0.0787759
	speed: 0.0849s/iter; left time: 565.6527s
	iters: 300, epoch: 5 | loss: 0.0882981
	speed: 0.0862s/iter; left time: 565.8941s
	iters: 400, epoch: 5 | loss: 0.0750085
	speed: 0.0846s/iter; left time: 547.2510s
	iters: 500, epoch: 5 | loss: 0.0801848
	speed: 0.0798s/iter; left time: 507.7446s
	iters: 600, epoch: 5 | loss: 0.0772959
	speed: 0.0776s/iter; left time: 485.8911s
	iters: 700, epoch: 5 | loss: 0.0769200
	speed: 0.0756s/iter; left time: 466.0295s
	iters: 800, epoch: 5 | loss: 0.0829086
	speed: 0.0753s/iter; left time: 456.9794s
	iters: 900, epoch: 5 | loss: 0.0811399
	speed: 0.0755s/iter; left time: 450.0670s
	iters: 1000, epoch: 5 | loss: 0.0810984
	speed: 0.0694s/iter; left time: 407.1972s
	iters: 1100, epoch: 5 | loss: 0.0774311
	speed: 0.0582s/iter; left time: 335.3298s
Epoch: 5 cost time: 87.62444806098938
Epoch: 5, Steps: 1144 | Train Loss: 0.0790687 Vali Loss: 0.0924112 Test Loss: 0.1018698
Validation loss decreased (0.092871 --> 0.092411).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0755520
	speed: 2.2608s/iter; left time: 12707.9613s
	iters: 200, epoch: 6 | loss: 0.0755432
	speed: 0.0845s/iter; left time: 466.7458s
	iters: 300, epoch: 6 | loss: 0.0711597
	speed: 0.0788s/iter; left time: 426.9331s
	iters: 400, epoch: 6 | loss: 0.0828139
	speed: 0.0747s/iter; left time: 397.6318s
	iters: 500, epoch: 6 | loss: 0.0799041
	speed: 0.0739s/iter; left time: 385.8234s
	iters: 600, epoch: 6 | loss: 0.0835001
	speed: 0.0746s/iter; left time: 381.7920s
	iters: 700, epoch: 6 | loss: 0.0792907
	speed: 0.0747s/iter; left time: 374.8535s
	iters: 800, epoch: 6 | loss: 0.0770500
	speed: 0.0750s/iter; left time: 369.0838s
	iters: 900, epoch: 6 | loss: 0.0742556
	speed: 0.0753s/iter; left time: 362.8790s
	iters: 1000, epoch: 6 | loss: 0.0789749
	speed: 0.0758s/iter; left time: 357.8996s
	iters: 1100, epoch: 6 | loss: 0.0752846
	speed: 0.0648s/iter; left time: 299.3862s
Epoch: 6 cost time: 86.10576438903809
Epoch: 6, Steps: 1144 | Train Loss: 0.0784362 Vali Loss: 0.0919703 Test Loss: 0.1018961
Validation loss decreased (0.092411 --> 0.091970).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0760578
	speed: 2.2871s/iter; left time: 10239.3852s
	iters: 200, epoch: 7 | loss: 0.0883566
	speed: 0.0735s/iter; left time: 321.8154s
	iters: 300, epoch: 7 | loss: 0.0805294
	speed: 0.0745s/iter; left time: 318.5052s
	iters: 400, epoch: 7 | loss: 0.0766300
	speed: 0.0747s/iter; left time: 311.8977s
	iters: 500, epoch: 7 | loss: 0.0725340
	speed: 0.0742s/iter; left time: 302.7092s
	iters: 600, epoch: 7 | loss: 0.0755361
	speed: 0.0752s/iter; left time: 299.0517s
	iters: 700, epoch: 7 | loss: 0.0750446
	speed: 0.0751s/iter; left time: 291.1347s
	iters: 800, epoch: 7 | loss: 0.0742984
	speed: 0.0752s/iter; left time: 284.1321s
	iters: 900, epoch: 7 | loss: 0.0758663
	speed: 0.0749s/iter; left time: 275.5060s
	iters: 1000, epoch: 7 | loss: 0.0767458
	speed: 0.0593s/iter; left time: 212.2507s
	iters: 1100, epoch: 7 | loss: 0.0805293
	speed: 0.0572s/iter; left time: 199.0423s
Epoch: 7 cost time: 81.4674801826477
Epoch: 7, Steps: 1144 | Train Loss: 0.0780999 Vali Loss: 0.0914734 Test Loss: 0.1015725
Validation loss decreased (0.091970 --> 0.091473).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0733966
	speed: 2.2282s/iter; left time: 7426.7028s
	iters: 200, epoch: 8 | loss: 0.0761837
	speed: 0.0743s/iter; left time: 240.1375s
	iters: 300, epoch: 8 | loss: 0.0765253
	speed: 0.0743s/iter; left time: 232.7802s
	iters: 400, epoch: 8 | loss: 0.0795616
	speed: 0.0750s/iter; left time: 227.4966s
	iters: 500, epoch: 8 | loss: 0.0738999
	speed: 0.0739s/iter; left time: 216.6271s
	iters: 600, epoch: 8 | loss: 0.0803850
	speed: 0.0755s/iter; left time: 213.8695s
	iters: 700, epoch: 8 | loss: 0.0768387
	speed: 0.0749s/iter; left time: 204.6198s
	iters: 800, epoch: 8 | loss: 0.0770392
	speed: 0.0575s/iter; left time: 151.3362s
	iters: 900, epoch: 8 | loss: 0.0748979
	speed: 0.0576s/iter; left time: 145.7811s
	iters: 1000, epoch: 8 | loss: 0.0779553
	speed: 0.0604s/iter; left time: 147.0275s
	iters: 1100, epoch: 8 | loss: 0.0802514
	speed: 0.0618s/iter; left time: 144.2947s
Epoch: 8 cost time: 78.67039918899536
Epoch: 8, Steps: 1144 | Train Loss: 0.0779437 Vali Loss: 0.0918107 Test Loss: 0.1015666
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0776607
	speed: 2.0873s/iter; left time: 4569.0640s
	iters: 200, epoch: 9 | loss: 0.0783080
	speed: 0.0738s/iter; left time: 154.0768s
	iters: 300, epoch: 9 | loss: 0.0758272
	speed: 0.0742s/iter; left time: 147.5219s
	iters: 400, epoch: 9 | loss: 0.0757283
	speed: 0.0743s/iter; left time: 140.4455s
	iters: 500, epoch: 9 | loss: 0.0775208
	speed: 0.0750s/iter; left time: 134.2496s
	iters: 600, epoch: 9 | loss: 0.0681392
	speed: 0.0743s/iter; left time: 125.5357s
	iters: 700, epoch: 9 | loss: 0.0775073
	speed: 0.0660s/iter; left time: 104.8758s
	iters: 800, epoch: 9 | loss: 0.0726392
	speed: 0.0575s/iter; left time: 85.6897s
	iters: 900, epoch: 9 | loss: 0.0709127
	speed: 0.0604s/iter; left time: 83.8524s
	iters: 1000, epoch: 9 | loss: 0.0743057
	speed: 0.0590s/iter; left time: 76.0135s
	iters: 1100, epoch: 9 | loss: 0.0728917
	speed: 0.0606s/iter; left time: 72.0638s
Epoch: 9 cost time: 77.74600911140442
Epoch: 9, Steps: 1144 | Train Loss: 0.0778761 Vali Loss: 0.0916253 Test Loss: 0.1015742
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.0833884
	speed: 2.1648s/iter; left time: 2262.1693s
	iters: 200, epoch: 10 | loss: 0.0842504
	speed: 0.0743s/iter; left time: 70.1937s
	iters: 300, epoch: 10 | loss: 0.0796755
	speed: 0.0744s/iter; left time: 62.8718s
	iters: 400, epoch: 10 | loss: 0.0763263
	speed: 0.0742s/iter; left time: 55.2614s
	iters: 500, epoch: 10 | loss: 0.0808552
	speed: 0.0738s/iter; left time: 47.5984s
	iters: 600, epoch: 10 | loss: 0.0770535
	speed: 0.0631s/iter; left time: 34.4126s
	iters: 700, epoch: 10 | loss: 0.0819696
	speed: 0.0591s/iter; left time: 26.2879s
	iters: 800, epoch: 10 | loss: 0.0812269
	speed: 0.0625s/iter; left time: 21.5740s
	iters: 900, epoch: 10 | loss: 0.0741289
	speed: 0.0622s/iter; left time: 15.2393s
	iters: 1000, epoch: 10 | loss: 0.0789500
	speed: 0.0634s/iter; left time: 9.1964s
	iters: 1100, epoch: 10 | loss: 0.0811230
	speed: 0.0602s/iter; left time: 2.7085s
Epoch: 10 cost time: 77.0030689239502
Epoch: 10, Steps: 1144 | Train Loss: 0.0777733 Vali Loss: 0.0914677 Test Loss: 0.1015315
Validation loss decreased (0.091473 --> 0.091468).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : imputation_ECL_mask_0.5_TimesNet_custom_ftM_sl96_ll0_pl0_dm64_nh8_el2_dl1_df64_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5261
test shape: (5261, 96, 321) (5261, 96, 321)
mse:0.10157721489667892, mae:0.22073422372341156
