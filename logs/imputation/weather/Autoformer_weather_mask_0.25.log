Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           weather_mask_0.25   Model:              Autoformer          

[1mData Loader[0m
  Data:               custom              Root Path:          ../iTransformer_datasets/weather/
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.25                

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_weather_mask_0.25_Autoformer_custom_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36792
val 5271
test 10540
	iters: 100, epoch: 1 | loss: 0.6151713
	speed: 0.0645s/iter; left time: 1476.4555s
	iters: 200, epoch: 1 | loss: 0.2747910
	speed: 0.0520s/iter; left time: 1184.7882s
	iters: 300, epoch: 1 | loss: 0.1626367
	speed: 0.0511s/iter; left time: 1159.5019s
	iters: 400, epoch: 1 | loss: 0.2586730
	speed: 0.0521s/iter; left time: 1176.9189s
	iters: 500, epoch: 1 | loss: 0.2270721
	speed: 0.0521s/iter; left time: 1171.6347s
	iters: 600, epoch: 1 | loss: 0.2230880
	speed: 0.0515s/iter; left time: 1152.0282s
	iters: 700, epoch: 1 | loss: 0.2384984
	speed: 0.0523s/iter; left time: 1165.2757s
	iters: 800, epoch: 1 | loss: 0.2183864
	speed: 0.0514s/iter; left time: 1141.0609s
	iters: 900, epoch: 1 | loss: 0.1696270
	speed: 0.0509s/iter; left time: 1125.3761s
	iters: 1000, epoch: 1 | loss: 0.1725795
	speed: 0.0502s/iter; left time: 1104.8134s
	iters: 1100, epoch: 1 | loss: 0.6979921
	speed: 0.0529s/iter; left time: 1157.7944s
	iters: 1200, epoch: 1 | loss: 0.2825645
	speed: 0.0505s/iter; left time: 1100.2229s
	iters: 1300, epoch: 1 | loss: 0.0924281
	speed: 0.0492s/iter; left time: 1067.6748s
	iters: 1400, epoch: 1 | loss: 0.1425716
	speed: 0.0462s/iter; left time: 998.2527s
	iters: 1500, epoch: 1 | loss: 0.1225235
	speed: 0.0518s/iter; left time: 1112.3191s
	iters: 1600, epoch: 1 | loss: 0.1742881
	speed: 0.0513s/iter; left time: 1097.5754s
	iters: 1700, epoch: 1 | loss: 0.1279111
	speed: 0.0520s/iter; left time: 1107.0061s
	iters: 1800, epoch: 1 | loss: 0.3492216
	speed: 0.0529s/iter; left time: 1120.0962s
	iters: 1900, epoch: 1 | loss: 0.1331015
	speed: 0.0498s/iter; left time: 1050.1253s
	iters: 2000, epoch: 1 | loss: 0.3810536
	speed: 0.0499s/iter; left time: 1048.2602s
	iters: 2100, epoch: 1 | loss: 0.1747326
	speed: 0.0518s/iter; left time: 1081.1699s
	iters: 2200, epoch: 1 | loss: 0.2342723
	speed: 0.0498s/iter; left time: 1034.8483s
Epoch: 1 cost time: 118.19732069969177
Epoch: 1, Steps: 2299 | Train Loss: 0.2648425 Vali Loss: 0.4318252 Test Loss: 0.4290046
Validation loss decreased (inf --> 0.431825).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1131468
	speed: 2.1616s/iter; left time: 44510.8632s
	iters: 200, epoch: 2 | loss: 0.1582834
	speed: 0.0623s/iter; left time: 1276.1471s
	iters: 300, epoch: 2 | loss: 0.2431111
	speed: 0.0613s/iter; left time: 1249.9840s
	iters: 400, epoch: 2 | loss: 0.1316641
	speed: 0.0608s/iter; left time: 1233.6322s
	iters: 500, epoch: 2 | loss: 0.1402405
	speed: 0.0602s/iter; left time: 1214.7025s
	iters: 600, epoch: 2 | loss: 0.1442586
	speed: 0.0585s/iter; left time: 1175.2776s
	iters: 700, epoch: 2 | loss: 0.3857116
	speed: 0.0565s/iter; left time: 1129.6182s
	iters: 800, epoch: 2 | loss: 0.1596257
	speed: 0.0571s/iter; left time: 1136.1711s
	iters: 900, epoch: 2 | loss: 0.1137083
	speed: 0.0597s/iter; left time: 1181.3225s
	iters: 1000, epoch: 2 | loss: 0.3536790
	speed: 0.0589s/iter; left time: 1158.9998s
	iters: 1100, epoch: 2 | loss: 0.2037827
	speed: 0.0571s/iter; left time: 1118.1780s
	iters: 1200, epoch: 2 | loss: 0.2786801
	speed: 0.0589s/iter; left time: 1148.8099s
	iters: 1300, epoch: 2 | loss: 0.1541744
	speed: 0.0577s/iter; left time: 1117.9571s
	iters: 1400, epoch: 2 | loss: 0.1160540
	speed: 0.0577s/iter; left time: 1113.4751s
	iters: 1500, epoch: 2 | loss: 0.1141381
	speed: 0.0589s/iter; left time: 1130.7581s
	iters: 1600, epoch: 2 | loss: 0.1043380
	speed: 0.0597s/iter; left time: 1138.8387s
	iters: 1700, epoch: 2 | loss: 0.0966725
	speed: 0.0574s/iter; left time: 1090.3157s
	iters: 1800, epoch: 2 | loss: 0.8078753
	speed: 0.0565s/iter; left time: 1066.4547s
	iters: 1900, epoch: 2 | loss: 0.2747560
	speed: 0.0580s/iter; left time: 1089.4485s
	iters: 2000, epoch: 2 | loss: 0.1869948
	speed: 0.0567s/iter; left time: 1059.6305s
	iters: 2100, epoch: 2 | loss: 0.1269418
	speed: 0.0531s/iter; left time: 986.7906s
	iters: 2200, epoch: 2 | loss: 0.0933348
	speed: 0.0607s/iter; left time: 1123.1659s
Epoch: 2 cost time: 134.62489986419678
Epoch: 2, Steps: 2299 | Train Loss: 0.2150733 Vali Loss: 1.2668189 Test Loss: 1.4268849
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1230938
	speed: 2.3001s/iter; left time: 42076.1791s
	iters: 200, epoch: 3 | loss: 0.1247833
	speed: 0.0619s/iter; left time: 1126.9213s
	iters: 300, epoch: 3 | loss: 0.1365358
	speed: 0.0675s/iter; left time: 1221.9282s
	iters: 400, epoch: 3 | loss: 0.1263544
	speed: 0.0623s/iter; left time: 1121.5711s
	iters: 500, epoch: 3 | loss: 0.1083236
	speed: 0.0619s/iter; left time: 1107.4351s
	iters: 600, epoch: 3 | loss: 0.1328714
	speed: 0.0608s/iter; left time: 1081.9985s
	iters: 700, epoch: 3 | loss: 0.3966106
	speed: 0.0612s/iter; left time: 1083.2590s
	iters: 800, epoch: 3 | loss: 0.1083821
	speed: 0.0692s/iter; left time: 1216.7021s
	iters: 900, epoch: 3 | loss: 0.1097811
	speed: 0.0645s/iter; left time: 1127.7776s
	iters: 1000, epoch: 3 | loss: 0.1205385
	speed: 0.0679s/iter; left time: 1180.2234s
	iters: 1100, epoch: 3 | loss: 0.1099512
	speed: 0.0681s/iter; left time: 1177.6161s
	iters: 1200, epoch: 3 | loss: 0.3583970
	speed: 0.0649s/iter; left time: 1115.6121s
	iters: 1300, epoch: 3 | loss: 0.3461488
	speed: 0.0663s/iter; left time: 1133.5410s
	iters: 1400, epoch: 3 | loss: 0.1133141
	speed: 0.0635s/iter; left time: 1079.8368s
	iters: 1500, epoch: 3 | loss: 0.1428809
	speed: 0.0624s/iter; left time: 1054.8386s
	iters: 1600, epoch: 3 | loss: 0.1317310
	speed: 0.0619s/iter; left time: 1039.5232s
	iters: 1700, epoch: 3 | loss: 0.4118375
	speed: 0.0686s/iter; left time: 1145.8837s
	iters: 1800, epoch: 3 | loss: 0.1116486
	speed: 0.0628s/iter; left time: 1041.8844s
	iters: 1900, epoch: 3 | loss: 0.1056684
	speed: 0.0631s/iter; left time: 1041.4827s
	iters: 2000, epoch: 3 | loss: 0.1048136
	speed: 0.0630s/iter; left time: 1032.0255s
	iters: 2100, epoch: 3 | loss: 0.1218756
	speed: 0.0608s/iter; left time: 990.3602s
	iters: 2200, epoch: 3 | loss: 0.3795813
	speed: 0.0665s/iter; left time: 1077.1210s
Epoch: 3 cost time: 147.15944719314575
Epoch: 3, Steps: 2299 | Train Loss: 0.2041958 Vali Loss: 1.5167050 Test Loss: 1.7254381
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0874013
	speed: 2.0400s/iter; left time: 32628.1000s
	iters: 200, epoch: 4 | loss: 0.0828989
	speed: 0.0609s/iter; left time: 968.3866s
	iters: 300, epoch: 4 | loss: 0.1164223
	speed: 0.0596s/iter; left time: 940.6146s
	iters: 400, epoch: 4 | loss: 0.1294332
	speed: 0.0557s/iter; left time: 873.5213s
	iters: 500, epoch: 4 | loss: 0.0920508
	speed: 0.0577s/iter; left time: 900.2060s
	iters: 600, epoch: 4 | loss: 0.1058338
	speed: 0.0532s/iter; left time: 823.8498s
	iters: 700, epoch: 4 | loss: 0.1184174
	speed: 0.0525s/iter; left time: 807.5013s
	iters: 800, epoch: 4 | loss: 0.1033225
	speed: 0.0530s/iter; left time: 810.7369s
	iters: 900, epoch: 4 | loss: 0.1370286
	speed: 0.0529s/iter; left time: 803.5075s
	iters: 1000, epoch: 4 | loss: 0.1441206
	speed: 0.0551s/iter; left time: 831.2263s
	iters: 1100, epoch: 4 | loss: 0.1118052
	speed: 0.0552s/iter; left time: 827.1576s
	iters: 1200, epoch: 4 | loss: 0.1657326
	speed: 0.0550s/iter; left time: 819.2845s
	iters: 1300, epoch: 4 | loss: 0.1367434
	speed: 0.0541s/iter; left time: 800.5322s
	iters: 1400, epoch: 4 | loss: 0.1208747
	speed: 0.0553s/iter; left time: 812.1238s
	iters: 1500, epoch: 4 | loss: 0.1769038
	speed: 0.0547s/iter; left time: 797.6969s
	iters: 1600, epoch: 4 | loss: 0.1053754
	speed: 0.0540s/iter; left time: 782.5868s
	iters: 1700, epoch: 4 | loss: 0.0916460
	speed: 0.0526s/iter; left time: 756.5933s
	iters: 1800, epoch: 4 | loss: 0.0887249
	speed: 0.0512s/iter; left time: 732.1383s
	iters: 1900, epoch: 4 | loss: 0.1252213
	speed: 0.0506s/iter; left time: 718.4451s
	iters: 2000, epoch: 4 | loss: 0.0906662
	speed: 0.0527s/iter; left time: 742.5020s
	iters: 2100, epoch: 4 | loss: 0.0993210
	speed: 0.0531s/iter; left time: 743.5830s
	iters: 2200, epoch: 4 | loss: 0.2624446
	speed: 0.0750s/iter; left time: 1042.6073s
Epoch: 4 cost time: 128.25570130348206
Epoch: 4, Steps: 2299 | Train Loss: 0.2015031 Vali Loss: 1.7174436 Test Loss: 1.9764321
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_weather_mask_0.25_Autoformer_custom_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10540
test shape: (10540, 96, 21) (10540, 96, 21)
mse:0.42752933502197266, mae:0.4709668755531311
