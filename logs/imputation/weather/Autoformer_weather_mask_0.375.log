Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           weather_mask_0.375  Model:              Autoformer          

[1mData Loader[0m
  Data:               custom              Root Path:          ../iTransformer_datasets/weather/
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.375               

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_weather_mask_0.375_Autoformer_custom_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36792
val 5271
test 10540
	iters: 100, epoch: 1 | loss: 0.6555870
	speed: 0.0624s/iter; left time: 1427.9145s
	iters: 200, epoch: 1 | loss: 0.2988158
	speed: 0.0500s/iter; left time: 1138.4272s
	iters: 300, epoch: 1 | loss: 0.1948021
	speed: 0.0527s/iter; left time: 1196.5497s
	iters: 400, epoch: 1 | loss: 0.2972941
	speed: 0.0514s/iter; left time: 1162.1277s
	iters: 500, epoch: 1 | loss: 0.2718846
	speed: 0.0512s/iter; left time: 1152.5316s
	iters: 600, epoch: 1 | loss: 0.2554018
	speed: 0.0523s/iter; left time: 1170.0068s
	iters: 700, epoch: 1 | loss: 0.2742753
	speed: 0.0516s/iter; left time: 1149.4584s
	iters: 800, epoch: 1 | loss: 0.2254775
	speed: 0.0504s/iter; left time: 1118.1294s
	iters: 900, epoch: 1 | loss: 0.1985191
	speed: 0.0505s/iter; left time: 1115.2284s
	iters: 1000, epoch: 1 | loss: 0.2120325
	speed: 0.0503s/iter; left time: 1106.2406s
	iters: 1100, epoch: 1 | loss: 0.4904713
	speed: 0.0492s/iter; left time: 1077.7624s
	iters: 1200, epoch: 1 | loss: 0.3311218
	speed: 0.0517s/iter; left time: 1125.7948s
	iters: 1300, epoch: 1 | loss: 0.1176810
	speed: 0.0515s/iter; left time: 1116.0684s
	iters: 1400, epoch: 1 | loss: 0.1675530
	speed: 0.0501s/iter; left time: 1080.9945s
	iters: 1500, epoch: 1 | loss: 0.1758564
	speed: 0.0538s/iter; left time: 1155.7081s
	iters: 1600, epoch: 1 | loss: 0.1750549
	speed: 0.0500s/iter; left time: 1068.9251s
	iters: 1700, epoch: 1 | loss: 0.1695905
	speed: 0.0505s/iter; left time: 1074.9431s
	iters: 1800, epoch: 1 | loss: 0.2944765
	speed: 0.0539s/iter; left time: 1141.8692s
	iters: 1900, epoch: 1 | loss: 0.1617590
	speed: 0.0509s/iter; left time: 1074.5530s
	iters: 2000, epoch: 1 | loss: 0.4025843
	speed: 0.0481s/iter; left time: 1009.0965s
	iters: 2100, epoch: 1 | loss: 0.1988866
	speed: 0.0479s/iter; left time: 1000.0251s
	iters: 2200, epoch: 1 | loss: 0.2187605
	speed: 0.0459s/iter; left time: 954.0027s
Epoch: 1 cost time: 117.20171689987183
Epoch: 1, Steps: 2299 | Train Loss: 0.3015788 Vali Loss: 0.2032464 Test Loss: 0.1165817
Validation loss decreased (inf --> 0.203246).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1559965
	speed: 2.1879s/iter; left time: 45053.3853s
	iters: 200, epoch: 2 | loss: 0.1904125
	speed: 0.0623s/iter; left time: 1276.0404s
	iters: 300, epoch: 2 | loss: 0.3013726
	speed: 0.0617s/iter; left time: 1258.5254s
	iters: 400, epoch: 2 | loss: 0.1785015
	speed: 0.0612s/iter; left time: 1241.8107s
	iters: 500, epoch: 2 | loss: 0.1768830
	speed: 0.0582s/iter; left time: 1174.3881s
	iters: 600, epoch: 2 | loss: 0.1885879
	speed: 0.0583s/iter; left time: 1171.9766s
	iters: 700, epoch: 2 | loss: 0.3629963
	speed: 0.0580s/iter; left time: 1160.3356s
	iters: 800, epoch: 2 | loss: 0.1761886
	speed: 0.0572s/iter; left time: 1137.9685s
	iters: 900, epoch: 2 | loss: 0.1573237
	speed: 0.0578s/iter; left time: 1143.9636s
	iters: 1000, epoch: 2 | loss: 0.3370679
	speed: 0.0575s/iter; left time: 1132.5896s
	iters: 1100, epoch: 2 | loss: 0.2372270
	speed: 0.0572s/iter; left time: 1120.5338s
	iters: 1200, epoch: 2 | loss: 0.3048008
	speed: 0.0573s/iter; left time: 1117.1715s
	iters: 1300, epoch: 2 | loss: 0.1950086
	speed: 0.0570s/iter; left time: 1105.2679s
	iters: 1400, epoch: 2 | loss: 0.1545987
	speed: 0.0585s/iter; left time: 1128.9441s
	iters: 1500, epoch: 2 | loss: 0.1527957
	speed: 0.0596s/iter; left time: 1144.5573s
	iters: 1600, epoch: 2 | loss: 0.1453916
	speed: 0.0596s/iter; left time: 1137.2228s
	iters: 1700, epoch: 2 | loss: 0.1433019
	speed: 0.0592s/iter; left time: 1124.8306s
	iters: 1800, epoch: 2 | loss: 0.6962261
	speed: 0.0570s/iter; left time: 1076.1615s
	iters: 1900, epoch: 2 | loss: 0.2639939
	speed: 0.0540s/iter; left time: 1015.1234s
	iters: 2000, epoch: 2 | loss: 0.2236602
	speed: 0.0554s/iter; left time: 1034.8678s
	iters: 2100, epoch: 2 | loss: 0.1673534
	speed: 0.0554s/iter; left time: 1030.8631s
	iters: 2200, epoch: 2 | loss: 0.1359765
	speed: 0.0622s/iter; left time: 1149.9969s
Epoch: 2 cost time: 134.48427510261536
Epoch: 2, Steps: 2299 | Train Loss: 0.2626818 Vali Loss: 0.2953714 Test Loss: 0.2391599
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1847582
	speed: 2.3245s/iter; left time: 42522.3327s
	iters: 200, epoch: 3 | loss: 0.1610355
	speed: 0.0669s/iter; left time: 1216.7897s
	iters: 300, epoch: 3 | loss: 0.2113345
	speed: 0.0631s/iter; left time: 1141.0649s
	iters: 400, epoch: 3 | loss: 0.1607267
	speed: 0.0604s/iter; left time: 1086.5985s
	iters: 500, epoch: 3 | loss: 0.1246449
	speed: 0.0608s/iter; left time: 1087.3590s
	iters: 600, epoch: 3 | loss: 0.1702979
	speed: 0.0600s/iter; left time: 1067.8588s
	iters: 700, epoch: 3 | loss: 0.2970433
	speed: 0.0647s/iter; left time: 1144.0751s
	iters: 800, epoch: 3 | loss: 0.1442478
	speed: 0.0673s/iter; left time: 1184.5042s
	iters: 900, epoch: 3 | loss: 0.1505138
	speed: 0.0680s/iter; left time: 1189.8106s
	iters: 1000, epoch: 3 | loss: 0.1573058
	speed: 0.0668s/iter; left time: 1161.3544s
	iters: 1100, epoch: 3 | loss: 0.1502161
	speed: 0.0626s/iter; left time: 1082.1371s
	iters: 1200, epoch: 3 | loss: 0.4729650
	speed: 0.0665s/iter; left time: 1144.1513s
	iters: 1300, epoch: 3 | loss: 0.3419254
	speed: 0.0599s/iter; left time: 1023.5849s
	iters: 1400, epoch: 3 | loss: 0.1478248
	speed: 0.0610s/iter; left time: 1036.4910s
	iters: 1500, epoch: 3 | loss: 0.1788084
	speed: 0.0628s/iter; left time: 1060.8757s
	iters: 1600, epoch: 3 | loss: 0.1663256
	speed: 0.0634s/iter; left time: 1065.5071s
	iters: 1700, epoch: 3 | loss: 0.3436774
	speed: 0.0684s/iter; left time: 1142.5601s
	iters: 1800, epoch: 3 | loss: 0.1588701
	speed: 0.0616s/iter; left time: 1021.9564s
	iters: 1900, epoch: 3 | loss: 0.1990885
	speed: 0.0617s/iter; left time: 1017.8456s
	iters: 2000, epoch: 3 | loss: 0.1454698
	speed: 0.0664s/iter; left time: 1087.7347s
	iters: 2100, epoch: 3 | loss: 0.1568647
	speed: 0.0633s/iter; left time: 1031.9326s
	iters: 2200, epoch: 3 | loss: 0.5535764
	speed: 0.0660s/iter; left time: 1068.7395s
Epoch: 3 cost time: 145.92880725860596
Epoch: 3, Steps: 2299 | Train Loss: 0.2447139 Vali Loss: 0.3341097 Test Loss: 0.2888535
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1199403
	speed: 2.0569s/iter; left time: 32898.7360s
	iters: 200, epoch: 4 | loss: 0.1151198
	speed: 0.0596s/iter; left time: 947.1685s
	iters: 300, epoch: 4 | loss: 0.2061786
	speed: 0.0566s/iter; left time: 893.6880s
	iters: 400, epoch: 4 | loss: 0.1719019
	speed: 0.0589s/iter; left time: 924.6791s
	iters: 500, epoch: 4 | loss: 0.1248716
	speed: 0.0574s/iter; left time: 894.9946s
	iters: 600, epoch: 4 | loss: 0.1540748
	speed: 0.0541s/iter; left time: 838.9525s
	iters: 700, epoch: 4 | loss: 0.1881831
	speed: 0.0552s/iter; left time: 849.0415s
	iters: 800, epoch: 4 | loss: 0.1236865
	speed: 0.0556s/iter; left time: 850.2479s
	iters: 900, epoch: 4 | loss: 0.2568305
	speed: 0.0551s/iter; left time: 837.8175s
	iters: 1000, epoch: 4 | loss: 0.1694596
	speed: 0.0538s/iter; left time: 812.1061s
	iters: 1100, epoch: 4 | loss: 0.1572410
	speed: 0.0544s/iter; left time: 815.5210s
	iters: 1200, epoch: 4 | loss: 0.1782652
	speed: 0.0563s/iter; left time: 838.0615s
	iters: 1300, epoch: 4 | loss: 0.1617362
	speed: 0.0541s/iter; left time: 799.7685s
	iters: 1400, epoch: 4 | loss: 0.1592402
	speed: 0.0554s/iter; left time: 814.3556s
	iters: 1500, epoch: 4 | loss: 0.1951289
	speed: 0.0536s/iter; left time: 782.9042s
	iters: 1600, epoch: 4 | loss: 0.1362477
	speed: 0.0534s/iter; left time: 773.2553s
	iters: 1700, epoch: 4 | loss: 0.1222532
	speed: 0.0526s/iter; left time: 756.6338s
	iters: 1800, epoch: 4 | loss: 0.1266085
	speed: 0.0513s/iter; left time: 733.2934s
	iters: 1900, epoch: 4 | loss: 0.1611020
	speed: 0.0517s/iter; left time: 734.3354s
	iters: 2000, epoch: 4 | loss: 0.1399311
	speed: 0.0524s/iter; left time: 738.5087s
	iters: 2100, epoch: 4 | loss: 0.1428923
	speed: 0.0743s/iter; left time: 1040.0534s
	iters: 2200, epoch: 4 | loss: 0.2565747
	speed: 0.0572s/iter; left time: 795.3047s
Epoch: 4 cost time: 128.173175573349
Epoch: 4, Steps: 2299 | Train Loss: 0.2403007 Vali Loss: 0.3629060 Test Loss: 0.3363982
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_weather_mask_0.375_Autoformer_custom_ftM_sl96_ll0_pl0_dm128_nh8_el2_dl1_df128_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10540
test shape: (10540, 96, 21) (10540, 96, 21)
mse:0.11599985510110855, mae:0.21939721703529358
