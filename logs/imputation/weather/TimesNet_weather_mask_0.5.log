Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           weather_mask_0.5    Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ../iTransformer_datasets/weather/
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.5                 

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : imputation_weather_mask_0.5_TimesNet_custom_ftM_sl96_ll0_pl0_dm64_nh8_el2_dl1_df64_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36792
val 5271
test 10540
	iters: 100, epoch: 1 | loss: 0.2238498
	speed: 0.1073s/iter; left time: 2455.2910s
	iters: 200, epoch: 1 | loss: 0.3329793
	speed: 0.0641s/iter; left time: 1459.9455s
	iters: 300, epoch: 1 | loss: 0.1312272
	speed: 0.0659s/iter; left time: 1494.5681s
	iters: 400, epoch: 1 | loss: 0.0813073
	speed: 0.0677s/iter; left time: 1529.0088s
	iters: 500, epoch: 1 | loss: 0.0897973
	speed: 0.0682s/iter; left time: 1533.1613s
	iters: 600, epoch: 1 | loss: 0.0612405
	speed: 0.0699s/iter; left time: 1565.3870s
	iters: 700, epoch: 1 | loss: 0.0874540
	speed: 0.0693s/iter; left time: 1544.3326s
	iters: 800, epoch: 1 | loss: 0.1414428
	speed: 0.0707s/iter; left time: 1568.6238s
	iters: 900, epoch: 1 | loss: 0.0603979
	speed: 0.0711s/iter; left time: 1571.3471s
	iters: 1000, epoch: 1 | loss: 2.4526298
	speed: 0.0705s/iter; left time: 1551.4607s
	iters: 1100, epoch: 1 | loss: 0.1343074
	speed: 0.0715s/iter; left time: 1564.6458s
	iters: 1200, epoch: 1 | loss: 0.0831015
	speed: 0.0754s/iter; left time: 1643.8984s
	iters: 1300, epoch: 1 | loss: 0.0610298
	speed: 0.0834s/iter; left time: 1809.0504s
	iters: 1400, epoch: 1 | loss: 0.1258492
	speed: 0.0818s/iter; left time: 1765.8830s
	iters: 1500, epoch: 1 | loss: 0.0860937
	speed: 0.0817s/iter; left time: 1754.8741s
	iters: 1600, epoch: 1 | loss: 0.1049937
	speed: 0.0825s/iter; left time: 1764.3805s
	iters: 1700, epoch: 1 | loss: 0.0777244
	speed: 0.0835s/iter; left time: 1778.5719s
	iters: 1800, epoch: 1 | loss: 0.0935751
	speed: 0.0844s/iter; left time: 1787.8676s
	iters: 1900, epoch: 1 | loss: 0.1166372
	speed: 0.0865s/iter; left time: 1823.8379s
	iters: 2000, epoch: 1 | loss: 2.4790530
	speed: 0.0862s/iter; left time: 1810.4224s
	iters: 2100, epoch: 1 | loss: 0.0881213
	speed: 0.0872s/iter; left time: 1822.4078s
	iters: 2200, epoch: 1 | loss: 0.0692222
	speed: 0.0865s/iter; left time: 1799.3742s
Epoch: 1 cost time: 180.2182273864746
Epoch: 1, Steps: 2299 | Train Loss: 0.1897781 Vali Loss: 0.1078355 Test Loss: 0.0378726
Validation loss decreased (inf --> 0.107835).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.0978678
	speed: 3.1338s/iter; left time: 64531.9676s
	iters: 200, epoch: 2 | loss: 0.1568632
	speed: 0.0875s/iter; left time: 1792.3376s
	iters: 300, epoch: 2 | loss: 0.0546767
	speed: 0.0878s/iter; left time: 1789.7437s
	iters: 400, epoch: 2 | loss: 0.0609780
	speed: 0.0877s/iter; left time: 1780.0802s
	iters: 500, epoch: 2 | loss: 0.0798954
	speed: 0.1068s/iter; left time: 2156.5586s
	iters: 600, epoch: 2 | loss: 0.0600962
	speed: 0.1082s/iter; left time: 2174.3197s
	iters: 700, epoch: 2 | loss: 0.0670471
	speed: 0.1098s/iter; left time: 2194.4973s
	iters: 800, epoch: 2 | loss: 0.1228662
	speed: 0.1106s/iter; left time: 2199.2843s
	iters: 900, epoch: 2 | loss: 0.1121469
	speed: 0.1108s/iter; left time: 2192.3726s
	iters: 1000, epoch: 2 | loss: 0.1222308
	speed: 0.1108s/iter; left time: 2181.1596s
	iters: 1100, epoch: 2 | loss: 0.0748199
	speed: 0.1103s/iter; left time: 2161.8145s
	iters: 1200, epoch: 2 | loss: 0.0705142
	speed: 0.1100s/iter; left time: 2143.9884s
	iters: 1300, epoch: 2 | loss: 0.1071206
	speed: 0.1103s/iter; left time: 2138.8909s
	iters: 1400, epoch: 2 | loss: 0.1238478
	speed: 0.1101s/iter; left time: 2124.9068s
	iters: 1500, epoch: 2 | loss: 0.0801398
	speed: 0.1114s/iter; left time: 2138.8132s
	iters: 1600, epoch: 2 | loss: 0.0590243
	speed: 0.1112s/iter; left time: 2122.6720s
	iters: 1700, epoch: 2 | loss: 0.0965846
	speed: 0.1105s/iter; left time: 2098.9759s
	iters: 1800, epoch: 2 | loss: 0.0865378
	speed: 0.1116s/iter; left time: 2108.2977s
	iters: 1900, epoch: 2 | loss: 0.0652401
	speed: 0.1113s/iter; left time: 2090.8491s
	iters: 2000, epoch: 2 | loss: 0.1964373
	speed: 0.1112s/iter; left time: 2079.1492s
	iters: 2100, epoch: 2 | loss: 0.1301582
	speed: 0.1106s/iter; left time: 2056.6826s
	iters: 2200, epoch: 2 | loss: 0.0605703
	speed: 0.1101s/iter; left time: 2036.1377s
Epoch: 2 cost time: 243.220600605011
Epoch: 2, Steps: 2299 | Train Loss: 0.1531304 Vali Loss: 0.1081677 Test Loss: 0.0372860
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0780495
	speed: 3.1384s/iter; left time: 57410.1215s
	iters: 200, epoch: 3 | loss: 0.0961675
	speed: 0.0882s/iter; left time: 1604.0044s
	iters: 300, epoch: 3 | loss: 0.0637673
	speed: 0.0920s/iter; left time: 1665.0757s
	iters: 400, epoch: 3 | loss: 0.1053560
	speed: 0.0977s/iter; left time: 1758.4082s
	iters: 500, epoch: 3 | loss: 0.0498113
	speed: 0.0981s/iter; left time: 1755.0962s
	iters: 600, epoch: 3 | loss: 0.0793023
	speed: 0.0983s/iter; left time: 1748.9477s
	iters: 700, epoch: 3 | loss: 0.2052655
	speed: 0.0986s/iter; left time: 1745.4038s
	iters: 800, epoch: 3 | loss: 0.1310044
	speed: 0.0990s/iter; left time: 1740.9621s
	iters: 900, epoch: 3 | loss: 0.2108071
	speed: 0.0990s/iter; left time: 1731.6070s
	iters: 1000, epoch: 3 | loss: 0.0692339
	speed: 0.0984s/iter; left time: 1712.0717s
	iters: 1100, epoch: 3 | loss: 0.0801411
	speed: 0.0991s/iter; left time: 1713.3600s
	iters: 1200, epoch: 3 | loss: 0.2206955
	speed: 0.0987s/iter; left time: 1697.0611s
	iters: 1300, epoch: 3 | loss: 0.1027821
	speed: 0.1086s/iter; left time: 1855.5157s
	iters: 1400, epoch: 3 | loss: 0.1622212
	speed: 0.1104s/iter; left time: 1876.0701s
	iters: 1500, epoch: 3 | loss: 0.0498825
	speed: 0.1108s/iter; left time: 1871.7359s
	iters: 1600, epoch: 3 | loss: 0.0851722
	speed: 0.1115s/iter; left time: 1872.0922s
	iters: 1700, epoch: 3 | loss: 0.1027016
	speed: 0.1125s/iter; left time: 1878.0918s
	iters: 1800, epoch: 3 | loss: 0.0671880
	speed: 0.1116s/iter; left time: 1852.1172s
	iters: 1900, epoch: 3 | loss: 0.0547405
	speed: 0.1111s/iter; left time: 1831.7403s
	iters: 2000, epoch: 3 | loss: 0.0530226
	speed: 0.1114s/iter; left time: 1826.4045s
	iters: 2100, epoch: 3 | loss: 0.1277910
	speed: 0.1120s/iter; left time: 1825.1319s
	iters: 2200, epoch: 3 | loss: 0.0442063
	speed: 0.1128s/iter; left time: 1827.3202s
Epoch: 3 cost time: 233.76572489738464
Epoch: 3, Steps: 2299 | Train Loss: 0.1507518 Vali Loss: 0.1080718 Test Loss: 0.0357585
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0457504
	speed: 3.2517s/iter; left time: 52007.9723s
	iters: 200, epoch: 4 | loss: 0.1184759
	speed: 0.0981s/iter; left time: 1558.9465s
	iters: 300, epoch: 4 | loss: 0.0564575
	speed: 0.1072s/iter; left time: 1693.2916s
	iters: 400, epoch: 4 | loss: 0.0428386
	speed: 0.1076s/iter; left time: 1688.4267s
	iters: 500, epoch: 4 | loss: 0.0562911
	speed: 0.1076s/iter; left time: 1677.9350s
	iters: 600, epoch: 4 | loss: 0.0680776
	speed: 0.1088s/iter; left time: 1685.3500s
	iters: 700, epoch: 4 | loss: 0.1038739
	speed: 0.1078s/iter; left time: 1658.9050s
	iters: 800, epoch: 4 | loss: 0.1376997
	speed: 0.1075s/iter; left time: 1644.5500s
	iters: 900, epoch: 4 | loss: 0.0915843
	speed: 0.1083s/iter; left time: 1645.6031s
	iters: 1000, epoch: 4 | loss: 0.0585017
	speed: 0.1086s/iter; left time: 1639.3406s
	iters: 1100, epoch: 4 | loss: 0.0716249
	speed: 0.1081s/iter; left time: 1620.4607s
	iters: 1200, epoch: 4 | loss: 0.0638145
	speed: 0.1088s/iter; left time: 1621.0213s
	iters: 1300, epoch: 4 | loss: 0.1291219
	speed: 0.1085s/iter; left time: 1605.3856s
	iters: 1400, epoch: 4 | loss: 0.0578978
	speed: 0.1086s/iter; left time: 1595.2385s
	iters: 1500, epoch: 4 | loss: 0.0932131
	speed: 0.1088s/iter; left time: 1587.8048s
	iters: 1600, epoch: 4 | loss: 0.1179865
	speed: 0.1086s/iter; left time: 1573.8285s
	iters: 1700, epoch: 4 | loss: 0.0542826
	speed: 0.1080s/iter; left time: 1553.9306s
	iters: 1800, epoch: 4 | loss: 0.0606274
	speed: 0.1078s/iter; left time: 1541.3626s
	iters: 1900, epoch: 4 | loss: 0.0972048
	speed: 0.1073s/iter; left time: 1522.8121s
	iters: 2000, epoch: 4 | loss: 0.0683344
	speed: 0.1076s/iter; left time: 1516.1433s
	iters: 2100, epoch: 4 | loss: 0.0811707
	speed: 0.1084s/iter; left time: 1517.3174s
	iters: 2200, epoch: 4 | loss: 0.1020051
	speed: 0.1051s/iter; left time: 1459.6960s
Epoch: 4 cost time: 242.74713921546936
Epoch: 4, Steps: 2299 | Train Loss: 0.1423677 Vali Loss: 0.1162319 Test Loss: 0.0348004
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_weather_mask_0.5_TimesNet_custom_ftM_sl96_ll0_pl0_dm64_nh8_el2_dl1_df64_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10540
test shape: (10540, 96, 21) (10540, 96, 21)
mse:0.03761112689971924, mae:0.07033349573612213
