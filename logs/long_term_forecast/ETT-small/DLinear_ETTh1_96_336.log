Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_336        Model:              DLinear             

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ../iTransformer_datasets/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_336_DLinear_ETTh1_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5932657
	speed: 0.1232s/iter; left time: 303.2964s
	iters: 200, epoch: 1 | loss: 0.6068065
	speed: 0.0904s/iter; left time: 213.5245s
Epoch: 1 cost time: 26.589273691177368
Epoch: 1, Steps: 256 | Train Loss: 0.5311556 Vali Loss: 1.1687913 Test Loss: 0.5142799
Validation loss decreased (inf --> 1.168791).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3905731
	speed: 0.4497s/iter; left time: 991.5438s
	iters: 200, epoch: 2 | loss: 0.4316107
	speed: 0.0936s/iter; left time: 196.9996s
Epoch: 2 cost time: 23.13370990753174
Epoch: 2, Steps: 256 | Train Loss: 0.4797918 Vali Loss: 1.1385691 Test Loss: 0.4936372
Validation loss decreased (1.168791 --> 1.138569).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4433599
	speed: 0.4384s/iter; left time: 854.4184s
	iters: 200, epoch: 3 | loss: 0.4674131
	speed: 0.0864s/iter; left time: 159.7950s
Epoch: 3 cost time: 22.587945222854614
Epoch: 3, Steps: 256 | Train Loss: 0.4713274 Vali Loss: 1.1278862 Test Loss: 0.4899473
Validation loss decreased (1.138569 --> 1.127886).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4079817
	speed: 0.4667s/iter; left time: 790.1616s
	iters: 200, epoch: 4 | loss: 0.5271508
	speed: 0.0946s/iter; left time: 150.6319s
Epoch: 4 cost time: 23.760348081588745
Epoch: 4, Steps: 256 | Train Loss: 0.4687799 Vali Loss: 1.1219450 Test Loss: 0.4885421
Validation loss decreased (1.127886 --> 1.121945).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5078541
	speed: 0.4460s/iter; left time: 640.8843s
	iters: 200, epoch: 5 | loss: 0.4569444
	speed: 0.0903s/iter; left time: 120.7067s
Epoch: 5 cost time: 22.43880581855774
Epoch: 5, Steps: 256 | Train Loss: 0.4680283 Vali Loss: 1.1271645 Test Loss: 0.4874507
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5339180
	speed: 0.4313s/iter; left time: 509.4187s
	iters: 200, epoch: 6 | loss: 0.4797630
	speed: 0.0641s/iter; left time: 69.2833s
Epoch: 6 cost time: 20.30865454673767
Epoch: 6, Steps: 256 | Train Loss: 0.4675413 Vali Loss: 1.1257339 Test Loss: 0.4871096
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4208109
	speed: 0.4274s/iter; left time: 395.3252s
	iters: 200, epoch: 7 | loss: 0.4919517
	speed: 0.0588s/iter; left time: 48.4721s
Epoch: 7 cost time: 16.32430362701416
Epoch: 7, Steps: 256 | Train Loss: 0.4670861 Vali Loss: 1.1261432 Test Loss: 0.4869485
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_336_DLinear_ETTh1_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4885421395301819, mae:0.46670401096343994
