Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_96           Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ../iTransformer_datasets/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_96_PatchTST_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3219265
	speed: 1.2348s/iter; left time: 13930.1808s
	iters: 200, epoch: 1 | loss: 0.2755499
	speed: 0.9829s/iter; left time: 10989.2771s
	iters: 300, epoch: 1 | loss: 0.2518245
	speed: 0.8853s/iter; left time: 9809.9607s
	iters: 400, epoch: 1 | loss: 0.2638967
	speed: 0.9024s/iter; left time: 9909.6698s
	iters: 500, epoch: 1 | loss: 0.2712099
	speed: 0.9234s/iter; left time: 10047.3673s
	iters: 600, epoch: 1 | loss: 0.2642289
	speed: 0.9129s/iter; left time: 9841.8541s
	iters: 700, epoch: 1 | loss: 0.2645487
	speed: 0.9134s/iter; left time: 9755.9655s
	iters: 800, epoch: 1 | loss: 0.2669092
	speed: 0.8892s/iter; left time: 9408.8599s
	iters: 900, epoch: 1 | loss: 0.3043107
	speed: 0.9652s/iter; left time: 10116.1084s
	iters: 1000, epoch: 1 | loss: 0.2641404
	speed: 0.9401s/iter; left time: 9758.7905s
	iters: 1100, epoch: 1 | loss: 0.2542111
	speed: 0.9527s/iter; left time: 9794.6138s
Epoch: 1 cost time: 1085.9431278705597
Epoch: 1, Steps: 1138 | Train Loss: 0.2832795 Vali Loss: 0.1711608 Test Loss: 0.1931286
Validation loss decreased (inf --> 0.171161).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2681132
	speed: 5.2949s/iter; left time: 53705.9064s
	iters: 200, epoch: 2 | loss: 0.2471059
	speed: 1.0898s/iter; left time: 10944.7634s
	iters: 300, epoch: 2 | loss: 0.3172494
	speed: 0.9874s/iter; left time: 9817.7714s
	iters: 400, epoch: 2 | loss: 0.2341591
	speed: 1.0044s/iter; left time: 9885.8609s
	iters: 500, epoch: 2 | loss: 0.2704434
	speed: 1.0068s/iter; left time: 9809.0306s
	iters: 600, epoch: 2 | loss: 0.2936280
	speed: 0.9855s/iter; left time: 9503.6123s
	iters: 700, epoch: 2 | loss: 0.2740718
	speed: 1.0087s/iter; left time: 9625.9844s
	iters: 800, epoch: 2 | loss: 0.2559222
	speed: 1.0294s/iter; left time: 9720.9002s
	iters: 900, epoch: 2 | loss: 0.2721949
	speed: 1.0151s/iter; left time: 9483.8441s
	iters: 1000, epoch: 2 | loss: 0.2432500
	speed: 1.0197s/iter; left time: 9424.6973s
	iters: 1100, epoch: 2 | loss: 0.2609546
	speed: 1.0176s/iter; left time: 9303.6039s
Epoch: 2 cost time: 1149.1916365623474
Epoch: 2, Steps: 1138 | Train Loss: 0.2630409 Vali Loss: 0.1698362 Test Loss: 0.1917092
Validation loss decreased (0.171161 --> 0.169836).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3024015
	speed: 4.6500s/iter; left time: 41873.6225s
	iters: 200, epoch: 3 | loss: 0.2493233
	speed: 1.0273s/iter; left time: 9148.1538s
	iters: 300, epoch: 3 | loss: 0.2420976
	speed: 1.0632s/iter; left time: 9361.7355s
	iters: 400, epoch: 3 | loss: 0.2294215
	speed: 1.0500s/iter; left time: 9140.4963s
	iters: 500, epoch: 3 | loss: 0.2523934
	speed: 1.0513s/iter; left time: 9046.2949s
	iters: 600, epoch: 3 | loss: 0.2523111
	speed: 1.0916s/iter; left time: 9283.9814s
	iters: 700, epoch: 3 | loss: 0.2052111
	speed: 1.0371s/iter; left time: 8717.0695s
	iters: 800, epoch: 3 | loss: 0.2612605
	speed: 1.0453s/iter; left time: 8680.8724s
	iters: 900, epoch: 3 | loss: 0.2547417
	speed: 1.0732s/iter; left time: 8805.5814s
	iters: 1000, epoch: 3 | loss: 0.2862217
	speed: 1.1122s/iter; left time: 9014.5187s
	iters: 1100, epoch: 3 | loss: 0.2526117
	speed: 1.0722s/iter; left time: 8582.8953s
Epoch: 3 cost time: 1190.7797746658325
Epoch: 3, Steps: 1138 | Train Loss: 0.2566907 Vali Loss: 0.1638151 Test Loss: 0.1849243
Validation loss decreased (0.169836 --> 0.163815).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2365935
	speed: 5.1024s/iter; left time: 40140.2865s
	iters: 200, epoch: 4 | loss: 0.3094766
	speed: 1.1123s/iter; left time: 8639.2332s
	iters: 300, epoch: 4 | loss: 0.2579766
	speed: 1.0939s/iter; left time: 8386.6905s
	iters: 400, epoch: 4 | loss: 0.2788067
	speed: 1.0963s/iter; left time: 8296.0593s
	iters: 500, epoch: 4 | loss: 0.2332705
	speed: 1.1455s/iter; left time: 8553.5766s
	iters: 600, epoch: 4 | loss: 0.2753772
	speed: 1.1009s/iter; left time: 8110.1121s
	iters: 700, epoch: 4 | loss: 0.2096881
	speed: 1.1037s/iter; left time: 8020.4130s
	iters: 800, epoch: 4 | loss: 0.2363436
	speed: 1.1722s/iter; left time: 8401.1890s
	iters: 900, epoch: 4 | loss: 0.2387818
	speed: 1.1158s/iter; left time: 7885.3916s
	iters: 1000, epoch: 4 | loss: 0.2788940
	speed: 1.0778s/iter; left time: 7508.8141s
	iters: 1100, epoch: 4 | loss: 0.2972297
	speed: 1.1157s/iter; left time: 7661.5615s
Epoch: 4 cost time: 1259.2833399772644
Epoch: 4, Steps: 1138 | Train Loss: 0.2541885 Vali Loss: 0.1615494 Test Loss: 0.1821232
Validation loss decreased (0.163815 --> 0.161549).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2172142
	speed: 6.6298s/iter; left time: 44612.2483s
	iters: 200, epoch: 5 | loss: 0.2827279
	speed: 0.9393s/iter; left time: 6226.8763s
	iters: 300, epoch: 5 | loss: 0.2537742
	speed: 1.0193s/iter; left time: 6655.2738s
	iters: 400, epoch: 5 | loss: 0.2080498
	speed: 1.0790s/iter; left time: 6936.7072s
	iters: 500, epoch: 5 | loss: 0.2376799
	speed: 1.0934s/iter; left time: 6920.4206s
	iters: 600, epoch: 5 | loss: 0.2590806
	speed: 1.1190s/iter; left time: 6970.2362s
	iters: 700, epoch: 5 | loss: 0.2817541
	speed: 1.0874s/iter; left time: 6664.9350s
	iters: 800, epoch: 5 | loss: 0.2485845
	speed: 1.0883s/iter; left time: 6561.5212s
	iters: 900, epoch: 5 | loss: 0.2933330
	speed: 1.0913s/iter; left time: 6470.4398s
	iters: 1000, epoch: 5 | loss: 0.2556540
	speed: 1.1482s/iter; left time: 6692.9076s
	iters: 1100, epoch: 5 | loss: 0.2763646
	speed: 1.0444s/iter; left time: 5983.2660s
Epoch: 5 cost time: 1207.5453634262085
Epoch: 5, Steps: 1138 | Train Loss: 0.2529128 Vali Loss: 0.1618639 Test Loss: 0.1825097
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2305833
	speed: 5.5607s/iter; left time: 31089.9388s
	iters: 200, epoch: 6 | loss: 0.3217486
	speed: 0.7832s/iter; left time: 4300.4702s
	iters: 300, epoch: 6 | loss: 0.2305677
	speed: 0.8971s/iter; left time: 4836.1053s
	iters: 400, epoch: 6 | loss: 0.2393591
	speed: 0.7751s/iter; left time: 4101.0692s
	iters: 500, epoch: 6 | loss: 0.2547517
	speed: 0.9251s/iter; left time: 4802.3544s
	iters: 600, epoch: 6 | loss: 0.2893377
	speed: 459.9941s/iter; left time: 2341830.0562s
	iters: 700, epoch: 6 | loss: 0.2795918
	speed: 0.8984s/iter; left time: 4483.9074s
	iters: 800, epoch: 6 | loss: 0.2578875
	speed: 0.8650s/iter; left time: 4230.5073s
	iters: 900, epoch: 6 | loss: 0.2807532
	speed: 0.7640s/iter; left time: 3660.1509s
	iters: 1000, epoch: 6 | loss: 0.2226750
	speed: 0.7867s/iter; left time: 3690.2831s
	iters: 1100, epoch: 6 | loss: 0.2829552
	speed: 0.8177s/iter; left time: 3754.0026s
Epoch: 6 cost time: 46854.87359857559
Epoch: 6, Steps: 1138 | Train Loss: 0.2521642 Vali Loss: 0.1607279 Test Loss: 0.1820680
Validation loss decreased (0.161549 --> 0.160728).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2672493
	speed: 4.3121s/iter; left time: 19201.6123s
	iters: 200, epoch: 7 | loss: 0.2443756
	speed: 0.6268s/iter; left time: 2728.3713s
	iters: 300, epoch: 7 | loss: 0.2496679
	speed: 0.6112s/iter; left time: 2599.2231s
	iters: 400, epoch: 7 | loss: 0.2623163
	speed: 0.6401s/iter; left time: 2658.4963s
	iters: 500, epoch: 7 | loss: 0.2646416
	speed: 0.7127s/iter; left time: 2888.4195s
	iters: 600, epoch: 7 | loss: 0.2670830
	speed: 0.8272s/iter; left time: 3269.9683s
	iters: 700, epoch: 7 | loss: 0.2488142
	speed: 0.7960s/iter; left time: 3066.9620s
	iters: 800, epoch: 7 | loss: 0.2470738
	speed: 0.8574s/iter; left time: 3217.8584s
	iters: 900, epoch: 7 | loss: 0.2260246
	speed: 0.8279s/iter; left time: 3024.1955s
	iters: 1000, epoch: 7 | loss: 0.2434375
	speed: 0.8021s/iter; left time: 2850.0268s
	iters: 1100, epoch: 7 | loss: 0.2398670
	speed: 0.8606s/iter; left time: 2971.7183s
Epoch: 7 cost time: 855.1850612163544
Epoch: 7, Steps: 1138 | Train Loss: 0.2518138 Vali Loss: 0.1606014 Test Loss: 0.1814885
Validation loss decreased (0.160728 --> 0.160601).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3001954
	speed: 4.5746s/iter; left time: 15164.8213s
	iters: 200, epoch: 8 | loss: 0.2577727
	speed: 0.6330s/iter; left time: 2035.0952s
	iters: 300, epoch: 8 | loss: 0.2410679
	speed: 0.6646s/iter; left time: 2070.2056s
	iters: 400, epoch: 8 | loss: 0.2562441
	speed: 0.6670s/iter; left time: 2010.8894s
	iters: 500, epoch: 8 | loss: 0.2461948
	speed: 0.7601s/iter; left time: 2215.6043s
	iters: 600, epoch: 8 | loss: 0.2630797
	speed: 0.8438s/iter; left time: 2375.2795s
	iters: 700, epoch: 8 | loss: 0.2065071
	speed: 0.8205s/iter; left time: 2227.5937s
	iters: 800, epoch: 8 | loss: 0.2293669
	speed: 0.8054s/iter; left time: 2106.0767s
	iters: 900, epoch: 8 | loss: 0.2633235
	speed: 0.8016s/iter; left time: 2016.1306s
	iters: 1000, epoch: 8 | loss: 0.2333400
	speed: 0.8514s/iter; left time: 2056.0863s
	iters: 1100, epoch: 8 | loss: 0.2458429
	speed: 0.8072s/iter; left time: 1868.7537s
Epoch: 8 cost time: 872.7126412391663
Epoch: 8, Steps: 1138 | Train Loss: 0.2515355 Vali Loss: 0.1604166 Test Loss: 0.1814463
Validation loss decreased (0.160601 --> 0.160417).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2429704
	speed: 4.2376s/iter; left time: 9225.2328s
	iters: 200, epoch: 9 | loss: 0.2342912
	speed: 0.6925s/iter; left time: 1438.2890s
	iters: 300, epoch: 9 | loss: 0.2823254
	speed: 0.7033s/iter; left time: 1390.4854s
	iters: 400, epoch: 9 | loss: 0.2568621
	speed: 0.7008s/iter; left time: 1315.4605s
	iters: 500, epoch: 9 | loss: 0.2554591
	speed: 0.6624s/iter; left time: 1177.1148s
	iters: 600, epoch: 9 | loss: 0.2600431
	speed: 0.8007s/iter; left time: 1342.7931s
	iters: 700, epoch: 9 | loss: 0.2830324
	speed: 0.7993s/iter; left time: 1260.5553s
	iters: 800, epoch: 9 | loss: 0.2414243
	speed: 0.8109s/iter; left time: 1197.6345s
	iters: 900, epoch: 9 | loss: 0.2438145
	speed: 0.8471s/iter; left time: 1166.4539s
	iters: 1000, epoch: 9 | loss: 0.2338126
	speed: 0.7989s/iter; left time: 1020.1411s
	iters: 1100, epoch: 9 | loss: 0.2483000
	speed: 0.8027s/iter; left time: 944.7911s
Epoch: 9 cost time: 872.8036916255951
Epoch: 9, Steps: 1138 | Train Loss: 0.2514853 Vali Loss: 0.1602599 Test Loss: 0.1813346
Validation loss decreased (0.160417 --> 0.160260).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2491096
	speed: 4.1484s/iter; left time: 4310.2250s
	iters: 200, epoch: 10 | loss: 0.2784608
	speed: 0.7361s/iter; left time: 691.2059s
	iters: 300, epoch: 10 | loss: 0.2445376
	speed: 0.6895s/iter; left time: 578.5120s
	iters: 400, epoch: 10 | loss: 0.2405085
	speed: 0.6810s/iter; left time: 503.2742s
	iters: 500, epoch: 10 | loss: 0.2388920
	speed: 0.6979s/iter; left time: 445.9800s
	iters: 600, epoch: 10 | loss: 0.2513873
	speed: 0.8008s/iter; left time: 431.6556s
	iters: 700, epoch: 10 | loss: 0.2473519
	speed: 0.7917s/iter; left time: 347.5451s
	iters: 800, epoch: 10 | loss: 0.2322849
	speed: 0.8050s/iter; left time: 272.8792s
	iters: 900, epoch: 10 | loss: 0.2340852
	speed: 0.8047s/iter; left time: 192.3312s
	iters: 1000, epoch: 10 | loss: 0.2429907
	speed: 0.8548s/iter; left time: 118.8224s
	iters: 1100, epoch: 10 | loss: 0.2397758
	speed: 0.8219s/iter; left time: 32.0525s
Epoch: 10 cost time: 878.8292515277863
Epoch: 10, Steps: 1138 | Train Loss: 0.2514178 Vali Loss: 0.1602501 Test Loss: 0.1813070
Validation loss decreased (0.160260 --> 0.160250).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_96_PatchTST_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 1, 96, 321) (5165, 1, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.18130722641944885, mae:0.2704026401042938
