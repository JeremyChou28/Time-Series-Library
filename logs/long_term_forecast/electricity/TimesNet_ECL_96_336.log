Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_336          Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ../iTransformer_datasets/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_336_TimesNet_custom_ftM_sl96_ll48_pl336_dm256_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3098500
	speed: 6.3401s/iter; left time: 34940.0671s
	iters: 200, epoch: 1 | loss: 0.2600197
	speed: 6.4389s/iter; left time: 34840.8153s
	iters: 300, epoch: 1 | loss: 0.2900566
	speed: 6.6986s/iter; left time: 35576.2747s
	iters: 400, epoch: 1 | loss: 0.2583205
	speed: 6.2864s/iter; left time: 32758.5491s
	iters: 500, epoch: 1 | loss: 0.2503878
	speed: 5.3465s/iter; left time: 27325.8907s
Epoch: 1 cost time: 3400.0480964183807
Epoch: 1, Steps: 561 | Train Loss: 0.2878874 Vali Loss: 0.2007880 Test Loss: 0.2366259
Validation loss decreased (inf --> 0.200788).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1975197
	speed: 25.7913s/iter; left time: 127667.0715s
	iters: 200, epoch: 2 | loss: 0.1830609
	speed: 6.0591s/iter; left time: 29386.4621s
	iters: 300, epoch: 2 | loss: 0.2107709
	speed: 5.8482s/iter; left time: 27779.1496s
	iters: 400, epoch: 2 | loss: 0.1865439
	speed: 6.2692s/iter; left time: 29151.6661s
	iters: 500, epoch: 2 | loss: 0.1856081
	speed: 6.5960s/iter; left time: 30011.7513s
Epoch: 2 cost time: 3352.2826340198517
Epoch: 2, Steps: 561 | Train Loss: 0.1997123 Vali Loss: 0.1726025 Test Loss: 0.2036364
Validation loss decreased (0.200788 --> 0.172602).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1833339
	speed: 511.3117s/iter; left time: 2244147.1008s
	iters: 200, epoch: 3 | loss: 0.1730990
	speed: 5.5349s/iter; left time: 23739.3741s
	iters: 300, epoch: 3 | loss: 0.1807606
	speed: 5.7627s/iter; left time: 24140.1010s
	iters: 400, epoch: 3 | loss: 0.1873537
	speed: 5.6549s/iter; left time: 23123.0006s
	iters: 500, epoch: 3 | loss: 0.1828052
	speed: 5.7546s/iter; left time: 22954.9833s
Epoch: 3 cost time: 3222.359475135803
Epoch: 3, Steps: 561 | Train Loss: 0.1697536 Vali Loss: 0.1724479 Test Loss: 0.2046260
Validation loss decreased (0.172602 --> 0.172448).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1435720
	speed: 59.3045s/iter; left time: 227017.4733s
	iters: 200, epoch: 4 | loss: 0.1664625
	speed: 6.8693s/iter; left time: 25608.8854s
	iters: 300, epoch: 4 | loss: 0.1435387
	speed: 7.2700s/iter; left time: 26375.6681s
	iters: 400, epoch: 4 | loss: 0.1468879
	speed: 6.7614s/iter; left time: 23854.3365s
	iters: 500, epoch: 4 | loss: 0.1578341
	speed: 6.7059s/iter; left time: 22987.9594s
Epoch: 4 cost time: 3903.1802654266357
Epoch: 4, Steps: 561 | Train Loss: 0.1520508 Vali Loss: 0.1779844 Test Loss: 0.1994077
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1558168
	speed: 57.9889s/iter; left time: 189449.6459s
	iters: 200, epoch: 5 | loss: 0.1531482
	speed: 6.1365s/iter; left time: 19434.1838s
	iters: 300, epoch: 5 | loss: 0.1336447
	speed: 5.9492s/iter; left time: 18246.3026s
	iters: 400, epoch: 5 | loss: 0.1491704
	speed: 5.7342s/iter; left time: 17013.4984s
	iters: 500, epoch: 5 | loss: 0.1425301
	speed: 5.7210s/iter; left time: 16402.1518s
Epoch: 5 cost time: 3320.620428085327
Epoch: 5, Steps: 561 | Train Loss: 0.1429442 Vali Loss: 0.1775580 Test Loss: 0.1978870
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1342050
	speed: 54.9040s/iter; left time: 148570.2331s
	iters: 200, epoch: 6 | loss: 0.1345765
	speed: 5.8177s/iter; left time: 15161.0306s
	iters: 300, epoch: 6 | loss: 0.1378213
	speed: 5.7085s/iter; left time: 14305.5208s
	iters: 400, epoch: 6 | loss: 0.1413852
	speed: 5.6624s/iter; left time: 13623.7273s
	iters: 500, epoch: 6 | loss: 0.1327463
	speed: 5.6338s/iter; left time: 12991.6399s
Epoch: 6 cost time: 3214.183162689209
Epoch: 6, Steps: 561 | Train Loss: 0.1388215 Vali Loss: 0.1778537 Test Loss: 0.2005646
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ECL_96_336_TimesNet_custom_ftM_sl96_ll48_pl336_dm256_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 1, 336, 321) (4925, 1, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.20462600886821747, mae:0.3066430389881134
