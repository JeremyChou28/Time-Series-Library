Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_192      Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ../iTransformer_datasets/traffic/
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_192_PatchTST_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4698465
	speed: 0.1213s/iter; left time: 3624.5540s
	iters: 200, epoch: 1 | loss: 0.5171868
	speed: 0.0908s/iter; left time: 2705.5029s
	iters: 300, epoch: 1 | loss: 0.4200378
	speed: 0.0913s/iter; left time: 2709.3413s
	iters: 400, epoch: 1 | loss: 0.4636291
	speed: 0.0915s/iter; left time: 2707.3322s
	iters: 500, epoch: 1 | loss: 0.3785929
	speed: 0.0949s/iter; left time: 2797.3453s
	iters: 600, epoch: 1 | loss: 0.3859333
	speed: 0.0987s/iter; left time: 2901.1978s
	iters: 700, epoch: 1 | loss: 0.4468914
	speed: 0.2052s/iter; left time: 6008.0975s
	iters: 800, epoch: 1 | loss: 0.4152568
	speed: 0.2370s/iter; left time: 6916.9645s
	iters: 900, epoch: 1 | loss: 0.3984301
	speed: 0.2710s/iter; left time: 7881.8592s
	iters: 1000, epoch: 1 | loss: 0.4248071
	speed: 0.2924s/iter; left time: 8473.8149s
	iters: 1100, epoch: 1 | loss: 0.4209314
	speed: 0.2966s/iter; left time: 8566.2704s
	iters: 1200, epoch: 1 | loss: 0.4172502
	speed: 0.2938s/iter; left time: 8454.7070s
	iters: 1300, epoch: 1 | loss: 0.3867762
	speed: 0.3077s/iter; left time: 8824.5315s
	iters: 1400, epoch: 1 | loss: 0.3684798
	speed: 0.3240s/iter; left time: 9259.9851s
	iters: 1500, epoch: 1 | loss: 0.3397392
	speed: 0.3228s/iter; left time: 9194.9280s
	iters: 1600, epoch: 1 | loss: 0.4065124
	speed: 0.3235s/iter; left time: 9181.5527s
	iters: 1700, epoch: 1 | loss: 0.3310609
	speed: 0.3185s/iter; left time: 9006.2673s
	iters: 1800, epoch: 1 | loss: 0.3996852
	speed: 0.3233s/iter; left time: 9111.1109s
	iters: 1900, epoch: 1 | loss: 0.3890682
	speed: 0.3412s/iter; left time: 9580.5161s
	iters: 2000, epoch: 1 | loss: 0.3723655
	speed: 0.3792s/iter; left time: 10610.0598s
	iters: 2100, epoch: 1 | loss: 0.3635467
	speed: 0.3593s/iter; left time: 10018.3351s
	iters: 2200, epoch: 1 | loss: 0.3877937
	speed: 0.3224s/iter; left time: 8956.0631s
	iters: 2300, epoch: 1 | loss: 0.3999372
	speed: 0.3182s/iter; left time: 8806.9160s
	iters: 2400, epoch: 1 | loss: 0.3826932
	speed: 0.3255s/iter; left time: 8977.8941s
	iters: 2500, epoch: 1 | loss: 0.4538578
	speed: 0.3336s/iter; left time: 9166.8656s
	iters: 2600, epoch: 1 | loss: 0.3458800
	speed: 0.3140s/iter; left time: 8598.5738s
	iters: 2700, epoch: 1 | loss: 0.3199072
	speed: 0.3082s/iter; left time: 8407.8815s
	iters: 2800, epoch: 1 | loss: 0.3789651
	speed: 0.3069s/iter; left time: 8341.1563s
	iters: 2900, epoch: 1 | loss: 0.3680121
	speed: 0.3176s/iter; left time: 8599.6478s
Epoch: 1 cost time: 803.6016738414764
Epoch: 1, Steps: 2998 | Train Loss: 0.4184818 Vali Loss: 0.4396913 Test Loss: 0.5226520
Validation loss decreased (inf --> 0.439691).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3527052
	speed: 2.1421s/iter; left time: 57585.7356s
	iters: 200, epoch: 2 | loss: 0.3770699
	speed: 0.3048s/iter; left time: 8162.4134s
	iters: 300, epoch: 2 | loss: 0.4324455
	speed: 0.2770s/iter; left time: 7392.0193s
	iters: 400, epoch: 2 | loss: 0.3989642
	speed: 0.2723s/iter; left time: 7238.9112s
	iters: 500, epoch: 2 | loss: 0.4016579
	speed: 0.2881s/iter; left time: 7630.1343s
	iters: 600, epoch: 2 | loss: 0.3590615
	speed: 0.2849s/iter; left time: 7517.0155s
	iters: 700, epoch: 2 | loss: 0.4396911
	speed: 0.3649s/iter; left time: 9590.2274s
	iters: 800, epoch: 2 | loss: 0.4350455
	speed: 0.3520s/iter; left time: 9216.3357s
	iters: 900, epoch: 2 | loss: 0.3794248
	speed: 0.3386s/iter; left time: 8832.6425s
	iters: 1000, epoch: 2 | loss: 0.3602889
	speed: 0.3866s/iter; left time: 10044.1498s
	iters: 1100, epoch: 2 | loss: 0.3376346
	speed: 0.3438s/iter; left time: 8899.3958s
	iters: 1200, epoch: 2 | loss: 0.3407316
	speed: 0.3326s/iter; left time: 8574.6511s
	iters: 1300, epoch: 2 | loss: 0.3579230
	speed: 0.3173s/iter; left time: 8148.6426s
	iters: 1400, epoch: 2 | loss: 0.3561130
	speed: 0.3141s/iter; left time: 8036.2458s
	iters: 1500, epoch: 2 | loss: 0.3823335
	speed: 0.3191s/iter; left time: 8131.5873s
	iters: 1600, epoch: 2 | loss: 0.3827897
	speed: 0.3263s/iter; left time: 8282.0150s
	iters: 1700, epoch: 2 | loss: 0.3544095
	speed: 0.3152s/iter; left time: 7969.7818s
	iters: 1800, epoch: 2 | loss: 0.3583182
	speed: 0.3112s/iter; left time: 7837.7439s
	iters: 1900, epoch: 2 | loss: 0.3039275
	speed: 0.3139s/iter; left time: 7872.9239s
	iters: 2000, epoch: 2 | loss: 0.3192276
	speed: 0.3111s/iter; left time: 7772.0820s
	iters: 2100, epoch: 2 | loss: 0.3350352
	speed: 0.3142s/iter; left time: 7818.6596s
	iters: 2200, epoch: 2 | loss: 0.3778138
	speed: 0.3597s/iter; left time: 8913.2959s
	iters: 2300, epoch: 2 | loss: 0.3364434
	speed: 0.3670s/iter; left time: 9058.7941s
	iters: 2400, epoch: 2 | loss: 0.3247061
	speed: 0.3293s/iter; left time: 8095.9766s
	iters: 2500, epoch: 2 | loss: 0.3841431
	speed: 0.3167s/iter; left time: 7753.4144s
	iters: 2600, epoch: 2 | loss: 0.3723762
	speed: 0.3138s/iter; left time: 7652.2626s
	iters: 2700, epoch: 2 | loss: 0.3307255
	speed: 0.3083s/iter; left time: 7485.6042s
	iters: 2800, epoch: 2 | loss: 0.3307016
	speed: 0.3095s/iter; left time: 7485.1663s
	iters: 2900, epoch: 2 | loss: 0.3209022
	speed: 0.3117s/iter; left time: 7506.6792s
Epoch: 2 cost time: 964.3018307685852
Epoch: 2, Steps: 2998 | Train Loss: 0.3691938 Vali Loss: 0.4116102 Test Loss: 0.4871908
Validation loss decreased (0.439691 --> 0.411610).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3869360
	speed: 2.1530s/iter; left time: 51424.6753s
	iters: 200, epoch: 3 | loss: 0.3218883
	speed: 0.3116s/iter; left time: 7412.2815s
	iters: 300, epoch: 3 | loss: 0.3335305
	speed: 0.2749s/iter; left time: 6510.3844s
	iters: 400, epoch: 3 | loss: 0.3894915
	speed: 0.2654s/iter; left time: 6258.6321s
	iters: 500, epoch: 3 | loss: 0.3766352
	speed: 0.2706s/iter; left time: 6354.9378s
	iters: 600, epoch: 3 | loss: 0.3514853
	speed: 0.2856s/iter; left time: 6678.9827s
	iters: 700, epoch: 3 | loss: 0.4719836
	speed: 0.3276s/iter; left time: 7629.0314s
	iters: 800, epoch: 3 | loss: 0.3108740
	speed: 0.3194s/iter; left time: 7405.8244s
	iters: 900, epoch: 3 | loss: 0.3259628
	speed: 0.3140s/iter; left time: 7249.2608s
	iters: 1000, epoch: 3 | loss: 0.3421156
	speed: 0.3094s/iter; left time: 7111.0741s
	iters: 1100, epoch: 3 | loss: 0.3357610
	speed: 0.3095s/iter; left time: 7082.4113s
	iters: 1200, epoch: 3 | loss: 0.4284526
	speed: 0.3211s/iter; left time: 7316.7414s
	iters: 1300, epoch: 3 | loss: 0.3503551
	speed: 0.3578s/iter; left time: 8115.8489s
	iters: 1400, epoch: 3 | loss: 0.3706228
	speed: 0.3384s/iter; left time: 7642.6886s
	iters: 1500, epoch: 3 | loss: 0.3206607
	speed: 0.3170s/iter; left time: 7126.9961s
	iters: 1600, epoch: 3 | loss: 0.3692859
	speed: 0.3171s/iter; left time: 7098.8294s
	iters: 1700, epoch: 3 | loss: 0.3828506
	speed: 0.3090s/iter; left time: 6885.9024s
	iters: 1800, epoch: 3 | loss: 0.3410407
	speed: 0.3271s/iter; left time: 7256.5703s
	iters: 1900, epoch: 3 | loss: 0.4005861
	speed: 0.3298s/iter; left time: 7283.4248s
	iters: 2000, epoch: 3 | loss: 0.3109924
	speed: 0.3207s/iter; left time: 7049.8616s
	iters: 2100, epoch: 3 | loss: 0.3337406
	speed: 0.3150s/iter; left time: 6893.5134s
	iters: 2200, epoch: 3 | loss: 0.3863931
	speed: 0.3075s/iter; left time: 6698.3690s
	iters: 2300, epoch: 3 | loss: 0.3302483
	speed: 0.3109s/iter; left time: 6742.0060s
	iters: 2400, epoch: 3 | loss: 0.3130002
	speed: 0.3286s/iter; left time: 7092.0458s
	iters: 2500, epoch: 3 | loss: 0.3369377
	speed: 0.3663s/iter; left time: 7870.3324s
	iters: 2600, epoch: 3 | loss: 0.3509230
	speed: 0.3385s/iter; left time: 7237.8023s
	iters: 2700, epoch: 3 | loss: 0.4448128
	speed: 0.3295s/iter; left time: 7013.3988s
	iters: 2800, epoch: 3 | loss: 0.3485721
	speed: 0.3199s/iter; left time: 6776.3514s
	iters: 2900, epoch: 3 | loss: 0.4168518
	speed: 0.3186s/iter; left time: 6717.9136s
Epoch: 3 cost time: 952.5403027534485
Epoch: 3, Steps: 2998 | Train Loss: 0.3558682 Vali Loss: 0.4038021 Test Loss: 0.4760240
Validation loss decreased (0.411610 --> 0.403802).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3671809
	speed: 2.0505s/iter; left time: 42828.8249s
	iters: 200, epoch: 4 | loss: 0.3361323
	speed: 0.3090s/iter; left time: 6423.6801s
	iters: 300, epoch: 4 | loss: 0.3648135
	speed: 0.3118s/iter; left time: 6450.1566s
	iters: 400, epoch: 4 | loss: 0.3968182
	speed: 0.3081s/iter; left time: 6342.5172s
	iters: 500, epoch: 4 | loss: 0.3134031
	speed: 0.2827s/iter; left time: 5791.2213s
	iters: 600, epoch: 4 | loss: 0.3133557
	speed: 0.2158s/iter; left time: 4399.0922s
	iters: 700, epoch: 4 | loss: 0.3449398
	speed: 0.2150s/iter; left time: 4360.8703s
	iters: 800, epoch: 4 | loss: 0.3307779
	speed: 0.3179s/iter; left time: 6417.7680s
	iters: 900, epoch: 4 | loss: 0.3615991
	speed: 0.3097s/iter; left time: 6221.4492s
	iters: 1000, epoch: 4 | loss: 0.3215220
	speed: 0.3086s/iter; left time: 6168.5545s
	iters: 1100, epoch: 4 | loss: 0.4395883
	speed: 0.3132s/iter; left time: 6229.1429s
	iters: 1200, epoch: 4 | loss: 0.3888988
	speed: 0.3124s/iter; left time: 6181.0703s
	iters: 1300, epoch: 4 | loss: 0.3426908
	speed: 0.3126s/iter; left time: 6153.5797s
	iters: 1400, epoch: 4 | loss: 0.3709387
	speed: 0.3114s/iter; left time: 6100.2456s
	iters: 1500, epoch: 4 | loss: 0.3272912
	speed: 0.3126s/iter; left time: 6092.2709s
	iters: 1600, epoch: 4 | loss: 0.3964784
	speed: 0.3514s/iter; left time: 6812.8236s
	iters: 1700, epoch: 4 | loss: 0.3487867
	speed: 0.3935s/iter; left time: 7589.0842s
	iters: 1800, epoch: 4 | loss: 0.3288054
	speed: 0.3987s/iter; left time: 7650.5763s
	iters: 1900, epoch: 4 | loss: 0.3763530
	speed: 0.3799s/iter; left time: 7250.9740s
	iters: 2000, epoch: 4 | loss: 0.2962645
	speed: 0.3573s/iter; left time: 6784.3598s
	iters: 2100, epoch: 4 | loss: 0.3077364
	speed: 0.3471s/iter; left time: 6554.8786s
	iters: 2200, epoch: 4 | loss: 0.3350740
	speed: 0.3560s/iter; left time: 6688.6813s
	iters: 2300, epoch: 4 | loss: 0.3690841
	speed: 0.3910s/iter; left time: 7306.2815s
	iters: 2400, epoch: 4 | loss: 0.3286215
	speed: 0.4091s/iter; left time: 7604.0500s
	iters: 2500, epoch: 4 | loss: 0.3242926
	speed: 0.4135s/iter; left time: 7643.5581s
	iters: 2600, epoch: 4 | loss: 0.3198909
	speed: 0.3773s/iter; left time: 6938.1087s
	iters: 2700, epoch: 4 | loss: 0.3570437
	speed: 0.3715s/iter; left time: 6794.1792s
	iters: 2800, epoch: 4 | loss: 0.3595352
	speed: 0.4271s/iter; left time: 7767.9314s
	iters: 2900, epoch: 4 | loss: 0.3336926
	speed: 0.4593s/iter; left time: 8306.6888s
Epoch: 4 cost time: 1035.2395074367523
Epoch: 4, Steps: 2998 | Train Loss: 0.3507894 Vali Loss: 0.3997674 Test Loss: 0.4697134
Validation loss decreased (0.403802 --> 0.399767).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3199283
	speed: 3.3348s/iter; left time: 59657.0984s
	iters: 200, epoch: 5 | loss: 0.3679386
	speed: 0.4583s/iter; left time: 8153.3379s
	iters: 300, epoch: 5 | loss: 0.3076679
	speed: 0.4680s/iter; left time: 8278.7486s
	iters: 400, epoch: 5 | loss: 0.3618528
	speed: 0.4092s/iter; left time: 7197.6373s
	iters: 500, epoch: 5 | loss: 0.3044754
	speed: 0.5067s/iter; left time: 8862.2262s
	iters: 600, epoch: 5 | loss: 0.3464882
	speed: 0.4894s/iter; left time: 8510.1083s
	iters: 700, epoch: 5 | loss: 0.3437626
	speed: 0.4870s/iter; left time: 8419.5982s
	iters: 800, epoch: 5 | loss: 0.3265297
	speed: 0.4719s/iter; left time: 8111.2594s
	iters: 900, epoch: 5 | loss: 0.3161832
	speed: 0.4440s/iter; left time: 7587.3818s
	iters: 1000, epoch: 5 | loss: 0.3421701
	speed: 0.4531s/iter; left time: 7697.7770s
	iters: 1100, epoch: 5 | loss: 0.3597956
	speed: 0.4794s/iter; left time: 8095.9526s
	iters: 1200, epoch: 5 | loss: 0.3054164
	speed: 0.4857s/iter; left time: 8154.1185s
	iters: 1300, epoch: 5 | loss: 0.3321728
	speed: 0.4263s/iter; left time: 7113.7004s
	iters: 1400, epoch: 5 | loss: 0.3882201
	speed: 0.4214s/iter; left time: 6989.9767s
	iters: 1500, epoch: 5 | loss: 0.3747809
	speed: 0.4122s/iter; left time: 6796.7529s
	iters: 1600, epoch: 5 | loss: 0.4001099
	speed: 0.4169s/iter; left time: 6833.2636s
	iters: 1700, epoch: 5 | loss: 0.3171623
	speed: 0.4047s/iter; left time: 6592.3423s
	iters: 1800, epoch: 5 | loss: 0.3200137
	speed: 0.3983s/iter; left time: 6447.5623s
	iters: 1900, epoch: 5 | loss: 0.3462444
	speed: 0.4359s/iter; left time: 7013.4936s
	iters: 2000, epoch: 5 | loss: 0.3317766
	speed: 0.4732s/iter; left time: 7565.9433s
	iters: 2100, epoch: 5 | loss: 0.3910652
	speed: 0.5081s/iter; left time: 8073.6909s
	iters: 2200, epoch: 5 | loss: 0.3802930
	speed: 0.5015s/iter; left time: 7917.8419s
	iters: 2300, epoch: 5 | loss: 0.3110341
	speed: 0.5120s/iter; left time: 8033.5466s
	iters: 2400, epoch: 5 | loss: 0.2963293
	speed: 0.5020s/iter; left time: 7826.4524s
	iters: 2500, epoch: 5 | loss: 0.3640933
	speed: 0.5076s/iter; left time: 7862.2788s
	iters: 2600, epoch: 5 | loss: 0.3080236
	speed: 0.5069s/iter; left time: 7801.4089s
	iters: 2700, epoch: 5 | loss: 0.3096800
	speed: 0.5066s/iter; left time: 7745.7816s
	iters: 2800, epoch: 5 | loss: 0.3484377
	speed: 0.5086s/iter; left time: 7725.4822s
	iters: 2900, epoch: 5 | loss: 0.3822243
	speed: 0.5077s/iter; left time: 7660.0302s
Epoch: 5 cost time: 1406.7557227611542
Epoch: 5, Steps: 2998 | Train Loss: 0.3483381 Vali Loss: 0.3964290 Test Loss: 0.4660347
Validation loss decreased (0.399767 --> 0.396429).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3567907
	speed: 2.8848s/iter; left time: 42957.5220s
	iters: 200, epoch: 6 | loss: 0.3419106
	speed: 0.4364s/iter; left time: 6454.9009s
	iters: 300, epoch: 6 | loss: 0.3237891
	speed: 0.4505s/iter; left time: 6617.5678s
	iters: 400, epoch: 6 | loss: 0.3341741
	speed: 0.4353s/iter; left time: 6352.0306s
	iters: 500, epoch: 6 | loss: 0.3161635
	speed: 0.5082s/iter; left time: 7364.9650s
	iters: 600, epoch: 6 | loss: 0.3433284
	speed: 0.5044s/iter; left time: 7258.8787s
	iters: 700, epoch: 6 | loss: 0.3592367
	speed: 0.4936s/iter; left time: 7053.5520s
	iters: 800, epoch: 6 | loss: 0.3381010
	speed: 0.4814s/iter; left time: 6831.8099s
	iters: 900, epoch: 6 | loss: 0.3279614
	speed: 0.4958s/iter; left time: 6987.0136s
	iters: 1000, epoch: 6 | loss: 0.3322494
	speed: 0.4910s/iter; left time: 6869.8507s
	iters: 1100, epoch: 6 | loss: 0.3822037
	speed: 0.4699s/iter; left time: 6526.8034s
	iters: 1200, epoch: 6 | loss: 0.4139293
	speed: 0.4392s/iter; left time: 6057.5798s
	iters: 1300, epoch: 6 | loss: 0.3591243
	speed: 0.4256s/iter; left time: 5827.1459s
	iters: 1400, epoch: 6 | loss: 0.3428723
	speed: 0.4178s/iter; left time: 5678.4391s
	iters: 1500, epoch: 6 | loss: 0.2947873
	speed: 0.4220s/iter; left time: 5692.9981s
	iters: 1600, epoch: 6 | loss: 0.3157822
	speed: 0.4312s/iter; left time: 5774.6685s
	iters: 1700, epoch: 6 | loss: 0.3810081
	speed: 0.4270s/iter; left time: 5674.8315s
	iters: 1800, epoch: 6 | loss: 0.3244928
	speed: 0.4184s/iter; left time: 5519.0631s
	iters: 1900, epoch: 6 | loss: 0.3148070
	speed: 0.4240s/iter; left time: 5551.0151s
	iters: 2000, epoch: 6 | loss: 0.3571047
	speed: 0.4330s/iter; left time: 5624.8676s
	iters: 2100, epoch: 6 | loss: 0.4025878
	speed: 0.4247s/iter; left time: 5474.3939s
	iters: 2200, epoch: 6 | loss: 0.3540491
	speed: 0.4265s/iter; left time: 5455.8232s
	iters: 2300, epoch: 6 | loss: 0.3532073
	speed: 0.4249s/iter; left time: 5392.7613s
	iters: 2400, epoch: 6 | loss: 0.3615361
	speed: 0.4212s/iter; left time: 5303.2781s
	iters: 2500, epoch: 6 | loss: 0.3403664
	speed: 0.4431s/iter; left time: 5534.9489s
	iters: 2600, epoch: 6 | loss: 0.3006863
	speed: 0.4846s/iter; left time: 6004.7297s
	iters: 2700, epoch: 6 | loss: 0.3513494
	speed: 0.4976s/iter; left time: 6116.0927s
	iters: 2800, epoch: 6 | loss: 0.3648221
	speed: 0.4457s/iter; left time: 5432.9625s
	iters: 2900, epoch: 6 | loss: 0.3066276
	speed: 0.4229s/iter; left time: 5112.7960s
Epoch: 6 cost time: 1347.985337972641
Epoch: 6, Steps: 2998 | Train Loss: 0.3470865 Vali Loss: 0.3960848 Test Loss: 0.4659444
Validation loss decreased (0.396429 --> 0.396085).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3864472
	speed: 2.8830s/iter; left time: 34287.4567s
	iters: 200, epoch: 7 | loss: 0.3281765
	speed: 0.4579s/iter; left time: 5399.7125s
	iters: 300, epoch: 7 | loss: 0.3833616
	speed: 0.4588s/iter; left time: 5364.5051s
	iters: 400, epoch: 7 | loss: 0.3308149
	speed: 0.4394s/iter; left time: 5093.9710s
	iters: 500, epoch: 7 | loss: 0.3416097
	speed: 0.4989s/iter; left time: 5733.8502s
	iters: 600, epoch: 7 | loss: 0.3693186
	speed: 0.5051s/iter; left time: 5754.0594s
	iters: 700, epoch: 7 | loss: 0.3590637
	speed: 0.5128s/iter; left time: 5790.9554s
	iters: 800, epoch: 7 | loss: 0.4217204
	speed: 0.5092s/iter; left time: 5699.9742s
	iters: 900, epoch: 7 | loss: 0.3081478
	speed: 0.4989s/iter; left time: 5534.5559s
	iters: 1000, epoch: 7 | loss: 0.3203942
	speed: 0.4462s/iter; left time: 4904.6830s
	iters: 1100, epoch: 7 | loss: 0.3022654
	speed: 0.4268s/iter; left time: 4649.5862s
	iters: 1200, epoch: 7 | loss: 0.4184368
	speed: 0.4301s/iter; left time: 4642.2852s
	iters: 1300, epoch: 7 | loss: 0.3611599
	speed: 0.4788s/iter; left time: 5119.9419s
	iters: 1400, epoch: 7 | loss: 0.3001162
	speed: 0.4975s/iter; left time: 5270.4257s
	iters: 1500, epoch: 7 | loss: 0.3173791
	speed: 0.4729s/iter; left time: 4962.6481s
	iters: 1600, epoch: 7 | loss: 0.3542903
	speed: 0.4362s/iter; left time: 4533.2402s
	iters: 1700, epoch: 7 | loss: 0.3475360
	speed: 0.4339s/iter; left time: 4465.7968s
	iters: 1800, epoch: 7 | loss: 0.3594883
	speed: 0.4245s/iter; left time: 4326.4280s
	iters: 1900, epoch: 7 | loss: 0.3637536
	speed: 0.4230s/iter; left time: 4269.0919s
	iters: 2000, epoch: 7 | loss: 0.3706844
	speed: 0.4416s/iter; left time: 4412.5369s
	iters: 2100, epoch: 7 | loss: 0.3358665
	speed: 0.4839s/iter; left time: 4787.5377s
	iters: 2200, epoch: 7 | loss: 0.3121741
	speed: 0.4242s/iter; left time: 4153.8649s
	iters: 2300, epoch: 7 | loss: 0.3233585
	speed: 0.4458s/iter; left time: 4320.9917s
	iters: 2400, epoch: 7 | loss: 0.3721409
	speed: 0.4813s/iter; left time: 4616.8239s
	iters: 2500, epoch: 7 | loss: 0.3199671
	speed: 0.5068s/iter; left time: 4810.7636s
	iters: 2600, epoch: 7 | loss: 0.3140752
	speed: 0.5099s/iter; left time: 4789.9047s
	iters: 2700, epoch: 7 | loss: 0.3384853
	speed: 0.4669s/iter; left time: 4339.1169s
	iters: 2800, epoch: 7 | loss: 0.3717939
	speed: 0.4601s/iter; left time: 4230.0764s
	iters: 2900, epoch: 7 | loss: 0.3664190
	speed: 0.4732s/iter; left time: 4302.3706s
Epoch: 7 cost time: 1398.5156891345978
Epoch: 7, Steps: 2998 | Train Loss: 0.3464277 Vali Loss: 0.3962162 Test Loss: 0.4645671
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3829070
	speed: 2.6614s/iter; left time: 23673.2885s
	iters: 200, epoch: 8 | loss: 0.3902688
	speed: 0.4411s/iter; left time: 3879.2424s
	iters: 300, epoch: 8 | loss: 0.2883453
	speed: 0.4492s/iter; left time: 3905.4220s
	iters: 400, epoch: 8 | loss: 0.3963987
	speed: 0.4263s/iter; left time: 3663.8238s
	iters: 500, epoch: 8 | loss: 0.3831824
	speed: 0.4557s/iter; left time: 3870.9818s
	iters: 600, epoch: 8 | loss: 0.3569465
	speed: 0.4271s/iter; left time: 3585.2592s
	iters: 700, epoch: 8 | loss: 0.3359047
	speed: 0.4366s/iter; left time: 3621.9078s
	iters: 800, epoch: 8 | loss: 0.3570060
	speed: 0.4522s/iter; left time: 3705.5594s
	iters: 900, epoch: 8 | loss: 0.3359067
	speed: 0.4538s/iter; left time: 3673.7334s
	iters: 1000, epoch: 8 | loss: 0.3467999
	speed: 0.4413s/iter; left time: 3528.5361s
	iters: 1100, epoch: 8 | loss: 0.3477820
	speed: 0.4264s/iter; left time: 3366.2078s
	iters: 1200, epoch: 8 | loss: 0.3290646
	speed: 0.4199s/iter; left time: 3273.0735s
	iters: 1300, epoch: 8 | loss: 0.3000680
	speed: 0.4346s/iter; left time: 3343.9265s
	iters: 1400, epoch: 8 | loss: 0.3642520
	speed: 0.4463s/iter; left time: 3389.6079s
	iters: 1500, epoch: 8 | loss: 0.3334733
	speed: 0.4497s/iter; left time: 3370.6015s
	iters: 1600, epoch: 8 | loss: 0.3685085
	speed: 0.4524s/iter; left time: 3345.1745s
	iters: 1700, epoch: 8 | loss: 0.3599222
	speed: 0.4700s/iter; left time: 3428.8935s
	iters: 1800, epoch: 8 | loss: 0.3463582
	speed: 0.4910s/iter; left time: 3532.5428s
	iters: 1900, epoch: 8 | loss: 0.3608944
	speed: 0.4979s/iter; left time: 3532.6993s
	iters: 2000, epoch: 8 | loss: 0.3443378
	speed: 0.5073s/iter; left time: 3548.9037s
	iters: 2100, epoch: 8 | loss: 0.3667904
	speed: 0.5112s/iter; left time: 3524.7248s
	iters: 2200, epoch: 8 | loss: 0.3979490
	speed: 0.5105s/iter; left time: 3468.5150s
	iters: 2300, epoch: 8 | loss: 0.3193791
	speed: 0.5061s/iter; left time: 3388.2032s
	iters: 2400, epoch: 8 | loss: 0.3580497
	speed: 0.4653s/iter; left time: 3068.7150s
	iters: 2500, epoch: 8 | loss: 0.3478078
	speed: 0.4351s/iter; left time: 2826.0254s
	iters: 2600, epoch: 8 | loss: 0.3160805
	speed: 0.4330s/iter; left time: 2769.3364s
	iters: 2700, epoch: 8 | loss: 0.3615919
	speed: 0.4524s/iter; left time: 2847.6596s
	iters: 2800, epoch: 8 | loss: 0.3585169
	speed: 0.4247s/iter; left time: 2630.9120s
	iters: 2900, epoch: 8 | loss: 0.4116614
	speed: 0.4088s/iter; left time: 2491.8801s
Epoch: 8 cost time: 1356.9851334095001
Epoch: 8, Steps: 2998 | Train Loss: 0.3460833 Vali Loss: 0.3954647 Test Loss: 0.4648913
Validation loss decreased (0.396085 --> 0.395465).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3738638
	speed: 2.5911s/iter; left time: 15279.4581s
	iters: 200, epoch: 9 | loss: 0.3625831
	speed: 0.4052s/iter; left time: 2348.9170s
	iters: 300, epoch: 9 | loss: 0.3499907
	speed: 0.3968s/iter; left time: 2260.5804s
	iters: 400, epoch: 9 | loss: 0.3732132
	speed: 0.4040s/iter; left time: 2261.1972s
	iters: 500, epoch: 9 | loss: 0.3365228
	speed: 0.4668s/iter; left time: 2566.2290s
	iters: 600, epoch: 9 | loss: 0.3490436
	speed: 0.4572s/iter; left time: 2467.4143s
	iters: 700, epoch: 9 | loss: 0.2991422
	speed: 0.4604s/iter; left time: 2438.6667s
	iters: 800, epoch: 9 | loss: 0.3716379
	speed: 0.4638s/iter; left time: 2410.5040s
	iters: 900, epoch: 9 | loss: 0.2850104
	speed: 0.4821s/iter; left time: 2457.0791s
	iters: 1000, epoch: 9 | loss: 0.3846645
	speed: 0.4752s/iter; left time: 2374.5744s
	iters: 1100, epoch: 9 | loss: 0.3773684
	speed: 0.4736s/iter; left time: 2319.3162s
	iters: 1200, epoch: 9 | loss: 0.3202157
	speed: 0.4749s/iter; left time: 2278.2490s
	iters: 1300, epoch: 9 | loss: 0.3324025
	speed: 0.4790s/iter; left time: 2249.7587s
	iters: 1400, epoch: 9 | loss: 0.3759895
	speed: 0.4834s/iter; left time: 2222.4024s
	iters: 1500, epoch: 9 | loss: 0.3201404
	speed: 0.4899s/iter; left time: 2203.0630s
	iters: 1600, epoch: 9 | loss: 0.3312778
	speed: 0.4901s/iter; left time: 2155.0183s
	iters: 1700, epoch: 9 | loss: 0.3696199
	speed: 0.4892s/iter; left time: 2102.2832s
	iters: 1800, epoch: 9 | loss: 0.3170185
	speed: 0.4893s/iter; left time: 2053.6343s
	iters: 1900, epoch: 9 | loss: 0.3404767
	speed: 0.4929s/iter; left time: 2019.4454s
	iters: 2000, epoch: 9 | loss: 0.3346036
	speed: 0.4848s/iter; left time: 1937.8705s
	iters: 2100, epoch: 9 | loss: 0.4280551
	speed: 0.5002s/iter; left time: 1949.2196s
	iters: 2200, epoch: 9 | loss: 0.3101209
	speed: 0.4954s/iter; left time: 1881.1544s
	iters: 2300, epoch: 9 | loss: 0.3516489
	speed: 0.4477s/iter; left time: 1655.0896s
	iters: 2400, epoch: 9 | loss: 0.3194471
	speed: 0.4470s/iter; left time: 1607.9934s
	iters: 2500, epoch: 9 | loss: 0.3823180
	speed: 0.4641s/iter; left time: 1623.1158s
	iters: 2600, epoch: 9 | loss: 0.3145304
	speed: 0.4641s/iter; left time: 1576.5364s
	iters: 2700, epoch: 9 | loss: 0.3407323
	speed: 0.4505s/iter; left time: 1485.4349s
	iters: 2800, epoch: 9 | loss: 0.3187148
	speed: 0.4524s/iter; left time: 1446.2130s
	iters: 2900, epoch: 9 | loss: 0.3492786
	speed: 0.4601s/iter; left time: 1424.8523s
Epoch: 9 cost time: 1388.1802368164062
Epoch: 9, Steps: 2998 | Train Loss: 0.3459270 Vali Loss: 0.3955017 Test Loss: 0.4646748
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3303901
	speed: 2.5380s/iter; left time: 7357.6089s
	iters: 200, epoch: 10 | loss: 0.4026843
	speed: 0.3671s/iter; left time: 1027.6037s
	iters: 300, epoch: 10 | loss: 0.3029166
	speed: 0.3767s/iter; left time: 1016.6908s
	iters: 400, epoch: 10 | loss: 0.3793037
	speed: 0.3757s/iter; left time: 976.3705s
	iters: 500, epoch: 10 | loss: 0.3068635
	speed: 0.4038s/iter; left time: 1009.2025s
	iters: 600, epoch: 10 | loss: 0.3175896
	speed: 0.4225s/iter; left time: 1013.5683s
	iters: 700, epoch: 10 | loss: 0.3498957
	speed: 0.4579s/iter; left time: 1052.7100s
	iters: 800, epoch: 10 | loss: 0.3163818
	speed: 0.4597s/iter; left time: 1010.7795s
	iters: 900, epoch: 10 | loss: 0.3252877
	speed: 0.4692s/iter; left time: 984.7767s
	iters: 1000, epoch: 10 | loss: 0.4206382
	speed: 0.4676s/iter; left time: 934.6439s
	iters: 1100, epoch: 10 | loss: 0.3410748
	speed: 0.4696s/iter; left time: 891.6756s
	iters: 1200, epoch: 10 | loss: 0.3262698
	speed: 0.4761s/iter; left time: 856.5888s
	iters: 1300, epoch: 10 | loss: 0.3772172
	speed: 0.4823s/iter; left time: 819.3435s
	iters: 1400, epoch: 10 | loss: 0.3765237
	speed: 0.4832s/iter; left time: 772.5793s
	iters: 1500, epoch: 10 | loss: 0.3173229
	speed: 0.4692s/iter; left time: 703.3235s
	iters: 1600, epoch: 10 | loss: 0.3092630
	speed: 0.4341s/iter; left time: 607.2845s
	iters: 1700, epoch: 10 | loss: 0.3053365
	speed: 0.4594s/iter; left time: 596.7543s
	iters: 1800, epoch: 10 | loss: 0.3604935
	speed: 0.4613s/iter; left time: 553.1140s
	iters: 1900, epoch: 10 | loss: 0.3294612
	speed: 0.4632s/iter; left time: 509.0555s
	iters: 2000, epoch: 10 | loss: 0.3465596
	speed: 0.4728s/iter; left time: 472.3476s
	iters: 2100, epoch: 10 | loss: 0.3180225
	speed: 0.4449s/iter; left time: 399.9542s
	iters: 2200, epoch: 10 | loss: 0.3485447
	speed: 0.4400s/iter; left time: 351.5540s
	iters: 2300, epoch: 10 | loss: 0.3087571
	speed: 0.4302s/iter; left time: 300.7150s
	iters: 2400, epoch: 10 | loss: 0.3954127
	speed: 0.4155s/iter; left time: 248.8754s
	iters: 2500, epoch: 10 | loss: 0.3421558
	speed: 0.4464s/iter; left time: 222.7669s
	iters: 2600, epoch: 10 | loss: 0.4035340
	speed: 0.4679s/iter; left time: 186.7042s
	iters: 2700, epoch: 10 | loss: 0.3895924
	speed: 0.4772s/iter; left time: 142.6767s
	iters: 2800, epoch: 10 | loss: 0.2671871
	speed: 0.4903s/iter; left time: 97.5793s
	iters: 2900, epoch: 10 | loss: 0.3613851
	speed: 0.4531s/iter; left time: 44.8603s
Epoch: 10 cost time: 1334.3239073753357
Epoch: 10, Steps: 2998 | Train Loss: 0.3458265 Vali Loss: 0.3955546 Test Loss: 0.4647457
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_192_PatchTST_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 1, 192, 862) (3317, 1, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.4648929834365845, mae:0.29585662484169006
Spend Time: 14678.165162563324
