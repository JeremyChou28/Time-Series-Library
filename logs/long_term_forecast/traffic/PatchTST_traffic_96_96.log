Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_96       Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ../iTransformer_datasets/traffic/
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_96_PatchTST_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5617603
	speed: 1.3737s/iter; left time: 41377.7293s
	iters: 200, epoch: 1 | loss: 0.5493287
	speed: 1.2788s/iter; left time: 38389.8838s
	iters: 300, epoch: 1 | loss: 0.4577546
	speed: 1.2890s/iter; left time: 38568.7109s
	iters: 400, epoch: 1 | loss: 0.4308133
	speed: 1.2911s/iter; left time: 38502.5814s
	iters: 500, epoch: 1 | loss: 0.5343439
	speed: 1.3004s/iter; left time: 38650.5928s
	iters: 600, epoch: 1 | loss: 0.5403639
	speed: 1.6036s/iter; left time: 47500.7247s
	iters: 700, epoch: 1 | loss: 0.4050115
	speed: 1.8090s/iter; left time: 53402.2241s
	iters: 800, epoch: 1 | loss: 0.4739271
	speed: 1.8026s/iter; left time: 53033.7632s
	iters: 900, epoch: 1 | loss: 0.4004103
	speed: 1.6547s/iter; left time: 48517.1458s
	iters: 1000, epoch: 1 | loss: 0.4884421
	speed: 1.7597s/iter; left time: 51419.1963s
	iters: 1100, epoch: 1 | loss: 0.4629287
	speed: 1.5864s/iter; left time: 46197.2052s
	iters: 1200, epoch: 1 | loss: 0.3804754
	speed: 1.7978s/iter; left time: 52174.0936s
	iters: 1300, epoch: 1 | loss: 0.4340542
	speed: 1.7076s/iter; left time: 49385.4694s
	iters: 1400, epoch: 1 | loss: 0.4174254
	speed: 1.6749s/iter; left time: 48272.5028s
	iters: 1500, epoch: 1 | loss: 0.4197904
	speed: 1.8022s/iter; left time: 51760.4847s
	iters: 1600, epoch: 1 | loss: 0.4024741
	speed: 1.6525s/iter; left time: 47295.3736s
	iters: 1700, epoch: 1 | loss: 0.4204491
	speed: 1.5234s/iter; left time: 43448.1033s
	iters: 1800, epoch: 1 | loss: 0.4463618
	speed: 1.5368s/iter; left time: 43676.3486s
	iters: 1900, epoch: 1 | loss: 0.4585691
	speed: 1.7743s/iter; left time: 50248.8388s
	iters: 2000, epoch: 1 | loss: 0.3722438
	speed: 1.7720s/iter; left time: 50008.5881s
	iters: 2100, epoch: 1 | loss: 0.4439396
	speed: 1.7440s/iter; left time: 49044.0772s
	iters: 2200, epoch: 1 | loss: 0.3902430
	speed: 1.4895s/iter; left time: 41736.2263s
	iters: 2300, epoch: 1 | loss: 0.3686668
	speed: 1.4799s/iter; left time: 41321.0757s
	iters: 2400, epoch: 1 | loss: 0.3635657
	speed: 1.5618s/iter; left time: 43449.7762s
	iters: 2500, epoch: 1 | loss: 0.3764051
	speed: 1.7551s/iter; left time: 48653.1400s
	iters: 2600, epoch: 1 | loss: 0.4641581
	speed: 1.6757s/iter; left time: 46285.2978s
	iters: 2700, epoch: 1 | loss: 0.3809306
	speed: 1.6940s/iter; left time: 46620.5104s
	iters: 2800, epoch: 1 | loss: 0.3562192
	speed: 1.7880s/iter; left time: 49027.4905s
	iters: 2900, epoch: 1 | loss: 0.3213061
	speed: 1.6581s/iter; left time: 45301.4178s
	iters: 3000, epoch: 1 | loss: 0.4355150
	speed: 1.4642s/iter; left time: 39858.1730s
Epoch: 1 cost time: 4859.193874835968
Epoch: 1, Steps: 3022 | Train Loss: 0.4353563 Vali Loss: 0.4563736 Test Loss: 0.5241394
Validation loss decreased (inf --> 0.456374).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4465144
	speed: 54.6496s/iter; left time: 1480949.1319s
	iters: 200, epoch: 2 | loss: 0.3714376
	speed: 1.3155s/iter; left time: 35516.4359s
	iters: 300, epoch: 2 | loss: 0.4088546
	speed: 1.3170s/iter; left time: 35425.7991s
	iters: 400, epoch: 2 | loss: 0.3749293
	speed: 1.3263s/iter; left time: 35542.7727s
	iters: 500, epoch: 2 | loss: 0.4491135
	speed: 1.3138s/iter; left time: 35078.4455s
	iters: 600, epoch: 2 | loss: 0.4513898
	speed: 1.3404s/iter; left time: 35652.4761s
	iters: 700, epoch: 2 | loss: 0.3085637
	speed: 1.3376s/iter; left time: 35446.3830s
	iters: 800, epoch: 2 | loss: 0.3960262
	speed: 1.3327s/iter; left time: 35182.2648s
	iters: 900, epoch: 2 | loss: 0.3538177
	speed: 1.2693s/iter; left time: 33382.4319s
	iters: 1000, epoch: 2 | loss: 0.4114244
	speed: 1.2612s/iter; left time: 33041.7548s
	iters: 1100, epoch: 2 | loss: 0.3152741
	speed: 1.2363s/iter; left time: 32266.6528s
	iters: 1200, epoch: 2 | loss: 0.4499435
	speed: 1.2167s/iter; left time: 31634.0947s
	iters: 1300, epoch: 2 | loss: 0.3503284
	speed: 1.2156s/iter; left time: 31482.5160s
	iters: 1400, epoch: 2 | loss: 0.4097286
	speed: 1.2571s/iter; left time: 32432.8156s
	iters: 1500, epoch: 2 | loss: 0.3247954
	speed: 1.2457s/iter; left time: 32012.6019s
	iters: 1600, epoch: 2 | loss: 0.3629975
	speed: 1.2540s/iter; left time: 32100.7726s
	iters: 1700, epoch: 2 | loss: 0.4152563
	speed: 1.2226s/iter; left time: 31174.4321s
	iters: 1800, epoch: 2 | loss: 0.3661519
	speed: 1.1874s/iter; left time: 30157.9185s
	iters: 1900, epoch: 2 | loss: 0.3703928
	speed: 1.1839s/iter; left time: 29951.6257s
	iters: 2000, epoch: 2 | loss: 0.3665394
	speed: 1.1884s/iter; left time: 29945.5706s
	iters: 2100, epoch: 2 | loss: 0.3737784
	speed: 1.2218s/iter; left time: 30666.2949s
	iters: 2200, epoch: 2 | loss: 0.4123694
	speed: 1.2547s/iter; left time: 31366.6255s
	iters: 2300, epoch: 2 | loss: 0.4193301
	speed: 1.2538s/iter; left time: 31218.8437s
	iters: 2400, epoch: 2 | loss: 0.3223817
	speed: 1.2414s/iter; left time: 30785.6709s
	iters: 2500, epoch: 2 | loss: 0.3084095
	speed: 1.2235s/iter; left time: 30218.5896s
	iters: 2600, epoch: 2 | loss: 0.3484371
	speed: 1.2989s/iter; left time: 31951.2745s
	iters: 2700, epoch: 2 | loss: 0.3340510
	speed: 1.2958s/iter; left time: 31745.0645s
	iters: 2800, epoch: 2 | loss: 0.3595926
	speed: 1.2879s/iter; left time: 31424.0405s
	iters: 2900, epoch: 2 | loss: 0.3085707
	speed: 1.2953s/iter; left time: 31474.2171s
	iters: 3000, epoch: 2 | loss: 0.4510119
	speed: 1.2985s/iter; left time: 31421.6670s
Epoch: 2 cost time: 3830.1202034950256
Epoch: 2, Steps: 3022 | Train Loss: 0.3758207 Vali Loss: 0.4251196 Test Loss: 0.4808974
Validation loss decreased (0.456374 --> 0.425120).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3126955
	speed: 50.0729s/iter; left time: 1205604.9737s
	iters: 200, epoch: 3 | loss: 0.4141121
	speed: 1.2954s/iter; left time: 31059.3250s
	iters: 300, epoch: 3 | loss: 0.3454148
	speed: 1.2689s/iter; left time: 30298.1385s
	iters: 400, epoch: 3 | loss: 0.3588311
	speed: 1.2657s/iter; left time: 30094.6962s
	iters: 500, epoch: 3 | loss: 0.4451579
	speed: 1.2742s/iter; left time: 30169.3473s
	iters: 600, epoch: 3 | loss: 0.3951328
	speed: 1.2632s/iter; left time: 29783.0059s
	iters: 700, epoch: 3 | loss: 0.3391262
	speed: 1.2727s/iter; left time: 29880.0408s
	iters: 800, epoch: 3 | loss: 0.3498650
	speed: 1.2671s/iter; left time: 29620.2190s
	iters: 900, epoch: 3 | loss: 0.3558623
	speed: 1.2662s/iter; left time: 29474.1747s
	iters: 1000, epoch: 3 | loss: 0.3420743
	speed: 1.2681s/iter; left time: 29390.8902s
	iters: 1100, epoch: 3 | loss: 0.3814884
	speed: 1.2637s/iter; left time: 29162.2637s
	iters: 1200, epoch: 3 | loss: 0.4080137
	speed: 1.2669s/iter; left time: 29109.7469s
	iters: 1300, epoch: 3 | loss: 0.3664884
	speed: 1.2600s/iter; left time: 28824.8473s
	iters: 1400, epoch: 3 | loss: 0.3657942
	speed: 1.2059s/iter; left time: 27467.8047s
	iters: 1500, epoch: 3 | loss: 0.3413140
	speed: 1.2805s/iter; left time: 29038.4466s
	iters: 1600, epoch: 3 | loss: 0.3052628
	speed: 1.2645s/iter; left time: 28549.2262s
	iters: 1700, epoch: 3 | loss: 0.3734869
	speed: 1.2772s/iter; left time: 28708.1385s
	iters: 1800, epoch: 3 | loss: 0.3211539
	speed: 1.2796s/iter; left time: 28633.0439s
	iters: 1900, epoch: 3 | loss: 0.3743784
	speed: 1.2721s/iter; left time: 28338.3269s
	iters: 2000, epoch: 3 | loss: 0.3729923
	speed: 1.2723s/iter; left time: 28215.6988s
	iters: 2100, epoch: 3 | loss: 0.3559843
	speed: 1.2708s/iter; left time: 28055.2489s
	iters: 2200, epoch: 3 | loss: 0.3251982
	speed: 1.2836s/iter; left time: 28210.2824s
	iters: 2300, epoch: 3 | loss: 0.3820736
	speed: 1.2787s/iter; left time: 27974.3625s
	iters: 2400, epoch: 3 | loss: 0.3575367
	speed: 1.2704s/iter; left time: 27664.5279s
	iters: 2500, epoch: 3 | loss: 0.3039419
	speed: 1.2946s/iter; left time: 28063.5029s
	iters: 2600, epoch: 3 | loss: 0.3311586
	speed: 1.2918s/iter; left time: 27872.9716s
	iters: 2700, epoch: 3 | loss: 0.3954386
	speed: 1.2797s/iter; left time: 27483.3278s
	iters: 2800, epoch: 3 | loss: 0.4563825
	speed: 1.2831s/iter; left time: 27428.5825s
	iters: 2900, epoch: 3 | loss: 0.3580614
	speed: 1.2683s/iter; left time: 26985.2835s
	iters: 3000, epoch: 3 | loss: 0.4446603
	speed: 1.2695s/iter; left time: 26884.3477s
Epoch: 3 cost time: 3846.363493204117
Epoch: 3, Steps: 3022 | Train Loss: 0.3597662 Vali Loss: 0.4160073 Test Loss: 0.4719760
Validation loss decreased (0.425120 --> 0.416007).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3147649
	speed: 49.6574s/iter; left time: 1045536.2978s
	iters: 200, epoch: 4 | loss: 0.3235047
	speed: 1.2808s/iter; left time: 26839.5281s
	iters: 300, epoch: 4 | loss: 0.3728440
	speed: 1.2596s/iter; left time: 26269.2946s
	iters: 400, epoch: 4 | loss: 0.4271378
	speed: 1.2659s/iter; left time: 26273.2226s
	iters: 500, epoch: 4 | loss: 0.3039860
	speed: 1.2643s/iter; left time: 26114.8694s
	iters: 600, epoch: 4 | loss: 0.3095996
	speed: 1.2641s/iter; left time: 25983.8580s
	iters: 700, epoch: 4 | loss: 0.2808506
	speed: 1.2635s/iter; left time: 25845.3400s
	iters: 800, epoch: 4 | loss: 0.4017327
	speed: 1.2713s/iter; left time: 25876.5747s
	iters: 900, epoch: 4 | loss: 0.3422897
	speed: 1.1175s/iter; left time: 22634.0056s
	iters: 1000, epoch: 4 | loss: 0.3263959
	speed: 1.0883s/iter; left time: 21934.8887s
	iters: 1100, epoch: 4 | loss: 0.3059177
	speed: 1.0831s/iter; left time: 21721.7592s
	iters: 1200, epoch: 4 | loss: 0.3011771
	speed: 1.0991s/iter; left time: 21933.0375s
	iters: 1300, epoch: 4 | loss: 0.3167591
	speed: 1.1421s/iter; left time: 22676.6025s
	iters: 1400, epoch: 4 | loss: 0.3111284
	speed: 1.1434s/iter; left time: 22588.1160s
	iters: 1500, epoch: 4 | loss: 0.3397945
	speed: 1.1403s/iter; left time: 22412.3416s
	iters: 1600, epoch: 4 | loss: 0.2946200
	speed: 1.0841s/iter; left time: 21200.2708s
	iters: 1700, epoch: 4 | loss: 0.4338529
	speed: 1.1552s/iter; left time: 22474.5677s
	iters: 1800, epoch: 4 | loss: 0.4120912
	speed: 1.1745s/iter; left time: 22732.8209s
	iters: 1900, epoch: 4 | loss: 0.4105213
	speed: 1.1698s/iter; left time: 22525.3080s
	iters: 2000, epoch: 4 | loss: 0.3351764
	speed: 1.1662s/iter; left time: 22338.9029s
	iters: 2100, epoch: 4 | loss: 0.3248285
	speed: 1.1298s/iter; left time: 21527.6749s
	iters: 2200, epoch: 4 | loss: 0.3025699
	speed: 1.0275s/iter; left time: 19476.1964s
	iters: 2300, epoch: 4 | loss: 0.3626496
	speed: 1.0673s/iter; left time: 20123.9807s
	iters: 2400, epoch: 4 | loss: 0.3277282
	speed: 1.0650s/iter; left time: 19973.5632s
	iters: 2500, epoch: 4 | loss: 0.3272598
	speed: 1.0681s/iter; left time: 19924.7742s
	iters: 2600, epoch: 4 | loss: 0.3343490
	speed: 1.0642s/iter; left time: 19746.1573s
	iters: 2700, epoch: 4 | loss: 0.2623897
	speed: 1.0646s/iter; left time: 19648.0031s
	iters: 2800, epoch: 4 | loss: 0.3086300
	speed: 1.0608s/iter; left time: 19470.5723s
	iters: 2900, epoch: 4 | loss: 0.3332369
	speed: 1.0669s/iter; left time: 19476.6185s
	iters: 3000, epoch: 4 | loss: 0.3259820
	speed: 1.0563s/iter; left time: 19177.2210s
Epoch: 4 cost time: 3463.734559059143
Epoch: 4, Steps: 3022 | Train Loss: 0.3534964 Vali Loss: 0.4110541 Test Loss: 0.4639981
Validation loss decreased (0.416007 --> 0.411054).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3508700
	speed: 40.5497s/iter; left time: 731233.1055s
	iters: 200, epoch: 5 | loss: 0.3357763
	speed: 1.0422s/iter; left time: 18690.6255s
	iters: 300, epoch: 5 | loss: 0.3785314
	speed: 1.0451s/iter; left time: 18637.1900s
	iters: 400, epoch: 5 | loss: 0.3622958
	speed: 1.0254s/iter; left time: 18184.1034s
	iters: 500, epoch: 5 | loss: 0.3584324
	speed: 1.0309s/iter; left time: 18177.3146s
	iters: 600, epoch: 5 | loss: 0.3098860
	speed: 1.0325s/iter; left time: 18102.0574s
	iters: 700, epoch: 5 | loss: 0.3598385
	speed: 0.9348s/iter; left time: 16296.4446s
	iters: 800, epoch: 5 | loss: 0.4241270
	speed: 0.9519s/iter; left time: 16499.3936s
	iters: 900, epoch: 5 | loss: 0.3437241
	speed: 0.9688s/iter; left time: 16695.5274s
	iters: 1000, epoch: 5 | loss: 0.3201581
	speed: 0.9599s/iter; left time: 16446.2083s
	iters: 1100, epoch: 5 | loss: 0.3444810
	speed: 0.9638s/iter; left time: 16416.0096s
	iters: 1200, epoch: 5 | loss: 0.4088154
	speed: 0.9618s/iter; left time: 16286.9127s
	iters: 1300, epoch: 5 | loss: 0.3616412
	speed: 0.9711s/iter; left time: 16347.3423s
	iters: 1400, epoch: 5 | loss: 0.4327879
	speed: 0.9612s/iter; left time: 16083.8902s
	iters: 1500, epoch: 5 | loss: 0.3555770
	speed: 0.9636s/iter; left time: 16027.0515s
	iters: 1600, epoch: 5 | loss: 0.2817795
	speed: 0.9664s/iter; left time: 15977.6839s
	iters: 1700, epoch: 5 | loss: 0.3207309
	speed: 0.9605s/iter; left time: 15783.9812s
	iters: 1800, epoch: 5 | loss: 0.4235461
	speed: 0.9618s/iter; left time: 15708.9964s
	iters: 1900, epoch: 5 | loss: 0.3356125
	speed: 0.9594s/iter; left time: 15573.2128s
	iters: 2000, epoch: 5 | loss: 0.2746783
	speed: 0.9622s/iter; left time: 15522.6988s
	iters: 2100, epoch: 5 | loss: 0.4025444
	speed: 0.9656s/iter; left time: 15482.1992s
	iters: 2200, epoch: 5 | loss: 0.3891768
	speed: 0.9668s/iter; left time: 15403.7949s
	iters: 2300, epoch: 5 | loss: 0.3698088
	speed: 0.9689s/iter; left time: 15340.7778s
	iters: 2400, epoch: 5 | loss: 0.3421858
	speed: 0.9670s/iter; left time: 15213.9785s
	iters: 2500, epoch: 5 | loss: 0.2484080
	speed: 0.9695s/iter; left time: 15156.0597s
	iters: 2600, epoch: 5 | loss: 0.3715671
	speed: 0.9598s/iter; left time: 14909.1531s
	iters: 2700, epoch: 5 | loss: 0.3316664
	speed: 0.9650s/iter; left time: 14892.6727s
	iters: 2800, epoch: 5 | loss: 0.3847140
	speed: 0.9664s/iter; left time: 14817.9546s
	iters: 2900, epoch: 5 | loss: 0.3090487
	speed: 0.9801s/iter; left time: 14930.0055s
	iters: 3000, epoch: 5 | loss: 0.2961667
	speed: 0.9781s/iter; left time: 14802.2047s
Epoch: 5 cost time: 2956.633646249771
Epoch: 5, Steps: 3022 | Train Loss: 0.3504541 Vali Loss: 0.4097996 Test Loss: 0.4617575
Validation loss decreased (0.411054 --> 0.409800).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3148900
	speed: 37.0732s/iter; left time: 556505.9066s
	iters: 200, epoch: 6 | loss: 0.3995366
	speed: 0.9351s/iter; left time: 13943.7941s
	iters: 300, epoch: 6 | loss: 0.4243480
	speed: 0.9337s/iter; left time: 13829.2354s
	iters: 400, epoch: 6 | loss: 0.4467168
	speed: 0.9308s/iter; left time: 13692.5816s
	iters: 500, epoch: 6 | loss: 0.4270504
	speed: 0.9299s/iter; left time: 13587.1577s
	iters: 600, epoch: 6 | loss: 0.3874012
	speed: 0.9320s/iter; left time: 13524.0912s
	iters: 700, epoch: 6 | loss: 0.2994314
	speed: 0.9339s/iter; left time: 13458.9466s
	iters: 800, epoch: 6 | loss: 0.3245138
	speed: 0.9381s/iter; left time: 13425.4937s
	iters: 900, epoch: 6 | loss: 0.3446856
	speed: 0.9278s/iter; left time: 13184.4484s
	iters: 1000, epoch: 6 | loss: 0.3434226
	speed: 0.9337s/iter; left time: 13175.7908s
	iters: 1100, epoch: 6 | loss: 0.4115590
	speed: 0.9224s/iter; left time: 12924.0593s
	iters: 1200, epoch: 6 | loss: 0.4156987
	speed: 0.8116s/iter; left time: 11289.6049s
	iters: 1300, epoch: 6 | loss: 0.4062597
	speed: 0.8097s/iter; left time: 11183.0190s
	iters: 1400, epoch: 6 | loss: 0.3506996
	speed: 0.8238s/iter; left time: 11295.3555s
	iters: 1500, epoch: 6 | loss: 0.3620412
	speed: 0.8625s/iter; left time: 11738.8384s
	iters: 1600, epoch: 6 | loss: 0.3872753
	speed: 0.8580s/iter; left time: 11593.0169s
	iters: 1700, epoch: 6 | loss: 0.3272880
	speed: 0.8540s/iter; left time: 11453.4225s
	iters: 1800, epoch: 6 | loss: 0.3528908
	speed: 0.8573s/iter; left time: 11411.4830s
	iters: 1900, epoch: 6 | loss: 0.3320791
	speed: 0.8500s/iter; left time: 11229.9174s
	iters: 2000, epoch: 6 | loss: 0.3486434
	speed: 0.8582s/iter; left time: 11251.7822s
	iters: 2100, epoch: 6 | loss: 0.3253630
	speed: 0.8366s/iter; left time: 10885.0219s
	iters: 2200, epoch: 6 | loss: 0.3992839
	speed: 0.8403s/iter; left time: 10849.4146s
	iters: 2300, epoch: 6 | loss: 0.3102212
	speed: 0.8309s/iter; left time: 10644.3249s
	iters: 2400, epoch: 6 | loss: 0.3249785
	speed: 0.8269s/iter; left time: 10510.5451s
	iters: 2500, epoch: 6 | loss: 0.4025707
	speed: 0.8396s/iter; left time: 10587.8303s
	iters: 2600, epoch: 6 | loss: 0.4060465
	speed: 0.8511s/iter; left time: 10648.2199s
	iters: 2700, epoch: 6 | loss: 0.3009342
	speed: 0.8435s/iter; left time: 10468.1749s
	iters: 2800, epoch: 6 | loss: 0.3336385
	speed: 0.8499s/iter; left time: 10463.5805s
	iters: 2900, epoch: 6 | loss: 0.3685074
	speed: 0.8450s/iter; left time: 10318.4904s
	iters: 3000, epoch: 6 | loss: 0.3220471
	speed: 0.8395s/iter; left time: 10166.9772s
Epoch: 6 cost time: 2642.697878599167
Epoch: 6, Steps: 3022 | Train Loss: 0.3488756 Vali Loss: 0.4080314 Test Loss: 0.4597388
Validation loss decreased (0.409800 --> 0.408031).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3234009
	speed: 25.2066s/iter; left time: 302202.5039s
	iters: 200, epoch: 7 | loss: 0.3967410
	speed: 0.4664s/iter; left time: 5545.0944s
	iters: 300, epoch: 7 | loss: 0.3661926
	speed: 0.4687s/iter; left time: 5525.6636s
	iters: 400, epoch: 7 | loss: 0.3248676
	speed: 0.4415s/iter; left time: 5161.1995s
	iters: 500, epoch: 7 | loss: 0.3697893
	speed: 0.4615s/iter; left time: 5347.8064s
	iters: 600, epoch: 7 | loss: 0.3338201
	speed: 0.4545s/iter; left time: 5222.1593s
	iters: 700, epoch: 7 | loss: 0.3537234
	speed: 0.4650s/iter; left time: 5295.6099s
	iters: 800, epoch: 7 | loss: 0.3422256
	speed: 0.4533s/iter; left time: 5116.9172s
	iters: 900, epoch: 7 | loss: 0.3260371
	speed: 0.4686s/iter; left time: 5243.5695s
	iters: 1000, epoch: 7 | loss: 0.3231016
	speed: 0.4585s/iter; left time: 5083.9162s
	iters: 1100, epoch: 7 | loss: 0.3707578
	speed: 0.4617s/iter; left time: 5074.0398s
	iters: 1200, epoch: 7 | loss: 0.3868443
	speed: 0.4703s/iter; left time: 5120.9122s
	iters: 1300, epoch: 7 | loss: 0.3667305
	speed: 0.4621s/iter; left time: 4985.4573s
	iters: 1400, epoch: 7 | loss: 0.2933434
	speed: 0.4697s/iter; left time: 5020.5387s
	iters: 1500, epoch: 7 | loss: 0.2882854
	speed: 0.4674s/iter; left time: 4948.9113s
	iters: 1600, epoch: 7 | loss: 0.3449998
	speed: 0.4645s/iter; left time: 4872.5461s
	iters: 1700, epoch: 7 | loss: 0.2879604
	speed: 0.4640s/iter; left time: 4820.0417s
	iters: 1800, epoch: 7 | loss: 0.3735290
	speed: 0.4623s/iter; left time: 4756.4407s
	iters: 1900, epoch: 7 | loss: 0.3093181
	speed: 0.4631s/iter; left time: 4718.4827s
	iters: 2000, epoch: 7 | loss: 0.3921244
	speed: 0.4644s/iter; left time: 4685.2550s
	iters: 2100, epoch: 7 | loss: 0.3571796
	speed: 0.4662s/iter; left time: 4657.0107s
	iters: 2200, epoch: 7 | loss: 0.3290926
	speed: 0.4611s/iter; left time: 4559.5961s
	iters: 2300, epoch: 7 | loss: 0.3456150
	speed: 0.4682s/iter; left time: 4583.6353s
	iters: 2400, epoch: 7 | loss: 0.3125569
	speed: 0.4575s/iter; left time: 4432.8941s
	iters: 2500, epoch: 7 | loss: 0.3149557
	speed: 0.4648s/iter; left time: 4457.1129s
	iters: 2600, epoch: 7 | loss: 0.2769092
	speed: 0.4718s/iter; left time: 4476.5616s
	iters: 2700, epoch: 7 | loss: 0.3788906
	speed: 0.4817s/iter; left time: 4522.6982s
	iters: 2800, epoch: 7 | loss: 0.3339862
	speed: 0.4764s/iter; left time: 4425.6912s
	iters: 2900, epoch: 7 | loss: 0.3850651
	speed: 0.4812s/iter; left time: 4421.5357s
	iters: 3000, epoch: 7 | loss: 0.3407304
	speed: 0.4828s/iter; left time: 4387.9121s
Epoch: 7 cost time: 1416.7221682071686
Epoch: 7, Steps: 3022 | Train Loss: 0.3480891 Vali Loss: 0.4078064 Test Loss: 0.4592813
Validation loss decreased (0.408031 --> 0.407806).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3455222
	speed: 18.2835s/iter; left time: 163948.3058s
	iters: 200, epoch: 8 | loss: 0.3362702
	speed: 0.4803s/iter; left time: 4258.7354s
	iters: 300, epoch: 8 | loss: 0.3344111
	speed: 0.4835s/iter; left time: 4238.4094s
	iters: 400, epoch: 8 | loss: 0.3079494
	speed: 0.4818s/iter; left time: 4175.9278s
	iters: 500, epoch: 8 | loss: 0.3040790
	speed: 0.4810s/iter; left time: 4121.0789s
	iters: 600, epoch: 8 | loss: 0.3309310
	speed: 0.4828s/iter; left time: 4088.0804s
	iters: 700, epoch: 8 | loss: 0.6035959
	speed: 0.4828s/iter; left time: 4039.6852s
	iters: 800, epoch: 8 | loss: 0.2841539
	speed: 0.4810s/iter; left time: 3976.0831s
	iters: 900, epoch: 8 | loss: 0.3702883
	speed: 0.4802s/iter; left time: 3921.7184s
	iters: 1000, epoch: 8 | loss: 0.3815755
	speed: 0.4811s/iter; left time: 3881.2483s
	iters: 1100, epoch: 8 | loss: 0.2820310
	speed: 0.4832s/iter; left time: 3849.8116s
	iters: 1200, epoch: 8 | loss: 0.2681296
	speed: 0.4806s/iter; left time: 3780.9960s
	iters: 1300, epoch: 8 | loss: 0.2656667
	speed: 0.4825s/iter; left time: 3747.7638s
	iters: 1400, epoch: 8 | loss: 0.3528543
	speed: 0.4846s/iter; left time: 3715.6389s
	iters: 1500, epoch: 8 | loss: 0.3247316
	speed: 0.4820s/iter; left time: 3647.6390s
	iters: 1600, epoch: 8 | loss: 0.3492185
	speed: 0.4809s/iter; left time: 3590.7393s
	iters: 1700, epoch: 8 | loss: 0.3143729
	speed: 0.4794s/iter; left time: 3531.6906s
	iters: 1800, epoch: 8 | loss: 0.2989748
	speed: 0.4836s/iter; left time: 3514.4472s
	iters: 1900, epoch: 8 | loss: 0.3941818
	speed: 0.4789s/iter; left time: 3432.0518s
	iters: 2000, epoch: 8 | loss: 0.3086053
	speed: 0.4709s/iter; left time: 3327.5855s
	iters: 2100, epoch: 8 | loss: 0.3193898
	speed: 0.4715s/iter; left time: 3284.6392s
	iters: 2200, epoch: 8 | loss: 0.3370552
	speed: 0.4872s/iter; left time: 3345.7930s
	iters: 2300, epoch: 8 | loss: 0.4049220
	speed: 0.4781s/iter; left time: 3235.6319s
	iters: 2400, epoch: 8 | loss: 0.3757799
	speed: 0.4804s/iter; left time: 3202.8248s
	iters: 2500, epoch: 8 | loss: 0.3123600
	speed: 0.4807s/iter; left time: 3156.6700s
	iters: 2600, epoch: 8 | loss: 0.3072902
	speed: 0.4792s/iter; left time: 3098.9924s
	iters: 2700, epoch: 8 | loss: 0.3896538
	speed: 0.4846s/iter; left time: 3085.3950s
	iters: 2800, epoch: 8 | loss: 0.3254526
	speed: 0.4780s/iter; left time: 2995.8795s
	iters: 2900, epoch: 8 | loss: 0.3759870
	speed: 0.4811s/iter; left time: 2967.2179s
	iters: 3000, epoch: 8 | loss: 0.4477427
	speed: 0.4826s/iter; left time: 2927.8046s
Epoch: 8 cost time: 1453.1787915229797
Epoch: 8, Steps: 3022 | Train Loss: 0.3477103 Vali Loss: 0.4074604 Test Loss: 0.4594897
Validation loss decreased (0.407806 --> 0.407460).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3863995
	speed: 18.3233s/iter; left time: 108931.8037s
	iters: 200, epoch: 9 | loss: 0.3765996
	speed: 0.4820s/iter; left time: 2817.5657s
	iters: 300, epoch: 9 | loss: 0.4126713
	speed: 0.4813s/iter; left time: 2764.8102s
	iters: 400, epoch: 9 | loss: 0.3423318
	speed: 0.4845s/iter; left time: 2735.1465s
	iters: 500, epoch: 9 | loss: 0.3162940
	speed: 0.4797s/iter; left time: 2660.0376s
	iters: 600, epoch: 9 | loss: 0.4174067
	speed: 0.4849s/iter; left time: 2640.4368s
	iters: 700, epoch: 9 | loss: 0.3103586
	speed: 0.4837s/iter; left time: 2585.1711s
	iters: 800, epoch: 9 | loss: 0.3705937
	speed: 0.4832s/iter; left time: 2534.5822s
	iters: 900, epoch: 9 | loss: 0.3382438
	speed: 0.4788s/iter; left time: 2463.3304s
	iters: 1000, epoch: 9 | loss: 0.3752026
	speed: 0.4795s/iter; left time: 2419.2759s
	iters: 1100, epoch: 9 | loss: 0.3744951
	speed: 0.4854s/iter; left time: 2400.1564s
	iters: 1200, epoch: 9 | loss: 0.2833260
	speed: 0.4824s/iter; left time: 2337.2654s
	iters: 1300, epoch: 9 | loss: 0.3677137
	speed: 0.4791s/iter; left time: 2273.2215s
	iters: 1400, epoch: 9 | loss: 0.3049196
	speed: 0.4843s/iter; left time: 2249.3816s
	iters: 1500, epoch: 9 | loss: 0.3324489
	speed: 0.4831s/iter; left time: 2195.6713s
	iters: 1600, epoch: 9 | loss: 0.3854809
	speed: 0.4820s/iter; left time: 2142.6657s
	iters: 1700, epoch: 9 | loss: 0.4144606
	speed: 0.4534s/iter; left time: 1970.0244s
	iters: 1800, epoch: 9 | loss: 0.4273780
	speed: 0.4690s/iter; left time: 1991.0228s
	iters: 1900, epoch: 9 | loss: 0.3717734
	speed: 0.4704s/iter; left time: 1949.6857s
	iters: 2000, epoch: 9 | loss: 0.3838826
	speed: 0.4654s/iter; left time: 1882.3962s
	iters: 2100, epoch: 9 | loss: 0.3509257
	speed: 0.4654s/iter; left time: 1836.1198s
	iters: 2200, epoch: 9 | loss: 0.3337646
	speed: 0.4681s/iter; left time: 1799.7344s
	iters: 2300, epoch: 9 | loss: 0.2722678
	speed: 0.4712s/iter; left time: 1764.6654s
	iters: 2400, epoch: 9 | loss: 0.3124886
	speed: 0.4659s/iter; left time: 1698.3227s
	iters: 2500, epoch: 9 | loss: 0.3434377
	speed: 0.4731s/iter; left time: 1677.1932s
	iters: 2600, epoch: 9 | loss: 0.3483689
	speed: 0.4672s/iter; left time: 1609.6343s
	iters: 2700, epoch: 9 | loss: 0.4929167
	speed: 0.4671s/iter; left time: 1562.3935s
	iters: 2800, epoch: 9 | loss: 0.4124216
	speed: 0.4680s/iter; left time: 1518.6141s
	iters: 2900, epoch: 9 | loss: 0.3337847
	speed: 0.4694s/iter; left time: 1476.2827s
	iters: 3000, epoch: 9 | loss: 0.3393667
	speed: 0.4542s/iter; left time: 1382.9069s
Epoch: 9 cost time: 1434.253252506256
Epoch: 9, Steps: 3022 | Train Loss: 0.3474634 Vali Loss: 0.4071802 Test Loss: 0.4585334
Validation loss decreased (0.407460 --> 0.407180).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3237738
	speed: 13.6040s/iter; left time: 39764.5632s
	iters: 200, epoch: 10 | loss: 0.3273358
	speed: 0.3462s/iter; left time: 977.2131s
	iters: 300, epoch: 10 | loss: 0.3666029
	speed: 0.3464s/iter; left time: 943.3612s
	iters: 400, epoch: 10 | loss: 0.3413241
	speed: 0.3510s/iter; left time: 920.8021s
	iters: 500, epoch: 10 | loss: 0.3503583
	speed: 0.3467s/iter; left time: 874.6838s
	iters: 600, epoch: 10 | loss: 0.3460964
	speed: 0.3455s/iter; left time: 837.0590s
	iters: 700, epoch: 10 | loss: 0.3384624
	speed: 0.3476s/iter; left time: 807.5026s
	iters: 800, epoch: 10 | loss: 0.3405244
	speed: 0.3450s/iter; left time: 767.0282s
	iters: 900, epoch: 10 | loss: 0.3079644
	speed: 0.3395s/iter; left time: 720.7751s
	iters: 1000, epoch: 10 | loss: 0.2624121
	speed: 0.3471s/iter; left time: 702.0921s
	iters: 1100, epoch: 10 | loss: 0.3981687
	speed: 0.3453s/iter; left time: 664.0870s
	iters: 1200, epoch: 10 | loss: 0.3849482
	speed: 0.3433s/iter; left time: 625.9004s
	iters: 1300, epoch: 10 | loss: 0.3146542
	speed: 0.3436s/iter; left time: 592.0601s
	iters: 1400, epoch: 10 | loss: 0.3153717
	speed: 0.3415s/iter; left time: 554.2056s
	iters: 1500, epoch: 10 | loss: 0.3387004
	speed: 0.3454s/iter; left time: 526.1159s
	iters: 1600, epoch: 10 | loss: 0.4008986
	speed: 0.3455s/iter; left time: 491.6337s
	iters: 1700, epoch: 10 | loss: 0.2994077
	speed: 0.3443s/iter; left time: 455.4774s
	iters: 1800, epoch: 10 | loss: 0.3366972
	speed: 0.3451s/iter; left time: 422.0651s
	iters: 1900, epoch: 10 | loss: 0.4063147
	speed: 0.3432s/iter; left time: 385.4294s
	iters: 2000, epoch: 10 | loss: 0.3522372
	speed: 0.3432s/iter; left time: 351.0653s
	iters: 2100, epoch: 10 | loss: 0.3792296
	speed: 0.3420s/iter; left time: 315.6592s
	iters: 2200, epoch: 10 | loss: 0.3487005
	speed: 0.3429s/iter; left time: 282.1948s
	iters: 2300, epoch: 10 | loss: 0.3141947
	speed: 0.3464s/iter; left time: 250.4141s
	iters: 2400, epoch: 10 | loss: 0.3494022
	speed: 0.3410s/iter; left time: 212.4732s
	iters: 2500, epoch: 10 | loss: 0.3232989
	speed: 0.3418s/iter; left time: 178.7487s
	iters: 2600, epoch: 10 | loss: 0.3508420
	speed: 0.3424s/iter; left time: 144.8368s
	iters: 2700, epoch: 10 | loss: 0.3470406
	speed: 0.3389s/iter; left time: 109.4488s
	iters: 2800, epoch: 10 | loss: 0.3560201
	speed: 0.3391s/iter; left time: 75.6209s
	iters: 2900, epoch: 10 | loss: 0.3154733
	speed: 0.3443s/iter; left time: 42.3514s
	iters: 3000, epoch: 10 | loss: 0.2987560
	speed: 0.3425s/iter; left time: 7.8784s
Epoch: 10 cost time: 1040.0180232524872
Epoch: 10, Steps: 3022 | Train Loss: 0.3473562 Vali Loss: 0.4072171 Test Loss: 0.4585958
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_96_PatchTST_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 1, 96, 862) (3413, 1, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.45853185653686523, mae:0.2948044538497925
