Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Traffic_96_720      Model:              TimeMixer           

[1mData Loader[0m
  Data:               custom              Root Path:          ../iTransformer_datasets/traffic/
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.01                
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Traffic_96_720_TimeMixer_custom_ftM_sl96_ll0_pl720_dm32_nh8_el3_dl1_df64_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.4429182
	speed: 0.6908s/iter; left time: 9831.4225s
	iters: 200, epoch: 1 | loss: 0.3815611
	speed: 0.9010s/iter; left time: 12732.1886s
	iters: 300, epoch: 1 | loss: 0.3873178
	speed: 0.9108s/iter; left time: 12779.2995s
	iters: 400, epoch: 1 | loss: 0.4084852
	speed: 0.9191s/iter; left time: 12803.4381s
	iters: 500, epoch: 1 | loss: 0.3605268
	speed: 1.1139s/iter; left time: 15406.8540s
	iters: 600, epoch: 1 | loss: 0.3570454
	speed: 1.1698s/iter; left time: 16062.5051s
	iters: 700, epoch: 1 | loss: 0.3278565
	speed: 1.1752s/iter; left time: 16018.6807s
	iters: 800, epoch: 1 | loss: 0.3407155
	speed: 1.1694s/iter; left time: 15823.2196s
	iters: 900, epoch: 1 | loss: 0.3543744
	speed: 1.1767s/iter; left time: 15804.4550s
	iters: 1000, epoch: 1 | loss: 0.3254137
	speed: 1.1745s/iter; left time: 15657.0305s
	iters: 1100, epoch: 1 | loss: 0.3560095
	speed: 1.1800s/iter; left time: 15612.2751s
	iters: 1200, epoch: 1 | loss: 0.3247225
	speed: 1.1781s/iter; left time: 15469.5634s
	iters: 1300, epoch: 1 | loss: 0.3334913
	speed: 1.1827s/iter; left time: 15411.3718s
	iters: 1400, epoch: 1 | loss: 0.3198496
	speed: 1.2070s/iter; left time: 15607.5469s
Epoch: 1 cost time: 1554.8812828063965
Epoch: 1, Steps: 1433 | Train Loss: 0.3706897 Vali Loss: 0.4844726 Test Loss: 0.5650176
Validation loss decreased (inf --> 0.484473).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3163870
	speed: 17.4954s/iter; left time: 223905.9749s
	iters: 200, epoch: 2 | loss: 0.3541264
	speed: 1.1804s/iter; left time: 14989.3505s
	iters: 300, epoch: 2 | loss: 0.3496570
	speed: 1.1678s/iter; left time: 14711.6406s
	iters: 400, epoch: 2 | loss: 0.3346205
	speed: 1.1628s/iter; left time: 14532.5663s
	iters: 500, epoch: 2 | loss: 0.3101365
	speed: 1.1838s/iter; left time: 14676.9158s
	iters: 600, epoch: 2 | loss: 0.3501857
	speed: 1.1943s/iter; left time: 14687.1576s
	iters: 700, epoch: 2 | loss: 0.2985969
	speed: 1.1681s/iter; left time: 14248.3309s
	iters: 800, epoch: 2 | loss: 0.2987987
	speed: 1.1896s/iter; left time: 14391.8469s
	iters: 900, epoch: 2 | loss: 0.3078226
	speed: 1.1839s/iter; left time: 14204.9971s
	iters: 1000, epoch: 2 | loss: 0.3487124
	speed: 1.1967s/iter; left time: 14238.4316s
	iters: 1100, epoch: 2 | loss: 0.3211284
	speed: 1.1971s/iter; left time: 14123.4119s
	iters: 1200, epoch: 2 | loss: 0.2846686
	speed: 1.2148s/iter; left time: 14210.6449s
	iters: 1300, epoch: 2 | loss: 0.3076133
	speed: 1.2287s/iter; left time: 14251.0194s
	iters: 1400, epoch: 2 | loss: 0.3459124
	speed: 1.2370s/iter; left time: 14222.8173s
Epoch: 2 cost time: 1708.636708021164
Epoch: 2, Steps: 1433 | Train Loss: 0.3253314 Vali Loss: 0.4731618 Test Loss: 0.5640144
Validation loss decreased (0.484473 --> 0.473162).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.2871190
	speed: 17.4500s/iter; left time: 198319.0424s
	iters: 200, epoch: 3 | loss: 0.3194043
	speed: 1.1780s/iter; left time: 13269.8712s
	iters: 300, epoch: 3 | loss: 0.3326483
	speed: 1.1792s/iter; left time: 13166.0312s
	iters: 400, epoch: 3 | loss: 0.3143101
	speed: 1.1813s/iter; left time: 13071.3573s
	iters: 500, epoch: 3 | loss: 0.2925717
	speed: 1.1808s/iter; left time: 12947.7008s
	iters: 600, epoch: 3 | loss: 0.3081741
	speed: 1.1762s/iter; left time: 12779.0835s
	iters: 700, epoch: 3 | loss: 0.3025287
	speed: 1.1709s/iter; left time: 12604.8848s
	iters: 800, epoch: 3 | loss: 0.2870150
	speed: 1.1802s/iter; left time: 12587.0000s
	iters: 900, epoch: 3 | loss: 0.3018634
	speed: 1.1722s/iter; left time: 12384.6306s
	iters: 1000, epoch: 3 | loss: 0.3102462
	speed: 1.1959s/iter; left time: 12515.4349s
	iters: 1100, epoch: 3 | loss: 0.3094149
	speed: 1.2098s/iter; left time: 12540.0180s
	iters: 1200, epoch: 3 | loss: 0.2951600
	speed: 1.2204s/iter; left time: 12527.1639s
	iters: 1300, epoch: 3 | loss: 0.3268360
	speed: 1.2237s/iter; left time: 12438.6739s
	iters: 1400, epoch: 3 | loss: 0.2862253
	speed: 1.2240s/iter; left time: 12319.6573s
Epoch: 3 cost time: 1707.1751325130463
Epoch: 3, Steps: 1433 | Train Loss: 0.3062535 Vali Loss: 0.4728569 Test Loss: 0.5562696
Validation loss decreased (0.473162 --> 0.472857).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2939717
	speed: 17.2747s/iter; left time: 171572.6893s
	iters: 200, epoch: 4 | loss: 0.3164328
	speed: 1.1764s/iter; left time: 11566.5198s
	iters: 300, epoch: 4 | loss: 0.3090998
	speed: 1.1672s/iter; left time: 11359.0403s
	iters: 400, epoch: 4 | loss: 0.2920002
	speed: 1.1710s/iter; left time: 11279.0188s
	iters: 500, epoch: 4 | loss: 0.2943224
	speed: 1.1723s/iter; left time: 11174.7955s
	iters: 600, epoch: 4 | loss: 0.2903748
	speed: 1.1698s/iter; left time: 11033.4050s
	iters: 700, epoch: 4 | loss: 0.3217021
	speed: 1.1652s/iter; left time: 10873.5438s
	iters: 800, epoch: 4 | loss: 0.3057237
	speed: 1.1679s/iter; left time: 10781.8024s
	iters: 900, epoch: 4 | loss: 0.3018178
	speed: 1.1716s/iter; left time: 10699.1135s
	iters: 1000, epoch: 4 | loss: 0.2712456
	speed: 1.1868s/iter; left time: 10718.8883s
	iters: 1100, epoch: 4 | loss: 0.2855976
	speed: 1.1884s/iter; left time: 10614.4739s
	iters: 1200, epoch: 4 | loss: 0.3376964
	speed: 1.2203s/iter; left time: 10778.0013s
	iters: 1300, epoch: 4 | loss: 0.2755491
	speed: 1.2155s/iter; left time: 10614.1773s
	iters: 1400, epoch: 4 | loss: 0.2911072
	speed: 1.2137s/iter; left time: 10476.4456s
Epoch: 4 cost time: 1696.5420529842377
Epoch: 4, Steps: 1433 | Train Loss: 0.2967305 Vali Loss: 0.4568365 Test Loss: 0.5516916
Validation loss decreased (0.472857 --> 0.456836).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2720852
	speed: 17.0516s/iter; left time: 144921.5431s
	iters: 200, epoch: 5 | loss: 0.2809508
	speed: 1.1706s/iter; left time: 9831.9981s
	iters: 300, epoch: 5 | loss: 0.2862061
	speed: 1.1628s/iter; left time: 9649.8258s
	iters: 400, epoch: 5 | loss: 0.2829243
	speed: 1.1664s/iter; left time: 9563.5392s
	iters: 500, epoch: 5 | loss: 0.3004766
	speed: 1.1674s/iter; left time: 9454.5192s
	iters: 600, epoch: 5 | loss: 0.3214134
	speed: 1.1646s/iter; left time: 9315.5689s
	iters: 700, epoch: 5 | loss: 0.2709291
	speed: 1.1641s/iter; left time: 9195.5733s
	iters: 800, epoch: 5 | loss: 0.2905444
	speed: 1.1768s/iter; left time: 9177.6563s
	iters: 900, epoch: 5 | loss: 0.2909470
	speed: 1.1897s/iter; left time: 9159.3621s
	iters: 1000, epoch: 5 | loss: 0.2761569
	speed: 1.1986s/iter; left time: 9107.7858s
	iters: 1100, epoch: 5 | loss: 0.2702810
	speed: 1.2020s/iter; left time: 9013.8581s
	iters: 1200, epoch: 5 | loss: 0.2953261
	speed: 1.1985s/iter; left time: 8867.5097s
	iters: 1300, epoch: 5 | loss: 0.2971269
	speed: 1.1791s/iter; left time: 8606.2499s
	iters: 1400, epoch: 5 | loss: 0.2692413
	speed: 1.2010s/iter; left time: 8645.9201s
Epoch: 5 cost time: 1691.302744626999
Epoch: 5, Steps: 1433 | Train Loss: 0.2908899 Vali Loss: 0.4594908 Test Loss: 0.5538151
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.2994362
	speed: 16.5643s/iter; left time: 117043.0234s
	iters: 200, epoch: 6 | loss: 0.2850947
	speed: 1.1340s/iter; left time: 7899.4682s
	iters: 300, epoch: 6 | loss: 0.2668040
	speed: 1.1286s/iter; left time: 7748.9780s
	iters: 400, epoch: 6 | loss: 0.2700757
	speed: 1.1298s/iter; left time: 7644.1555s
	iters: 500, epoch: 6 | loss: 0.2958154
	speed: 1.1232s/iter; left time: 7487.1455s
	iters: 600, epoch: 6 | loss: 0.2806692
	speed: 1.1264s/iter; left time: 7395.8250s
	iters: 700, epoch: 6 | loss: 0.2590170
	speed: 1.1205s/iter; left time: 7244.9893s
	iters: 800, epoch: 6 | loss: 0.2833296
	speed: 1.1238s/iter; left time: 7154.0697s
	iters: 900, epoch: 6 | loss: 0.3201361
	speed: 1.1411s/iter; left time: 7150.3341s
	iters: 1000, epoch: 6 | loss: 0.2772073
	speed: 1.1445s/iter; left time: 7057.2118s
	iters: 1100, epoch: 6 | loss: 0.2887305
	speed: 1.1523s/iter; left time: 6989.7052s
	iters: 1200, epoch: 6 | loss: 0.3103257
	speed: 1.1586s/iter; left time: 6912.3145s
	iters: 1300, epoch: 6 | loss: 0.3065004
	speed: 1.1556s/iter; left time: 6778.8116s
	iters: 1400, epoch: 6 | loss: 0.3028741
	speed: 1.1544s/iter; left time: 6656.4202s
Epoch: 6 cost time: 1630.0204226970673
Epoch: 6, Steps: 1433 | Train Loss: 0.2875023 Vali Loss: 0.4550039 Test Loss: 0.5480928
Validation loss decreased (0.456836 --> 0.455004).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2921090
	speed: 16.3726s/iter; left time: 92226.7962s
	iters: 200, epoch: 7 | loss: 0.2691375
	speed: 1.1352s/iter; left time: 6281.2195s
	iters: 300, epoch: 7 | loss: 0.2621043
	speed: 1.1188s/iter; left time: 6078.4293s
	iters: 400, epoch: 7 | loss: 0.2679487
	speed: 1.1301s/iter; left time: 6026.5606s
	iters: 500, epoch: 7 | loss: 0.2768965
	speed: 1.1239s/iter; left time: 5881.3547s
	iters: 600, epoch: 7 | loss: 0.2791324
	speed: 1.1345s/iter; left time: 5823.3662s
	iters: 700, epoch: 7 | loss: 0.2801071
	speed: 1.1264s/iter; left time: 5669.2022s
	iters: 800, epoch: 7 | loss: 0.2958958
	speed: 1.1268s/iter; left time: 5558.7195s
	iters: 900, epoch: 7 | loss: 0.2832246
	speed: 1.1207s/iter; left time: 5416.2555s
	iters: 1000, epoch: 7 | loss: 0.3109189
	speed: 1.1317s/iter; left time: 5356.1271s
	iters: 1100, epoch: 7 | loss: 0.2668357
	speed: 1.1474s/iter; left time: 5316.1335s
	iters: 1200, epoch: 7 | loss: 0.2976141
	speed: 1.1543s/iter; left time: 5232.5585s
	iters: 1300, epoch: 7 | loss: 0.2754870
	speed: 1.1547s/iter; left time: 5118.9395s
	iters: 1400, epoch: 7 | loss: 0.2923495
	speed: 1.1583s/iter; left time: 5019.0652s
Epoch: 7 cost time: 1626.9252660274506
Epoch: 7, Steps: 1433 | Train Loss: 0.2856569 Vali Loss: 0.4538503 Test Loss: 0.5507104
Validation loss decreased (0.455004 --> 0.453850).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2944940
	speed: 16.4395s/iter; left time: 69045.8757s
	iters: 200, epoch: 8 | loss: 0.2735418
	speed: 1.1340s/iter; left time: 4649.4499s
	iters: 300, epoch: 8 | loss: 0.2819719
	speed: 1.1355s/iter; left time: 4541.9122s
	iters: 400, epoch: 8 | loss: 0.2670046
	speed: 1.1302s/iter; left time: 4407.9415s
	iters: 500, epoch: 8 | loss: 0.3073537
	speed: 1.1366s/iter; left time: 4319.1543s
	iters: 600, epoch: 8 | loss: 0.2975948
	speed: 1.1324s/iter; left time: 4189.8642s
	iters: 700, epoch: 8 | loss: 0.2779709
	speed: 1.1221s/iter; left time: 4039.5995s
	iters: 800, epoch: 8 | loss: 0.2628427
	speed: 1.1311s/iter; left time: 3958.8614s
	iters: 900, epoch: 8 | loss: 0.2712626
	speed: 1.1263s/iter; left time: 3829.4896s
	iters: 1000, epoch: 8 | loss: 0.2892488
	speed: 1.1237s/iter; left time: 3708.1119s
	iters: 1100, epoch: 8 | loss: 0.2715364
	speed: 1.1281s/iter; left time: 3610.0627s
	iters: 1200, epoch: 8 | loss: 0.3192382
	speed: 1.1271s/iter; left time: 3494.0685s
	iters: 1300, epoch: 8 | loss: 0.2983336
	speed: 1.1468s/iter; left time: 3440.3543s
	iters: 1400, epoch: 8 | loss: 0.2930315
	speed: 1.1472s/iter; left time: 3326.7363s
Epoch: 8 cost time: 1623.6118426322937
Epoch: 8, Steps: 1433 | Train Loss: 0.2846148 Vali Loss: 0.4543184 Test Loss: 0.5499869
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.2992373
	speed: 16.5232s/iter; left time: 45719.7597s
	iters: 200, epoch: 9 | loss: 0.2737965
	speed: 1.1266s/iter; left time: 3004.5890s
	iters: 300, epoch: 9 | loss: 0.2906263
	speed: 1.1287s/iter; left time: 2897.2829s
	iters: 400, epoch: 9 | loss: 0.2787956
	speed: 1.1307s/iter; left time: 2789.3224s
	iters: 500, epoch: 9 | loss: 0.2584690
	speed: 1.1267s/iter; left time: 2666.8693s
	iters: 600, epoch: 9 | loss: 0.2808522
	speed: 1.1294s/iter; left time: 2560.4023s
	iters: 700, epoch: 9 | loss: 0.2680812
	speed: 1.1303s/iter; left time: 2449.3769s
	iters: 800, epoch: 9 | loss: 0.2943740
	speed: 1.1316s/iter; left time: 2339.1089s
	iters: 900, epoch: 9 | loss: 0.3109466
	speed: 1.1369s/iter; left time: 2236.2357s
	iters: 1000, epoch: 9 | loss: 0.2881489
	speed: 1.1196s/iter; left time: 2090.2070s
	iters: 1100, epoch: 9 | loss: 0.2688933
	speed: 1.1261s/iter; left time: 1989.8856s
	iters: 1200, epoch: 9 | loss: 0.2669773
	speed: 1.1204s/iter; left time: 1867.7638s
	iters: 1300, epoch: 9 | loss: 0.2694943
	speed: 1.1271s/iter; left time: 1766.1503s
	iters: 1400, epoch: 9 | loss: 0.2822814
	speed: 1.1401s/iter; left time: 1672.5966s
Epoch: 9 cost time: 1618.3647067546844
Epoch: 9, Steps: 1433 | Train Loss: 0.2840776 Vali Loss: 0.4534240 Test Loss: 0.5536000
Validation loss decreased (0.453850 --> 0.453424).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2995965
	speed: 16.6406s/iter; left time: 22198.6227s
	iters: 200, epoch: 10 | loss: 0.2610651
	speed: 1.1451s/iter; left time: 1413.0384s
	iters: 300, epoch: 10 | loss: 0.2695234
	speed: 1.1367s/iter; left time: 1289.0740s
	iters: 400, epoch: 10 | loss: 0.2762280
	speed: 1.1334s/iter; left time: 1171.9671s
	iters: 500, epoch: 10 | loss: 0.3004828
	speed: 1.1312s/iter; left time: 1056.4965s
	iters: 600, epoch: 10 | loss: 0.2795930
	speed: 1.1268s/iter; left time: 939.7819s
	iters: 700, epoch: 10 | loss: 0.2820241
	speed: 1.1326s/iter; left time: 831.3507s
	iters: 800, epoch: 10 | loss: 0.3068766
	speed: 1.1275s/iter; left time: 714.8386s
	iters: 900, epoch: 10 | loss: 0.3124635
	speed: 1.1286s/iter; left time: 602.6727s
	iters: 1000, epoch: 10 | loss: 0.2856115
	speed: 1.1342s/iter; left time: 492.2325s
	iters: 1100, epoch: 10 | loss: 0.3189425
	speed: 1.1350s/iter; left time: 379.0911s
	iters: 1200, epoch: 10 | loss: 0.2819139
	speed: 1.1271s/iter; left time: 263.7422s
	iters: 1300, epoch: 10 | loss: 0.3136535
	speed: 1.1318s/iter; left time: 151.6653s
	iters: 1400, epoch: 10 | loss: 0.3004548
	speed: 1.1302s/iter; left time: 38.4263s
Epoch: 10 cost time: 1624.3196918964386
Epoch: 10, Steps: 1433 | Train Loss: 0.2837880 Vali Loss: 0.4536724 Test Loss: 0.5528741
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-05
>>>>>>>testing : long_term_forecast_Traffic_96_720_TimeMixer_custom_ftM_sl96_ll0_pl720_dm32_nh8_el3_dl1_df64_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 1, 720, 862) (2789, 1, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.5536044239997864, mae:0.3221021294593811
Spend Time: 36427.84796857834
