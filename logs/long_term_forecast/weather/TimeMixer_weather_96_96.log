Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              TimeMixer           

[1mData Loader[0m
  Data:               custom              Root Path:          ../iTransformer_datasets/weather/
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       20                  Batch Size:         128                 
  Patience:           10                  Learning Rate:      0.01                
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_TimeMixer_custom_ftM_sl96_ll0_pl96_dm16_nh8_el3_dl1_df32_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.3842360
	speed: 0.3703s/iter; left time: 2081.2548s
	iters: 200, epoch: 1 | loss: 0.3617316
	speed: 0.3548s/iter; left time: 1958.5816s
Epoch: 1 cost time: 107.77649903297424
Epoch: 1, Steps: 286 | Train Loss: 0.4553359 Vali Loss: 0.4026998 Test Loss: 0.1626890
Validation loss decreased (inf --> 0.402700).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.3435491
	speed: 2.4811s/iter; left time: 13236.8284s
	iters: 200, epoch: 2 | loss: 0.3349237
	speed: 0.2943s/iter; left time: 1540.7444s
Epoch: 2 cost time: 84.59761643409729
Epoch: 2, Steps: 286 | Train Loss: 0.4271245 Vali Loss: 0.4069676 Test Loss: 0.1648693
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3108728
	speed: 2.4077s/iter; left time: 12156.2827s
	iters: 200, epoch: 3 | loss: 0.3593372
	speed: 0.2544s/iter; left time: 1259.0668s
Epoch: 3 cost time: 72.47575163841248
Epoch: 3, Steps: 286 | Train Loss: 0.4172837 Vali Loss: 0.3994876 Test Loss: 0.1649234
Validation loss decreased (0.402700 --> 0.399488).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3063679
	speed: 1.7397s/iter; left time: 8286.0516s
	iters: 200, epoch: 4 | loss: 0.4549370
	speed: 0.2482s/iter; left time: 1157.2081s
Epoch: 4 cost time: 68.78028106689453
Epoch: 4, Steps: 286 | Train Loss: 0.4102843 Vali Loss: 0.4018745 Test Loss: 0.1619028
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2980105
	speed: 1.7115s/iter; left time: 7662.4361s
	iters: 200, epoch: 5 | loss: 0.5106576
	speed: 0.2362s/iter; left time: 1033.6505s
Epoch: 5 cost time: 65.79600286483765
Epoch: 5, Steps: 286 | Train Loss: 0.4055257 Vali Loss: 0.3981632 Test Loss: 0.1613300
Validation loss decreased (0.399488 --> 0.398163).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3776596
	speed: 1.7297s/iter; left time: 7249.3750s
	iters: 200, epoch: 6 | loss: 0.3326412
	speed: 0.2107s/iter; left time: 861.9068s
Epoch: 6 cost time: 63.737600326538086
Epoch: 6, Steps: 286 | Train Loss: 0.4021424 Vali Loss: 0.3982324 Test Loss: 0.1617132
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.6033591
	speed: 1.7237s/iter; left time: 6730.8900s
	iters: 200, epoch: 7 | loss: 0.4498033
	speed: 0.2158s/iter; left time: 821.1627s
Epoch: 7 cost time: 61.838393211364746
Epoch: 7, Steps: 286 | Train Loss: 0.4013864 Vali Loss: 0.3964813 Test Loss: 0.1614886
Validation loss decreased (0.398163 --> 0.396481).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.3075733
	speed: 1.6938s/iter; left time: 6129.9382s
	iters: 200, epoch: 8 | loss: 0.3647940
	speed: 0.2019s/iter; left time: 710.4888s
Epoch: 8 cost time: 57.426233530044556
Epoch: 8, Steps: 286 | Train Loss: 0.4003180 Vali Loss: 0.3964081 Test Loss: 0.1621252
Validation loss decreased (0.396481 --> 0.396408).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.5421440
	speed: 1.7405s/iter; left time: 5801.2450s
	iters: 200, epoch: 9 | loss: 0.3754861
	speed: 0.1955s/iter; left time: 631.8924s
Epoch: 9 cost time: 54.826573848724365
Epoch: 9, Steps: 286 | Train Loss: 0.3998223 Vali Loss: 0.3953291 Test Loss: 0.1616285
Validation loss decreased (0.396408 --> 0.395329).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.4697761
	speed: 1.6540s/iter; left time: 5039.6346s
	iters: 200, epoch: 10 | loss: 0.3056563
	speed: 0.1926s/iter; left time: 567.6116s
Epoch: 10 cost time: 57.87818479537964
Epoch: 10, Steps: 286 | Train Loss: 0.3984550 Vali Loss: 0.3975318 Test Loss: 0.1619862
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.6396459
	speed: 2.0264s/iter; left time: 5594.9941s
	iters: 200, epoch: 11 | loss: 0.3364265
	speed: 0.2550s/iter; left time: 678.5997s
Epoch: 11 cost time: 69.45848512649536
Epoch: 11, Steps: 286 | Train Loss: 0.3993995 Vali Loss: 0.3985933 Test Loss: 0.1620597
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.4405871
	speed: 2.1454s/iter; left time: 5309.8769s
	iters: 200, epoch: 12 | loss: 0.5609624
	speed: 0.3053s/iter; left time: 725.1886s
Epoch: 12 cost time: 84.61813044548035
Epoch: 12, Steps: 286 | Train Loss: 0.3978754 Vali Loss: 0.3965898 Test Loss: 0.1620304
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 13 | loss: 0.2767541
	speed: 4.7117s/iter; left time: 10313.8638s
	iters: 200, epoch: 13 | loss: 0.6446407
	speed: 0.3496s/iter; left time: 730.2423s
Epoch: 13 cost time: 99.29461288452148
Epoch: 13, Steps: 286 | Train Loss: 0.3992904 Vali Loss: 0.3978490 Test Loss: 0.1620277
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 14 | loss: 0.5488673
	speed: 4.7006s/iter; left time: 8945.1603s
	iters: 200, epoch: 14 | loss: 0.2813089
	speed: 0.3411s/iter; left time: 614.9384s
Epoch: 14 cost time: 99.85444521903992
Epoch: 14, Steps: 286 | Train Loss: 0.3991305 Vali Loss: 0.3947597 Test Loss: 0.1620343
Validation loss decreased (0.395329 --> 0.394760).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 15 | loss: 0.2366884
	speed: 4.5053s/iter; left time: 7285.0441s
	iters: 200, epoch: 15 | loss: 0.5224444
	speed: 0.2757s/iter; left time: 418.2061s
Epoch: 15 cost time: 83.50868916511536
Epoch: 15, Steps: 286 | Train Loss: 0.3991932 Vali Loss: 0.3976609 Test Loss: 0.1620314
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 16 | loss: 0.2480995
	speed: 4.1359s/iter; left time: 5504.8663s
	iters: 200, epoch: 16 | loss: 0.3197228
	speed: 0.2682s/iter; left time: 330.1045s
Epoch: 16 cost time: 78.28950929641724
Epoch: 16, Steps: 286 | Train Loss: 0.3991975 Vali Loss: 0.3962355 Test Loss: 0.1620314
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 17 | loss: 0.8176382
	speed: 3.3869s/iter; left time: 3539.2746s
	iters: 200, epoch: 17 | loss: 0.3777999
	speed: 0.2806s/iter; left time: 265.2007s
Epoch: 17 cost time: 81.1790943145752
Epoch: 17, Steps: 286 | Train Loss: 0.3991431 Vali Loss: 0.3933785 Test Loss: 0.1620328
Validation loss decreased (0.394760 --> 0.393378).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 18 | loss: 0.2592173
	speed: 3.0418s/iter; left time: 2308.6966s
	iters: 200, epoch: 18 | loss: 0.3365860
	speed: 0.2806s/iter; left time: 184.9147s
Epoch: 18 cost time: 79.94422245025635
Epoch: 18, Steps: 286 | Train Loss: 0.3982537 Vali Loss: 0.3977105 Test Loss: 0.1620334
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 19 | loss: 0.3234690
	speed: 3.0381s/iter; left time: 1437.0065s
	iters: 200, epoch: 19 | loss: 0.2911877
	speed: 0.2810s/iter; left time: 104.8301s
Epoch: 19 cost time: 80.86254930496216
Epoch: 19, Steps: 286 | Train Loss: 0.3989962 Vali Loss: 0.3970084 Test Loss: 0.1620332
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 20 | loss: 0.6511938
	speed: 2.9807s/iter; left time: 557.4001s
	iters: 200, epoch: 20 | loss: 0.3160728
	speed: 0.2799s/iter; left time: 24.3493s
Epoch: 20 cost time: 79.71396374702454
Epoch: 20, Steps: 286 | Train Loss: 0.3993153 Vali Loss: 0.3979326 Test Loss: 0.1620332
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.9073486328125e-08
>>>>>>>testing : long_term_forecast_weather_96_96_TimeMixer_custom_ftM_sl96_ll0_pl96_dm16_nh8_el3_dl1_df32_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.1620328426361084, mae:0.20918317139148712
Spend Time: 6515.693723201752
