Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ../iTransformer_datasets/weather/
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el3_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6749465
	speed: 0.6108s/iter; left time: 6823.3689s
	iters: 200, epoch: 1 | loss: 0.7531402
	speed: 0.5202s/iter; left time: 5758.9394s
	iters: 300, epoch: 1 | loss: 0.7396979
	speed: 0.5473s/iter; left time: 6004.2937s
	iters: 400, epoch: 1 | loss: 0.7897639
	speed: 0.5526s/iter; left time: 6006.8473s
	iters: 500, epoch: 1 | loss: 0.6197711
	speed: 0.5488s/iter; left time: 5911.0972s
	iters: 600, epoch: 1 | loss: 0.6058129
	speed: 0.5467s/iter; left time: 5833.5507s
	iters: 700, epoch: 1 | loss: 0.6802999
	speed: 0.5403s/iter; left time: 5711.7889s
	iters: 800, epoch: 1 | loss: 0.8372441
	speed: 0.5462s/iter; left time: 5719.6671s
	iters: 900, epoch: 1 | loss: 0.6322597
	speed: 0.5537s/iter; left time: 5742.5333s
	iters: 1000, epoch: 1 | loss: 0.7653537
	speed: 0.5102s/iter; left time: 5240.6521s
	iters: 1100, epoch: 1 | loss: 0.7496873
	speed: 0.4719s/iter; left time: 4799.7941s
Epoch: 1 cost time: 607.9388444423676
Epoch: 1, Steps: 1127 | Train Loss: 0.7183782 Vali Loss: 0.7386032 Test Loss: 0.3633701
Validation loss decreased (inf --> 0.738603).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8247222
	speed: 4.2533s/iter; left time: 42719.7492s
	iters: 200, epoch: 2 | loss: 0.5761893
	speed: 0.5407s/iter; left time: 5376.6958s
	iters: 300, epoch: 2 | loss: 0.7455512
	speed: 0.5462s/iter; left time: 5376.9093s
	iters: 400, epoch: 2 | loss: 0.6001329
	speed: 0.5510s/iter; left time: 5369.0698s
	iters: 500, epoch: 2 | loss: 0.6407701
	speed: 0.5460s/iter; left time: 5265.2099s
	iters: 600, epoch: 2 | loss: 0.7590153
	speed: 0.4797s/iter; left time: 4578.6739s
	iters: 700, epoch: 2 | loss: 0.5609217
	speed: 0.4766s/iter; left time: 4501.0136s
	iters: 800, epoch: 2 | loss: 0.6529699
	speed: 0.4839s/iter; left time: 4521.7168s
	iters: 900, epoch: 2 | loss: 0.7228702
	speed: 0.5279s/iter; left time: 4880.0782s
	iters: 1000, epoch: 2 | loss: 0.7714214
	speed: 0.5477s/iter; left time: 5008.0121s
	iters: 1100, epoch: 2 | loss: 0.6416580
	speed: 0.5428s/iter; left time: 4909.4280s
Epoch: 2 cost time: 594.1873273849487
Epoch: 2, Steps: 1127 | Train Loss: 0.6805821 Vali Loss: 0.7326390 Test Loss: 0.3630089
Validation loss decreased (0.738603 --> 0.732639).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7075371
	speed: 4.4729s/iter; left time: 39884.7004s
	iters: 200, epoch: 3 | loss: 0.5664176
	speed: 0.4319s/iter; left time: 3807.6794s
	iters: 300, epoch: 3 | loss: 0.4944689
	speed: 0.4783s/iter; left time: 4169.3584s
	iters: 400, epoch: 3 | loss: 0.6800807
	speed: 0.5146s/iter; left time: 4434.2511s
	iters: 500, epoch: 3 | loss: 0.7738280
	speed: 0.5293s/iter; left time: 4507.9400s
	iters: 600, epoch: 3 | loss: 0.6126373
	speed: 0.5426s/iter; left time: 4567.1774s
	iters: 700, epoch: 3 | loss: 0.6161172
	speed: 0.5320s/iter; left time: 4424.4487s
	iters: 800, epoch: 3 | loss: 0.9996934
	speed: 0.5356s/iter; left time: 4400.7903s
	iters: 900, epoch: 3 | loss: 0.6046645
	speed: 0.5425s/iter; left time: 4403.7644s
	iters: 1000, epoch: 3 | loss: 0.5674707
	speed: 0.5412s/iter; left time: 4338.9568s
	iters: 1100, epoch: 3 | loss: 0.6121773
	speed: 0.5425s/iter; left time: 4294.9396s
Epoch: 3 cost time: 579.395355463028
Epoch: 3, Steps: 1127 | Train Loss: 0.6594270 Vali Loss: 0.7207956 Test Loss: 0.3604182
Validation loss decreased (0.732639 --> 0.720796).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6667432
	speed: 6.0537s/iter; left time: 47158.1718s
	iters: 200, epoch: 4 | loss: 0.7227254
	speed: 0.5341s/iter; left time: 4107.3187s
	iters: 300, epoch: 4 | loss: 0.6013945
	speed: 0.5404s/iter; left time: 4101.6812s
	iters: 400, epoch: 4 | loss: 0.5364876
	speed: 0.5426s/iter; left time: 4063.8412s
	iters: 500, epoch: 4 | loss: 0.7775680
	speed: 0.5436s/iter; left time: 4017.5326s
	iters: 600, epoch: 4 | loss: 0.5559242
	speed: 0.5115s/iter; left time: 3728.9839s
	iters: 700, epoch: 4 | loss: 0.6898789
	speed: 0.4889s/iter; left time: 3514.9364s
	iters: 800, epoch: 4 | loss: 0.8084230
	speed: 0.4815s/iter; left time: 3413.6348s
	iters: 900, epoch: 4 | loss: 0.7193951
	speed: 0.5008s/iter; left time: 3500.3797s
	iters: 1000, epoch: 4 | loss: 0.5270889
	speed: 0.5221s/iter; left time: 3597.2195s
	iters: 1100, epoch: 4 | loss: 0.5558917
	speed: 0.5421s/iter; left time: 3680.9038s
Epoch: 4 cost time: 585.6515049934387
Epoch: 4, Steps: 1127 | Train Loss: 0.6469561 Vali Loss: 0.7239143 Test Loss: 0.3587323
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6132334
	speed: 5.9074s/iter; left time: 39361.0882s
	iters: 200, epoch: 5 | loss: 0.4776362
	speed: 0.5106s/iter; left time: 3351.1696s
	iters: 300, epoch: 5 | loss: 0.5616378
	speed: 0.5101s/iter; left time: 3296.8927s
	iters: 400, epoch: 5 | loss: 0.7348167
	speed: 0.5026s/iter; left time: 3198.3522s
	iters: 500, epoch: 5 | loss: 0.5717822
	speed: 0.5090s/iter; left time: 3188.0707s
	iters: 600, epoch: 5 | loss: 0.7532277
	speed: 0.5106s/iter; left time: 3146.9515s
	iters: 700, epoch: 5 | loss: 0.6718896
	speed: 0.5135s/iter; left time: 3113.3382s
	iters: 800, epoch: 5 | loss: 0.9792888
	speed: 0.5134s/iter; left time: 3061.3151s
	iters: 900, epoch: 5 | loss: 0.6838793
	speed: 0.4947s/iter; left time: 2900.3375s
	iters: 1000, epoch: 5 | loss: 0.5991617
	speed: 0.4960s/iter; left time: 2858.2927s
	iters: 1100, epoch: 5 | loss: 0.6111580
	speed: 0.4852s/iter; left time: 2747.5154s
Epoch: 5 cost time: 562.193868637085
Epoch: 5, Steps: 1127 | Train Loss: 0.6396682 Vali Loss: 0.7235478 Test Loss: 0.3592473
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4806648
	speed: 5.7215s/iter; left time: 31674.2798s
	iters: 200, epoch: 6 | loss: 0.5710625
	speed: 0.4894s/iter; left time: 2660.5244s
	iters: 300, epoch: 6 | loss: 0.8169494
	speed: 0.5053s/iter; left time: 2696.1849s
	iters: 400, epoch: 6 | loss: 0.5126698
	speed: 0.4577s/iter; left time: 2396.3142s
	iters: 500, epoch: 6 | loss: 0.5505426
	speed: 0.4581s/iter; left time: 2352.9439s
	iters: 600, epoch: 6 | loss: 0.4923559
	speed: 0.4474s/iter; left time: 2252.9007s
	iters: 700, epoch: 6 | loss: 0.5657356
	speed: 0.4526s/iter; left time: 2234.1715s
	iters: 800, epoch: 6 | loss: 0.7492533
	speed: 0.4531s/iter; left time: 2191.1081s
	iters: 900, epoch: 6 | loss: 0.7138096
	speed: 0.4540s/iter; left time: 2150.3366s
	iters: 1000, epoch: 6 | loss: 0.6415073
	speed: 0.4596s/iter; left time: 2130.6546s
	iters: 1100, epoch: 6 | loss: 0.6518986
	speed: 0.4716s/iter; left time: 2139.3269s
Epoch: 6 cost time: 524.7781383991241
Epoch: 6, Steps: 1127 | Train Loss: 0.6358847 Vali Loss: 0.7291579 Test Loss: 0.3602041
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el3_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 1, 720, 21) (9820, 1, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.36041826009750366, mae:0.35159945487976074
