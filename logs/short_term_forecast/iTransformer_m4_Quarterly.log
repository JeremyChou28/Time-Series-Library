Args in experiment:
[1mBasic Config[0m
  Task Name:          short_term_forecast Is Training:        1                   
  Model ID:           m4_Quarterly        Model:              iTransformer        

[1mData Loader[0m
  Data:               m4                  Root Path:          ../iTransformer_datasets/m4
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Quarterly           
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        0                   Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               SMAPE               
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : short_term_forecast_m4_Quarterly_iTransformer_m4_ftM_sl16_ll8_pl8_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 24000
val 24000
	iters: 100, epoch: 1 | loss: 6.9917159
	speed: 0.0386s/iter; left time: 575.8954s
	iters: 200, epoch: 1 | loss: 10.4885397
	speed: 0.0246s/iter; left time: 364.6545s
	iters: 300, epoch: 1 | loss: 11.9813995
	speed: 0.0276s/iter; left time: 405.1394s
	iters: 400, epoch: 1 | loss: 8.6604071
	speed: 0.0245s/iter; left time: 357.2750s
	iters: 500, epoch: 1 | loss: 12.2398643
	speed: 0.0220s/iter; left time: 319.6280s
	iters: 600, epoch: 1 | loss: 17.6186657
	speed: 0.0239s/iter; left time: 343.5991s
	iters: 700, epoch: 1 | loss: 7.6853580
	speed: 0.0247s/iter; left time: 352.7889s
	iters: 800, epoch: 1 | loss: 8.3049250
	speed: 0.0269s/iter; left time: 382.6753s
	iters: 900, epoch: 1 | loss: 10.9988241
	speed: 0.0260s/iter; left time: 366.2141s
	iters: 1000, epoch: 1 | loss: 5.4581285
	speed: 0.0208s/iter; left time: 291.5908s
	iters: 1100, epoch: 1 | loss: 8.5630331
	speed: 0.0221s/iter; left time: 307.6829s
	iters: 1200, epoch: 1 | loss: 10.4614525
	speed: 0.0252s/iter; left time: 347.4070s
	iters: 1300, epoch: 1 | loss: 12.7532721
	speed: 0.0246s/iter; left time: 337.3868s
	iters: 1400, epoch: 1 | loss: 5.7511196
	speed: 0.0259s/iter; left time: 351.8495s
	iters: 1500, epoch: 1 | loss: 10.8059559
	speed: 0.0268s/iter; left time: 361.7475s
Epoch: 1 cost time: 38.430030822753906
Epoch: 1, Steps: 1500 | Train Loss: 9.8476579 Vali Loss: 14.0574017 Test Loss: 14.0574017
Validation loss decreased (inf --> 14.057402).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 5.5119505
	speed: 0.1485s/iter; left time: 1990.2402s
	iters: 200, epoch: 2 | loss: 4.7847948
	speed: 0.0249s/iter; left time: 330.6764s
	iters: 300, epoch: 2 | loss: 11.0948868
	speed: 0.0241s/iter; left time: 318.1489s
	iters: 400, epoch: 2 | loss: 12.6735134
	speed: 0.0241s/iter; left time: 316.0058s
	iters: 500, epoch: 2 | loss: 9.9374504
	speed: 0.0244s/iter; left time: 317.8535s
	iters: 600, epoch: 2 | loss: 7.5469389
	speed: 0.0259s/iter; left time: 333.6463s
	iters: 700, epoch: 2 | loss: 6.9644394
	speed: 0.0219s/iter; left time: 280.9191s
	iters: 800, epoch: 2 | loss: 5.3820581
	speed: 0.0232s/iter; left time: 294.6231s
	iters: 900, epoch: 2 | loss: 11.0404272
	speed: 0.0296s/iter; left time: 372.4913s
	iters: 1000, epoch: 2 | loss: 5.7734146
	speed: 0.0226s/iter; left time: 282.4285s
	iters: 1100, epoch: 2 | loss: 4.5984755
	speed: 0.0231s/iter; left time: 286.1297s
	iters: 1200, epoch: 2 | loss: 12.9422693
	speed: 0.0229s/iter; left time: 281.6139s
	iters: 1300, epoch: 2 | loss: 5.7270737
	speed: 0.0233s/iter; left time: 284.5615s
	iters: 1400, epoch: 2 | loss: 5.7022748
	speed: 0.0239s/iter; left time: 289.7159s
	iters: 1500, epoch: 2 | loss: 6.7048030
	speed: 0.0256s/iter; left time: 306.8975s
Epoch: 2 cost time: 36.53792881965637
Epoch: 2, Steps: 1500 | Train Loss: 9.0411747 Vali Loss: 12.1678036 Test Loss: 12.1678036
Validation loss decreased (14.057402 --> 12.167804).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 7.1491637
	speed: 0.0612s/iter; left time: 727.8184s
	iters: 200, epoch: 3 | loss: 17.9463997
	speed: 0.0236s/iter; left time: 278.6433s
	iters: 300, epoch: 3 | loss: 8.2749252
	speed: 0.0236s/iter; left time: 275.6813s
	iters: 400, epoch: 3 | loss: 12.6138945
	speed: 0.0238s/iter; left time: 275.8427s
	iters: 500, epoch: 3 | loss: 3.1681080
	speed: 0.0235s/iter; left time: 269.8909s
	iters: 600, epoch: 3 | loss: 7.3067546
	speed: 0.0226s/iter; left time: 258.1093s
	iters: 700, epoch: 3 | loss: 6.3461585
	speed: 0.0226s/iter; left time: 255.1398s
	iters: 800, epoch: 3 | loss: 5.6601691
	speed: 0.0242s/iter; left time: 271.3366s
	iters: 900, epoch: 3 | loss: 13.5523472
	speed: 0.0250s/iter; left time: 277.1739s
	iters: 1000, epoch: 3 | loss: 11.1260147
	speed: 0.0223s/iter; left time: 245.4335s
	iters: 1100, epoch: 3 | loss: 7.1598611
	speed: 0.0216s/iter; left time: 234.9990s
	iters: 1200, epoch: 3 | loss: 6.1733575
	speed: 0.0215s/iter; left time: 231.6998s
	iters: 1300, epoch: 3 | loss: 6.6678829
	speed: 0.0227s/iter; left time: 243.4111s
	iters: 1400, epoch: 3 | loss: 6.7916975
	speed: 0.0212s/iter; left time: 225.0467s
	iters: 1500, epoch: 3 | loss: 13.9470205
	speed: 0.0219s/iter; left time: 229.8985s
Epoch: 3 cost time: 34.35232186317444
Epoch: 3, Steps: 1500 | Train Loss: 8.4029305 Vali Loss: 11.4278690 Test Loss: 11.4278690
Validation loss decreased (12.167804 --> 11.427869).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 7.1222625
	speed: 0.0609s/iter; left time: 633.2782s
	iters: 200, epoch: 4 | loss: 7.8995810
	speed: 0.0238s/iter; left time: 245.2407s
	iters: 300, epoch: 4 | loss: 8.2290125
	speed: 0.0223s/iter; left time: 227.6547s
	iters: 400, epoch: 4 | loss: 3.4560471
	speed: 0.0218s/iter; left time: 219.9099s
	iters: 500, epoch: 4 | loss: 6.3312268
	speed: 0.0218s/iter; left time: 217.7365s
	iters: 600, epoch: 4 | loss: 4.3040471
	speed: 0.0221s/iter; left time: 219.0404s
	iters: 700, epoch: 4 | loss: 5.7717957
	speed: 0.0218s/iter; left time: 213.6709s
	iters: 800, epoch: 4 | loss: 8.4751062
	speed: 0.0258s/iter; left time: 250.4046s
	iters: 900, epoch: 4 | loss: 7.1115241
	speed: 0.0212s/iter; left time: 203.1147s
	iters: 1000, epoch: 4 | loss: 7.1618767
	speed: 0.0207s/iter; left time: 196.7705s
	iters: 1100, epoch: 4 | loss: 5.2471032
	speed: 0.0194s/iter; left time: 182.3054s
	iters: 1200, epoch: 4 | loss: 6.4929733
	speed: 0.0210s/iter; left time: 195.0209s
	iters: 1300, epoch: 4 | loss: 5.5592871
	speed: 0.0230s/iter; left time: 211.4043s
	iters: 1400, epoch: 4 | loss: 5.0253558
	speed: 0.0201s/iter; left time: 183.1504s
	iters: 1500, epoch: 4 | loss: 8.0608530
	speed: 0.0209s/iter; left time: 188.4579s
Epoch: 4 cost time: 32.85547208786011
Epoch: 4, Steps: 1500 | Train Loss: 7.8516681 Vali Loss: 11.5557311 Test Loss: 11.5557311
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 4.9342480
	speed: 0.0266s/iter; left time: 237.0622s
	iters: 200, epoch: 5 | loss: 12.7741070
	speed: 0.0206s/iter; left time: 180.9200s
	iters: 300, epoch: 5 | loss: 12.3199148
	speed: 0.0244s/iter; left time: 212.5925s
	iters: 400, epoch: 5 | loss: 5.0608473
	speed: 0.0232s/iter; left time: 199.5821s
	iters: 500, epoch: 5 | loss: 9.1071653
	speed: 0.0221s/iter; left time: 188.0932s
	iters: 600, epoch: 5 | loss: 6.0379581
	speed: 0.0231s/iter; left time: 194.3090s
	iters: 700, epoch: 5 | loss: 6.6913238
	speed: 0.0244s/iter; left time: 202.7380s
	iters: 800, epoch: 5 | loss: 9.4886036
	speed: 0.0245s/iter; left time: 200.7961s
	iters: 900, epoch: 5 | loss: 13.8130169
	speed: 0.0238s/iter; left time: 192.9315s
	iters: 1000, epoch: 5 | loss: 8.8261261
	speed: 0.0238s/iter; left time: 190.5674s
	iters: 1100, epoch: 5 | loss: 11.5927048
	speed: 0.0234s/iter; left time: 184.6542s
	iters: 1200, epoch: 5 | loss: 4.1160383
	speed: 0.0214s/iter; left time: 167.1563s
	iters: 1300, epoch: 5 | loss: 6.6865458
	speed: 0.0240s/iter; left time: 184.7495s
	iters: 1400, epoch: 5 | loss: 16.7637882
	speed: 0.0238s/iter; left time: 180.7254s
	iters: 1500, epoch: 5 | loss: 10.2535810
	speed: 0.0227s/iter; left time: 170.0452s
Epoch: 5 cost time: 34.313292503356934
Epoch: 5, Steps: 1500 | Train Loss: 7.8229687 Vali Loss: 10.8916693 Test Loss: 10.8916693
Validation loss decreased (11.427869 --> 10.891669).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 4.7239227
	speed: 0.0617s/iter; left time: 456.9657s
	iters: 200, epoch: 6 | loss: 11.9176493
	speed: 0.0236s/iter; left time: 172.6122s
	iters: 300, epoch: 6 | loss: 7.6788144
	speed: 0.0237s/iter; left time: 170.6242s
	iters: 400, epoch: 6 | loss: 3.6437161
	speed: 0.0236s/iter; left time: 167.4511s
	iters: 500, epoch: 6 | loss: 11.4102726
	speed: 0.0236s/iter; left time: 165.0656s
	iters: 600, epoch: 6 | loss: 9.2608948
	speed: 0.0223s/iter; left time: 153.8660s
	iters: 700, epoch: 6 | loss: 6.2061429
	speed: 0.0235s/iter; left time: 159.5074s
	iters: 800, epoch: 6 | loss: 13.0006847
	speed: 0.0294s/iter; left time: 197.0150s
	iters: 900, epoch: 6 | loss: 7.7661095
	speed: 0.0237s/iter; left time: 156.6531s
	iters: 1000, epoch: 6 | loss: 9.1223507
	speed: 0.0245s/iter; left time: 158.9565s
	iters: 1100, epoch: 6 | loss: 6.9435158
	speed: 0.0233s/iter; left time: 149.0420s
	iters: 1200, epoch: 6 | loss: 3.1614728
	speed: 0.0224s/iter; left time: 141.3409s
	iters: 1300, epoch: 6 | loss: 7.1541190
	speed: 0.0258s/iter; left time: 160.1005s
	iters: 1400, epoch: 6 | loss: 6.9881902
	speed: 0.0233s/iter; left time: 142.0482s
	iters: 1500, epoch: 6 | loss: 4.8759480
	speed: 0.0218s/iter; left time: 130.6329s
Epoch: 6 cost time: 35.60549592971802
Epoch: 6, Steps: 1500 | Train Loss: 7.7113517 Vali Loss: 10.9912671 Test Loss: 10.9912671
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 9.4681377
	speed: 0.0301s/iter; left time: 177.3751s
	iters: 200, epoch: 7 | loss: 2.7759590
	speed: 0.0217s/iter; left time: 125.8151s
	iters: 300, epoch: 7 | loss: 9.0756636
	speed: 0.0213s/iter; left time: 121.2081s
	iters: 400, epoch: 7 | loss: 12.1776667
	speed: 0.0215s/iter; left time: 120.4200s
	iters: 500, epoch: 7 | loss: 11.2304764
	speed: 0.0207s/iter; left time: 113.9201s
	iters: 600, epoch: 7 | loss: 5.5076513
	speed: 0.0211s/iter; left time: 113.9310s
	iters: 700, epoch: 7 | loss: 8.6179628
	speed: 0.0218s/iter; left time: 115.4094s
	iters: 800, epoch: 7 | loss: 14.4635887
	speed: 0.0210s/iter; left time: 109.3767s
	iters: 900, epoch: 7 | loss: 5.4199605
	speed: 0.0209s/iter; left time: 106.4417s
	iters: 1000, epoch: 7 | loss: 5.4803715
	speed: 0.0210s/iter; left time: 105.1353s
	iters: 1100, epoch: 7 | loss: 7.5236125
	speed: 0.0197s/iter; left time: 96.4351s
	iters: 1200, epoch: 7 | loss: 5.7603703
	speed: 0.0232s/iter; left time: 111.5747s
	iters: 1300, epoch: 7 | loss: 6.7890100
	speed: 0.0212s/iter; left time: 99.6534s
	iters: 1400, epoch: 7 | loss: 8.0151443
	speed: 0.0206s/iter; left time: 94.7251s
	iters: 1500, epoch: 7 | loss: 4.9958444
	speed: 0.0211s/iter; left time: 94.9968s
Epoch: 7 cost time: 31.703909158706665
Epoch: 7, Steps: 1500 | Train Loss: 7.6545685 Vali Loss: 10.8916442 Test Loss: 10.8916442
Validation loss decreased (10.891669 --> 10.891644).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 9.3374434
	speed: 0.0566s/iter; left time: 249.2181s
	iters: 200, epoch: 8 | loss: 17.6665173
	speed: 0.0201s/iter; left time: 86.2367s
	iters: 300, epoch: 8 | loss: 6.1809087
	speed: 0.0212s/iter; left time: 89.2244s
	iters: 400, epoch: 8 | loss: 10.3738098
	speed: 0.0216s/iter; left time: 88.4863s
	iters: 500, epoch: 8 | loss: 5.1189752
	speed: 0.0220s/iter; left time: 87.8343s
	iters: 600, epoch: 8 | loss: 7.4361205
	speed: 0.0206s/iter; left time: 80.5474s
	iters: 700, epoch: 8 | loss: 6.3371158
	speed: 0.0215s/iter; left time: 81.5720s
	iters: 800, epoch: 8 | loss: 6.2864356
	speed: 0.0261s/iter; left time: 96.7408s
	iters: 900, epoch: 8 | loss: 4.7413206
	speed: 0.0185s/iter; left time: 66.5399s
	iters: 1000, epoch: 8 | loss: 5.7319694
	speed: 0.0214s/iter; left time: 74.8019s
	iters: 1100, epoch: 8 | loss: 7.4099360
	speed: 0.0213s/iter; left time: 72.4783s
	iters: 1200, epoch: 8 | loss: 4.0017853
	speed: 0.0214s/iter; left time: 70.6102s
	iters: 1300, epoch: 8 | loss: 3.6211669
	speed: 0.0247s/iter; left time: 78.9997s
	iters: 1400, epoch: 8 | loss: 10.3354950
	speed: 0.0238s/iter; left time: 73.6960s
	iters: 1500, epoch: 8 | loss: 6.2167339
	speed: 0.0239s/iter; left time: 71.8306s
Epoch: 8 cost time: 32.891347885131836
Epoch: 8, Steps: 1500 | Train Loss: 7.6452372 Vali Loss: 10.7821203 Test Loss: 10.7821203
Validation loss decreased (10.891644 --> 10.782120).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 3.3591375
	speed: 0.0544s/iter; left time: 157.9156s
	iters: 200, epoch: 9 | loss: 8.5100031
	speed: 0.0210s/iter; left time: 58.7820s
	iters: 300, epoch: 9 | loss: 9.2604856
	speed: 0.0238s/iter; left time: 64.3802s
	iters: 400, epoch: 9 | loss: 10.7103701
	speed: 0.0237s/iter; left time: 61.6649s
	iters: 500, epoch: 9 | loss: 6.4874568
	speed: 0.0236s/iter; left time: 59.0405s
	iters: 600, epoch: 9 | loss: 14.0437927
	speed: 0.0240s/iter; left time: 57.5579s
	iters: 700, epoch: 9 | loss: 6.1562161
	speed: 0.0240s/iter; left time: 55.2222s
	iters: 800, epoch: 9 | loss: 4.8441701
	speed: 0.0234s/iter; left time: 51.5000s
	iters: 900, epoch: 9 | loss: 5.5008574
	speed: 0.0231s/iter; left time: 48.5866s
	iters: 1000, epoch: 9 | loss: 7.1016521
	speed: 0.0238s/iter; left time: 47.6213s
	iters: 1100, epoch: 9 | loss: 5.9015412
	speed: 0.0256s/iter; left time: 48.7114s
	iters: 1200, epoch: 9 | loss: 3.8765669
	speed: 0.0238s/iter; left time: 42.8264s
	iters: 1300, epoch: 9 | loss: 15.4155416
	speed: 0.0238s/iter; left time: 40.5406s
	iters: 1400, epoch: 9 | loss: 10.2195826
	speed: 0.0236s/iter; left time: 37.7529s
	iters: 1500, epoch: 9 | loss: 4.7484169
	speed: 0.0240s/iter; left time: 36.0129s
Epoch: 9 cost time: 34.99569034576416
Epoch: 9, Steps: 1500 | Train Loss: 7.6253453 Vali Loss: 10.7295443 Test Loss: 10.7295443
Validation loss decreased (10.782120 --> 10.729544).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 4.6262550
	speed: 0.0563s/iter; left time: 78.9147s
	iters: 200, epoch: 10 | loss: 13.8931303
	speed: 0.0214s/iter; left time: 27.8663s
	iters: 300, epoch: 10 | loss: 3.8120725
	speed: 0.0209s/iter; left time: 25.1518s
	iters: 400, epoch: 10 | loss: 10.8945055
	speed: 0.0213s/iter; left time: 23.4568s
	iters: 500, epoch: 10 | loss: 4.9270391
	speed: 0.0224s/iter; left time: 22.4267s
	iters: 600, epoch: 10 | loss: 9.7137022
	speed: 0.0236s/iter; left time: 21.2426s
	iters: 700, epoch: 10 | loss: 9.3254623
	speed: 0.0237s/iter; left time: 18.9863s
	iters: 800, epoch: 10 | loss: 9.1592731
	speed: 0.0252s/iter; left time: 17.6673s
	iters: 900, epoch: 10 | loss: 4.4174767
	speed: 0.0250s/iter; left time: 15.0425s
	iters: 1000, epoch: 10 | loss: 5.6899824
	speed: 0.0194s/iter; left time: 9.7427s
	iters: 1100, epoch: 10 | loss: 5.0498409
	speed: 0.0188s/iter; left time: 7.5349s
	iters: 1200, epoch: 10 | loss: 5.0032420
	speed: 0.0231s/iter; left time: 6.9557s
	iters: 1300, epoch: 10 | loss: 6.9779091
	speed: 0.0244s/iter; left time: 4.9106s
	iters: 1400, epoch: 10 | loss: 9.1933117
	speed: 0.0239s/iter; left time: 2.4176s
	iters: 1500, epoch: 10 | loss: 9.3719702
	speed: 0.0239s/iter; left time: 0.0239s
Epoch: 10 cost time: 33.852850914001465
Epoch: 10, Steps: 1500 | Train Loss: 7.6257446 Vali Loss: 10.7537049 Test Loss: 10.7537049
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : short_term_forecast_m4_Quarterly_iTransformer_m4_ftM_sl16_ll8_pl8_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
train 24000
test 24000
0
1000
2000
3000
4000
5000
6000
7000
8000
9000
10000
11000
12000
13000
14000
15000
16000
17000
18000
19000
20000
21000
22000
23000
test shape: (24000, 8, 1)
iTransformer
After all 6 tasks are finished, you can calculate the averaged index
